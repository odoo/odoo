<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">

        <!-- Template: Email de bienvenue (J-3) -->
        <record id="email_template_welcome" model="mail.template">
            <field name="name">OneDesk: Email de bienvenue</field>
            <field name="model_id" ref="model_onedesk_reservation"/>
            <field name="subject">Votre s√©jour chez {{ object.property_id.name }} approche ! üè†</field>
            <field name="email_from">{{ (object.property_id.user_id.email_formatted or user.email_formatted) }}</field>
            <field name="email_to">{{ object.partner_id.email }}</field>
            <field name="body_html" type="html">
<![CDATA[
<table border="0" cellpadding="0" cellspacing="0" style="padding-top: 16px; background-color: #F1F1F1; font-family:Verdana, Arial,sans-serif; color: #555; width: 100%; border-collapse:separate;">
    <tr>
        <td align="center">
            <table border="0" cellpadding="0" cellspacing="0" width="590" style="padding: 16px; background-color: white; color: #555; border-collapse:separate;">
                <tbody>
                    <tr>
                        <td align="center" style="min-width: 590px;">
                            <h2 style="color: #4CAF50;">Bonjour {{ object.guest_name or object.partner_id.name }} ! üëã</h2>
                            <p style="font-size: 16px;">
                                Nous sommes ravis de vous accueillir bient√¥t chez <strong>{{ object.property_id.name }}</strong> !
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td style="padding: 20px;">
                            <h3 style="color: #333;">üìÖ D√©tails de votre r√©servation</h3>
                            <p>
                                <strong>R√©f√©rence:</strong> {{ object.name }}<br/>
                                <strong>Check-in:</strong> {{ format_datetime(object.start_date, dt_format='d MMMM yyyy √† HH:mm', tz=object.property_id.user_id.tz or 'UTC', locale=object.partner_id.lang or 'fr_FR') }}<br/>
                                <strong>Check-out:</strong> {{ format_datetime(object.end_date, dt_format='d MMMM yyyy √† HH:mm', tz=object.property_id.user_id.tz or 'UTC', locale=object.partner_id.lang or 'fr_FR') }}<br/>
                                <strong>Dur√©e:</strong> {{ object.nights }} nuit(s)<br/>
                                <strong>Nombre de personnes:</strong> {{ object.guest_count }}<br/>
                            </p>

                            <h3 style="color: #333;">üè° Votre logement</h3>
                            <p>
                                <strong>{{ object.unit_id.name }}</strong><br/>
                                <strong>Adresse:</strong> {{ object.property_id.address or object.property_id.city }}<br/>
                                <strong>Capacit√©:</strong> {{ object.unit_id.max_guests }} personnes<br/>
                            </p>

                            % if object.property_id.amenity_ids:
                            <h3 style="color: #333;">‚ú® √âquipements</h3>
                            <p>
                                % for amenity in object.property_id.amenity_ids[:6]:
                                <span style="display: inline-block; margin: 5px; padding: 5px 10px; background-color: #f0f0f0; border-radius: 5px;">
                                    {{ amenity.name }}
                                </span>
                                % endfor
                            </p>
                            % endif

                            <div style="margin-top: 30px; padding: 15px; background-color: #E8F5E9; border-left: 4px solid #4CAF50;">
                                <p style="margin: 0;"><strong>üí° Conseil:</strong> Consultez votre email de check-in que vous recevrez 24h avant votre arriv√©e pour les instructions d'acc√®s d√©taill√©es.</p>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td align="center" style="padding: 20px;">
                            <p style="font-size: 14px; color: #888;">
                                Des questions ? Contactez-nous !<br/>
                                <strong>{{ object.property_id.user_id.name }}</strong><br/>
                                {{ object.property_id.user_id.email }}
                            </p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</table>
]]>
            </field>
        </record>

        <!-- Template: Instructions Check-in (J-1) -->
        <record id="email_template_checkin_instructions" model="mail.template">
            <field name="name">OneDesk: Instructions Check-in</field>
            <field name="model_id" ref="model_onedesk_reservation"/>
            <field name="subject">Instructions d'arriv√©e - {{ object.property_id.name }} - Demain ! üîë</field>
            <field name="email_from">{{ (object.property_id.user_id.email_formatted or user.email_formatted) }}</field>
            <field name="email_to">{{ object.partner_id.email }}</field>
            <field name="body_html" type="html">
<![CDATA[
<table border="0" cellpadding="0" cellspacing="0" style="padding-top: 16px; background-color: #F1F1F1; font-family:Verdana, Arial,sans-serif; color: #555; width: 100%; border-collapse:separate;">
    <tr>
        <td align="center">
            <table border="0" cellpadding="0" cellspacing="0" width="590" style="padding: 16px; background-color: white; color: #555; border-collapse:separate;">
                <tbody>
                    <tr>
                        <td align="center" style="min-width: 590px;">
                            <h2 style="color: #2196F3;">Votre check-in est demain ! üéâ</h2>
                            <p style="font-size: 16px;">
                                Tout est pr√™t pour votre arriv√©e chez <strong>{{ object.property_id.name }}</strong>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td style="padding: 20px;">
                            <h3 style="color: #333;">üîë Informations d'acc√®s</h3>
                            <div style="padding: 15px; background-color: #FFF3E0; border-left: 4px solid #FF9800; margin-bottom: 20px;">
                                <p style="margin: 0;">
                                    <strong>Heure d'arriv√©e:</strong> {{ format_datetime(object.start_date, dt_format='HH:mm', tz=object.property_id.user_id.tz or 'UTC') }} (Check-in √† partir de {{ '%02d' % int(object.property_id.check_in_time) }}:{{ '%02d' % int((object.property_id.check_in_time % 1) * 60) }})<br/>
                                    <strong>Adresse compl√®te:</strong> {{ object.property_id.address }}<br/>
                                    <strong>Unit√©:</strong> {{ object.unit_id.name }}<br/>
                                </p>
                            </div>

                            % if object.check_in_instructions:
                            <h3 style="color: #333;">üìù Instructions sp√©cifiques</h3>
                            <div style="padding: 15px; background-color: #f9f9f9; border-radius: 5px;">
                                {{ object.check_in_instructions }}
                            </div>
                            % else:
                            <div style="padding: 15px; background-color: #E3F2FD; border-left: 4px solid #2196F3;">
                                <p style="margin: 0;">
                                    <strong>Code d'acc√®s:</strong> Vous recevrez le code par SMS 2h avant votre arriv√©e<br/>
                                    <strong>Localisation cl√©s:</strong> Bo√Æte √† cl√©s √† gauche de la porte d'entr√©e
                                </p>
                            </div>
                            % endif

                            <h3 style="color: #333;">‚ÑπÔ∏è Informations pratiques</h3>
                            <p>
                                <strong>WiFi:</strong> Nom du r√©seau et mot de passe disponibles dans le logement<br/>
                                <strong>Parking:</strong> {{ 'Parking disponible' if object.property_id.amenity_ids.filtered(lambda a: a.name == 'Parking') else 'Parking public √† proximit√©' }}<br/>
                                <strong>Check-out:</strong> {{ format_datetime(object.end_date, dt_format='d MMMM yyyy √† HH:mm', tz=object.property_id.user_id.tz or 'UTC', locale=object.partner_id.lang or 'fr_FR') }}<br/>
                            </p>

                            % if object.property_id.house_rules:
                            <h3 style="color: #333;">üìã R√®glement int√©rieur</h3>
                            <div style="padding: 15px; background-color: #f9f9f9; border-radius: 5px; font-size: 14px;">
                                {{ object.property_id.house_rules }}
                            </div>
                            % endif

                            <div style="margin-top: 30px; padding: 15px; background-color: #E8F5E9; border-left: 4px solid #4CAF50;">
                                <p style="margin: 0;"><strong>üöó Itin√©raire:</strong> Utilisez ces coordonn√©es GPS: {{ object.property_id.latitude }}, {{ object.property_id.longitude if object.property_id.latitude else 'Adresse: ' + object.property_id.address }}</p>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td align="center" style="padding: 20px;">
                            <p style="font-size: 14px; color: #888;">
                                Urgence ou question ? Appelez-nous !<br/>
                                <strong>{{ object.property_id.user_id.name }}</strong><br/>
                                {{ object.property_id.user_id.email }}
                            </p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</table>
]]>
            </field>
        </record>

        <!-- Template: Demande d'avis (apr√®s check-out) -->
        <record id="email_template_review_request" model="mail.template">
            <field name="name">OneDesk: Demande d'avis</field>
            <field name="model_id" ref="model_onedesk_reservation"/>
            <field name="subject">Comment s'est pass√© votre s√©jour chez {{ object.property_id.name }} ? ‚≠ê</field>
            <field name="email_from">{{ (object.property_id.user_id.email_formatted or user.email_formatted) }}</field>
            <field name="email_to">{{ object.partner_id.email }}</field>
            <field name="body_html" type="html">
<![CDATA[
<table border="0" cellpadding="0" cellspacing="0" style="padding-top: 16px; background-color: #F1F1F1; font-family:Verdana, Arial,sans-serif; color: #555; width: 100%; border-collapse:separate;">
    <tr>
        <td align="center">
            <table border="0" cellpadding="0" cellspacing="0" width="590" style="padding: 16px; background-color: white; color: #555; border-collapse:separate;">
                <tbody>
                    <tr>
                        <td align="center" style="min-width: 590px;">
                            <h2 style="color: #FFA726;">Merci pour votre s√©jour ! üôè</h2>
                            <p style="font-size: 16px;">
                                Nous esp√©rons que vous avez pass√© un excellent moment chez <strong>{{ object.property_id.name }}</strong>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td style="padding: 20px;">
                            <p>Bonjour {{ object.guest_name or object.partner_id.name }},</p>

                            <p style="font-size: 16px;">
                                Votre avis est tr√®s important pour nous ! Pourriez-vous prendre 2 minutes pour partager votre exp√©rience ?
                            </p>

                            <div style="text-align: center; margin: 30px 0;">
                                <table border="0" cellspacing="0" cellpadding="0" align="center">
                                    <tr>
                                        <td align="center" style="border-radius: 5px; background-color: #4CAF50;">
                                            <a href="#" target="_blank" style="font-size: 16px; font-weight: bold; color: #ffffff; text-decoration: none; border-radius: 5px; padding: 12px 30px; border: 1px solid #4CAF50; display: inline-block;">
                                                ‚≠ê Laisser un avis
                                            </a>
                                        </td>
                                    </tr>
                                </table>
                            </div>

                            <h3 style="color: #333;">üìä Votre s√©jour en bref</h3>
                            <p>
                                <strong>Dates:</strong> Du {{ format_datetime(object.start_date, dt_format='d MMM', tz=object.property_id.user_id.tz or 'UTC', locale=object.partner_id.lang or 'fr_FR') }} au {{ format_datetime(object.end_date, dt_format='d MMM yyyy', tz=object.property_id.user_id.tz or 'UTC', locale=object.partner_id.lang or 'fr_FR') }}<br/>
                                <strong>Logement:</strong> {{ object.unit_id.name }}<br/>
                                <strong>R√©f√©rence:</strong> {{ object.name }}<br/>
                            </p>

                            <div style="margin-top: 30px; padding: 15px; background-color: #E3F2FD; border-left: 4px solid #2196F3;">
                                <p style="margin: 0;"><strong>üíô Vous avez aim√© ?</strong> Nous serions ravis de vous revoir ! Profitez de 10% de r√©duction sur votre prochain s√©jour en utilisant le code: <strong>RETOUR10</strong></p>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td align="center" style="padding: 20px;">
                            <p style="font-size: 14px; color: #888;">
                                √Ä tr√®s bient√¥t !<br/>
                                <strong>{{ object.property_id.user_id.name }}</strong><br/>
                                {{ object.property_id.user_id.email }}
                            </p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</table>
]]>
            </field>
        </record>

    </data>
</odoo>
