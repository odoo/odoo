<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data>
    <template id="website_blog_script" inherit_id="website.layout" name="Website Blog script">
        <xpath expr="//t[@id='editable_scripts_hook']" position="inside">
            <script type="text/javascript" src="/website_blog/static/src/js/website_blog.editor.js" t-ignore="true"></script>
            <script type="text/javascript" src="/website_blog/static/src/js/website.tour.blog.js" t-ignore="true"></script>
        </xpath>
    </template>

    <!-- Layout add nav and footer -->
    <template id="header_footer_custom" inherit_id="website.layout" name="Footer News Blog Link">
        <xpath expr="//footer//div[@name='info']/ul" position="inside">
            <li><a t-href="/blog/%(website_blog.blog_category_1)d/">News</a></li>
        </xpath>
    </template>

    <!-- Blog Post Summary -->
    <template id="latest_blogs" name="Latest Blogs">
        <t t-call="website.layout">
            <div id="wrap">
                <div class="oe_structure"/>
                <section t-if="editable">
                    <div class="container text-center mt16">
                        <div class="alert alert-warning alert-dismissable">
                           <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&amp;times;</button>
                           <p>
                           This page is great to improve your <strong>Search Engine Optimization</strong>;
                           You can review titles, keywords and descriptions of all blogs at once.
                           </p><p>
                           You should <strong>add a banner on the top</strong> as it is a frequent landing page for new visitors.
                           <span class="text-muted">This box will not be visible to your visitors.</span>
                           </p>
                        </div>
                    </div>
                </section>
                <section class="container">
                    <t t-call="website.pager" >
                        <t t-set="classname">pull-right</t>
                    </t>
                </section>
                <section data-snippet-id="title" class="container">
                    <div class="row">
                        <div class="col-md-12 text-center">
                            <h1>Latest Blogs</h1>
                        </div>
                    </div>
                </section>
                <section class="container">
                    <div class="row">
                        <t t-set="count" t-value="0"/>
                        <t t-foreach="blogs" t-as="blog">
                          <div class="col-md-4">
                            <h4>
                                <a t-href="/blogpost/#{ slug(blog) }?#{ tag and 'tag=%s' % tag.id or '' }#{tag and date and '&amp;' or ''}#{ date and 'date=%s' % date or ''}" t-field="blog.name"></a>
                                <span t-if="not blog.website_published" class="text-warning">
                                    &amp;nbsp;
                                    <span class="fa fa-warning" title="Not published"/>
                                </span>
                            </h4>
                            <div class="text-muted">
                                <span class="fa fa-calendar"> <span t-field="blog.create_date"/> &amp;nbsp;</span>
                                <span class="fa fa-folder-open"> In
                                    <a t-href="/blog/#{ slug(blog.category_id) }">
                                    <span t-field="blog.category_id"/>
                                    </a> &amp;nbsp;
                                </span>
                            </div>
                            <div class="text-muted fa fa-tags">
                                <span t-field="blog.website_meta_keywords"/>
                                <span t-if="editable and not blog.website_meta_keywords" class="label label-danger">
                                    No keywords defined!
                                </span>
                            </div>
                            <div class="text-muted" t-if="len(blog.message_ids) &gt; 0">
                                <span class="fa fa-comment-o">
                                    <a t-href="/blogpost/#{ slug(blog) }/?#{ tag and 'tag=%s' % tag.id or '' }#{tag and date and '&amp;' or ''}#{ date and 'date=%s' % date or ''}#comment">
                                        <t t-if="len(blog.message_ids) &lt;= 1" ><t t-esc="len(blog.message_ids)"/> comment</t>
                                        <t t-if="len(blog.message_ids) > 1"><t t-esc="len(blog.message_ids)"/> comments</t>
                                    </a>
                                </span>
                            </div>
                            <div class="text-muted mb16" t-field="blog.website_meta_description"/>
                          </div>
                          <t t-set="count" t-value="count+1"/>
                          <div class="clearfix" t-if="(count % 3) == 0"/>
                        </t>
                    </div>
                </section>
                <div class="oe_structure"/>
            </div>
        </t>
    </template>


    <!-- Blog Post Summary -->
    <template id="blog_post_short" name="Blog Post Summary">
        <t t-call="website_blog.index">
        <div t-if="not blog_posts">
            <h1>
                No blog post yet!
            </h1>
            <p t-if="editable">
                To create a new blog post, use the top-right menu <em>Content</em>
                and select the menuitem <em>New Blog Post</em>.
            </p>

        </div>
        <t t-foreach="blog_posts" t-as="blog_post">
          <div t-att-data-publish="blog_post.website_published and 'on' or 'off'">
            <h2 class="text-center">
                <a t-href="/blogpost/#{ slug(blog_post) }/?#{ tag and 'tag=%s' % tag.id or '' }#{tag and date and '&amp;' or ''}#{ date and 'date=%s' % date or ''}" t-field="blog_post.name"></a>
            </h2>
            <p class="post-meta text-muted text-center" name='blog_post_data'>
                <span class="fa fa-calendar"> <span t-field="blog_post.create_date"/> &amp;nbsp;</span>
                <span t-if="len(blog_post.message_ids) &gt; 0" class="fa fa-comment-o">
                    <a t-href="/blogpost/#{ slug(blog_post) }/?#{ tag and 'tag=%s' % tag.id or '' }#{tag and date and '&amp;' or ''}#{ date and 'date=%s' % date or ''}#comment">
                        <t t-if="len(blog_post.message_ids) &lt;= 1" ><t t-esc="len(blog_post.message_ids)"/> comment</t>
                        <t t-if="len(blog_post.message_ids) > 1"><t t-esc="len(blog_post.message_ids)"/> comments</t>
                    </a>
                </span>
                <span t-if="not blog_post.website_published" class="label label-danger">not published</span>
            </p>
            <div t-raw="blog_post.shortened_content" class="blog_content"/>
            <hr/>
          </div>

        </t>
        </t>
    </template>

    <!-- Options: Blog Post Summary: hide author -->
    <template id="opt_blog_post_short_author" name="Author"
            inherit_option_id="website_blog.blog_post_short">
        <xpath expr="//span[@class='fa-calendar']" position="after">
            <span class="fa fa-user"> By <span t-field="blog_post.create_uid"/> &amp;nbsp;</span>
        </xpath>
    </template>

    <!-- Option: Blog Post Summary: show tags -->
    <template id="opt_blog_post_short_tags" name="Tags"
            inherit_option_id="website_blog.blog_post_short" inherit_id="website_blog.blog_post_short">
        <xpath expr="//p[@name='blog_post_data']" position="after">
            <p class="post-meta text-muted text-center" t-if="len(blog_post.tag_ids)">
                <span class="fa fa-tags"/>
                <t t-foreach="blog_post.tag_ids" t-as="tag">
                    <a t-href="/blog/#{ slug(category) }/tag/#{ slug(tag) }" t-esc="tag.name"/> &amp;nbsp;
                </t>
            </p>
        </xpath>
    </template>

    <!-- Blog Post Complete -->
    <template id="blog_post_complete" name="Blog Post">
        <t t-call="website_blog.index">

        <div class="row">
          <div class="col-sm-9">
              <ol class="breadcrumb">
                  <li><a t-href="/blog/#{ slug(category) }"><span t-field="category.name"/></a></li>
                  <li t-if="tag"><a t-href="/blog/#{ slug(category) }/tag/#{ slug(tag) }"><span t-field="tag.name"/></a></li>
                  <li t-if="tag and date"><a t-href="/blog/#{ slug(category) }/tag/#{ slug(tag) }/date/#{ date }" t-esc="date_name"/></li>
                  <li t-if="not tag and date"><a t-href="/blog/#{ slug(category) }/date/#{ date }" t-esc="date_name"/></li>
                  <li class="active"><span t-field="blog_post.name"/></li>
              </ol>
          </div><div class="col-sm-3">
            <t t-call="website.publish_management">
                <t t-set="object" t-value="blog_post"/>
                <t t-set="publish_edit" t-value="True"/>
                <li t-ignore="True">
                    <form class="duplicate hidden" action="/blogpost/duplicate">
                        <input name="blog_post_id" t-att-value="blog_post.id"/>
                    </form>
                    <a href="#" class="duplicate" onclick="$(this).prev('form').submit()">Duplicate</a>
                </li>
            </t>
          </div>
        </div>

        <div class="clearfix"/>

        <h1 class="text-center" t-field="blog_post.name"/>
        <p class="post-meta text-muted text-center" name="blog_post_data">
            <span class="fa fa-calendar"> <span t-field="blog_post.create_date"/> &amp;nbsp;</span>
            <span t-if="len(blog_post.message_ids) &gt; 0" class="fa fa-comment-o"> With
                <a t-attf-href="#comments">
                    <t t-if="len(blog_post.message_ids) &lt;= 1" ><t t-esc="len(blog_post.message_ids)"/> comment</t>
                    <t t-if="len(blog_post.message_ids) > 1"><t t-esc="len(blog_post.message_ids)"/> comments</t>
                </a>
            </span>
        </p>

        <div t-field="blog_post.content" class="mt16"/>
        <hr class="mb32"/>

        <a id="comments"/>
        <ul class="media-list" id="comments-list">
            <li t-foreach="blog_post.website_message_ids" t-as="message" class="media">
                <div class="media-body">
                    <img class="media-object pull-left" t-att-src="'/website/image?model=res.partner&amp;field=image_small&amp;id='+str(message.author_id.id)" style="width: 50px; margin-right: 10px;"/>
                    <div class="media-body">
                        <t t-call="website.publish_short">
                            <t t-set="object" t-value="message"/>
                        </t>
                        <h5 class="media-heading">
                            <span t-field="message.author_id"/> <small>on <span t-field="message.date"/></small>
                        </h5>
                        <div t-field="message.body"/>
                    </div>
                </div>
            </li>
        </ul>
        </t>
    </template>

    <!-- Options: Blog Post: user can reply -->
    <template id="opt_blog_post_complete_comment" name="Allow Comments"
            inherit_option_id="website_blog.blog_post_complete" inherit_id="website_blog.blog_post_complete"
            groups="website_mail.group_comment">
        <xpath expr="//ul[@id='comments-list']" position="after">
            <section class="mb32">
                <form id="comment" t-attf-action="/blogpost/#{blog_post.id}/#{ path_filter }/comment"
                        method="POST">
                    <img class="img pull-left img-rounded" t-att-src="'/website/image?model=res.partner&amp;field=image_small&amp;id='+str(user_id.partner_id.id)" style="width: 50px; margin-right: 10px;"/>
                    <div class="pull-left mb32" style="width: 75%%">
                        <textarea rows="3" name="comment" class="form-control" placeholder="Write a comment..."></textarea>
                        <button type="submit" class="btn btn-primary mt8">Post</button>
                    </div>
                </form>
            </section>
            <div class="clearfix"/>
        </xpath>
    </template>

    <!-- Options: Blog Post: hide author -->
    <template id="opt_blog_post_complete_author" name="Authors"
            inherit_option_id="website_blog.blog_post_complete">
        <xpath expr="//span[@class='fa-calendar']" position="after">
            <span class="fa fa-user"> By <span t-field="blog_post.create_uid"/> &amp;nbsp;</span>
        </xpath>
    </template>

    <!-- Options: Blog Post: show category -->
    <template id="opt_blog_post_complete_category" name="Blog Category"
            inherit_option_id="website_blog.blog_post_complete">
        <xpath expr="//span[@class='fa-calendar']" position="after">
            <span class="fa fa-folder-open"> In <span t-field="blog_post.category_id"/> &amp;nbsp;</span>
        </xpath>
    </template>

    <!-- Options: Blog Post: show tags -->
    <template id="opt_blog_post_complete_tags" name="Tags"
            inherit_option_id="website_blog.blog_post_complete" inherit_id="website_blog.blog_post_complete">
        <xpath expr="//p[@name='blog_post_data']" position="after">
            <p class="post-meta text-muted text-center" t-if="len(blog_post.tag_ids)">
                <span class="fa fa-tags"/>
                <t t-foreach="blog_post.tag_ids" t-as="tag">
                    <a t-href="/blog/#{ slug(category) }/tag/#{ slug(tag) }" t-esc="tag.name"/> &amp;nbsp;
                </t>
            </p>
        </xpath>
    </template>

    <!-- Page -->
    <template id="index" name="Blog Navigation">
        <t t-call="website.layout">
            <t t-set="head">
                <link rel='stylesheet' href='/website_blog/static/src/css/website_blog.css'/>
            </t>
            <div id="wrap">
                <div class="oe_structure"></div>
                <div class="container mt16 js_website_blog">
                    <div class="row">
                        <div class="col-lg-12 col-sm-12" id="blog_left_column">
                            <t t-raw="0"/>
                        </div>
                        <div class="col-lg-3 col-lg-offset-1 col-sm-4" id="blog_right_column"/>
                    </div>
                </div>
                <div class="oe_structure"></div>
            </div>
        </t>
    </template>

    <!-- Option: Right Column: tags -->
    <template id="opt_blog_rc_tags" name="Tags"
            inherit_option_id="website_blog.index" inherit_id="website_blog.index">
        <xpath expr="//div[@id='blog_right_column']" position="inside">
            <section class="mt32">
            <h4>Tags</h4>
            <ul class="nav nav-pills nav-stacked">
                <t t-foreach="tags" t-as="tag_id">
                <li t-att-class="tag and tag_id.id == tag.id and 'active' or None" style="display: inline-block;">
                    <a t-href="/blog/#{ slug(category) }/tag/#{ slug(tag_id) }"><span t-field="tag_id.name"/></a>
                </li>
                </t>
            </ul>
            </section>
        </xpath>
    </template>

    <!-- Option: Right Column: archives -->
    <template id="opt_blog_rc_history" name="Archives"
            inherit_option_id="website_blog.index" inherit_id="website_blog.index">
        <xpath expr="//div[@id='blog_left_column']" position="attributes">
            <attribute name="class">col-lg-8 col-sm-8</attribute>
        </xpath>
        <xpath expr="//div[@id='blog_right_column']" position="inside">
            <section class="mt32">
            <h4>Archives</h4>
            <ul class="nav nav-pills nav-stacked">
                <t t-foreach="nav_list" t-as="months">
                <li t-att-class="months['date'] == date and 'active' or None">
                    <a t-ignore="True" t-href="/blog/#{ slug(category) }/#{ tag and 'tag/%s/' % slug(tag) or '' }date/#{ months['date'] }"><t t-esc="months['create_date']"/><span class="pull-right badge" t-esc="months['create_date_count']"/></a>
                </li>
                </t>
            </ul>
            </section>
        </xpath>
    </template>

    <!-- Option: Right Column: about us -->
    <template id="opt_blog_rc_about_us" name="About Us" priority="2"
            inherit_option_id="website_blog.index" inherit_id="website_blog.index">
        <xpath expr="//div[@id='blog_left_column']" position="attributes">
            <attribute name="class">col-lg-8 col-sm-8</attribute>
        </xpath>
        <xpath expr="//div[@id='blog_right_column']" position="inside">
            <section class="mt32">
            <h4>About us</h4>
            <p>
                Write here a small text for <b>new visitors</b> finding your website
                through your <b>blog entries</b>, referenced in Google.
            </p>
            <div>
                <a href="/page/website.contactus"><button class="btn btn-primary">Contact us</button></a>
            </div>
            </section>
        </xpath>
    </template>

    <!-- Option: Right Column: follow us -->
    <template id="opt_blog_rc_follow_us" name="Follow us" priority="4"
            inherit_option_id="website_blog.index" inherit_id="website_blog.index">
        <xpath expr="//div[@id='blog_left_column']" position="attributes">
            <attribute name="class">col-lg-8 col-sm-8</attribute>
        </xpath>
        <xpath expr="//div[@id='blog_right_column']" position="inside">
            <section class="mt32">
                <h4>Follow us<small t-if="category">: <t t-esc="category.name"/></small></h4>
                <t t-if="category">
                    <t t-call="website_mail.follow">
                        <t t-set="email" t-value="user_id.email"/>
                        <t t-set="object" t-value="category"/>
                    </t>
                </t>
                <p class="text-muted mb0 mt16">
                    Participate on our social stream.
                </p>
                <h2 class="mt4">
                    <a t-att-href="website.social_facebook" t-if="website.social_facebook"><i class="fa fa-facebook-square"/></a>
                    <a t-att-href="website.social_twitter" t-if="website.social_twitter"><i class="fa fa-twitter"/></a>
                    <a t-att-href="website.social_linkedin" t-if="website.social_linkedin"><i class="fa fa-linkedin"/></a>
                    <a t-att-href="website.social_youtube" t-if="website.social_youtube"><i class="fa fa-youtube-play"/></a>
                    <a t-att-href="website.social_googleplus" t-if="website.social_googleplus"><i class="fa fa-google-plus-square"/></a>
                    <a t-att-href="website.social_github" t-if="website.social_github"><i class="fa fa-github"/></a>
                </h2>
            </section>
        </xpath>
    </template>

    <!-- Option: Right Column: categories -->
    <template id="opt_blog_rc_categories" name="Our Blogs" priority="6"
            inherit_option_id="website_blog.index">
        <xpath expr="//div[@id='blog_left_column']" position="attributes">
            <attribute name="class">col-lg-8 col-sm-8</attribute>
        </xpath>
        <xpath expr="//div[@id='blog_right_column']" position="inside">
            <section class="mt32 mb32">
            <h4>Our Blogs</h4>
            <ul class="nav nav-pills nav-stacked">
                <t t-foreach="categories" t-as="nav_category">
                    <li t-att-class="nav_category.id == category.id and 'active' or ''">
                        <a t-href="/blog/#{ slug(nav_category) }">
                            <span t-field="nav_category.name"/>
                        </a>
                    </li>
                </t>
            </ul>
            </section>
        </xpath>
    </template>

</data>
</openerp>
