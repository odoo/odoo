<?xml version="1.0" encoding="UTF-8" ?>
<templates xml:space="preserve">
    <t t-name="website.locationSelector.mapContainer">
        <div class="d-flex flex-column h-100 w-100">
            <Map
                t-if="this.state.shouldLoadMap"
                locations="this.props.locations"
                pressControlToZoom="this.props.pressControlToZoom"
                showDetailsTooltip="this.props.showDetailsTooltip"
                selectedLocationId="this.props.selectedLocationId"
                setVisibleLocations="this.props.setVisibleLocations"
                setSelectedLocation="this.props.setSelectedLocation"
                showIndexes="this.props.showIndexes"
                showEmail="this.props.showEmail"
                showImage="this.props.showImage"
                showPhone="this.props.showPhone"
                showWebsite="this.props.showWebsite"
                showLocationNameOnMarkerHover="this.props.showLocationNameOnMarkerHover"
                mapZoom="this.props.mapZoom"
            />
            <div
                t-else=""
                class="d-flex justify-content-center align-items-center flex-grow-1 w-100 bg-200"
            >
                <span t-out="errorMessage"/>
            </div>

            <!-- Desktop infos -->
            <div t-if="selectedLocation and this.props.showDetailsTextArea" class="o_location_selector_textarea d-none d-md-flex justify-content-between flex-column flex-lg-row gap-3 gap-lg-0 p-4">
                <div class="col-lg-5 d-flex flex-column justify-content-between">
                    <div class="d-flex gap-2">
                        <strong
                        t-if="this.props.showIndexes and this.props.locations.length !== 1"
                        class="o_location_selector_number flex-shrink-0 h5 fw-bold text-center"
                        t-out="this.props.locations.indexOf(selectedLocation) + 1"
                        />
                        <div class="d-flex flex-column flex-grow-1">
                            <strong class="h5 fw-bold" t-out="selectedLocation.name"/>
                            <small t-out="selectedLocation.street"/>
                            <small t-out="this.getCityAndZipCode(selectedLocation)"/>
                            <br/>
                            <t t-if="(this.props.showImage and selectedLocation.image_256) or (this.props.showPhone and selectedLocation.phone) or (this.props.showEmail and selectedLocation.email) or (this.props.showWebsite and selectedLocation.website)">
                                <b>Additional details:</b>
                            </t>
                            <t t-if="this.props.showPhone and selectedLocation.phone">
                                <small>
                                    <i class="fa fa-phone fa-fw me-1"/>
                                    <t t-out="selectedLocation.phone"/>
                                </small>
                            </t>
                            <t t-if="this.props.showEmail and selectedLocation.email">
                                <small>
                                    <i class="fa fa-envelope fa-fw me-1"/>
                                    <a t-attf-href="mailto:{{selectedLocation.email}}">
                                        <t t-out="selectedLocation.email"/>
                                    </a>
                                </small>
                            </t>
                            <t t-if="this.props.showWebsite and selectedLocation.website">
                                <small>
                                    <i class="fa fa-globe fa-fw me-1"/>
                                    <a t-attf-href="{{selectedLocation.website}}" target="_blank">
                                        <t t-out="selectedLocation.website"/>
                                    </a>
                                </small>
                            </t>
                            <t t-if="this.props.showImage and selectedLocation.image_256">
                                <img t-attf-src="data:image/png;base64,{{selectedLocation.image_256}}" style="max-width: 256px; width: 100%; height: auto;"/>
                            </t>
                        </div>
                    </div>
                    <!-- large screen and + -->
                    <button
                    t-if="this.props.validateSelection"
                    type="button"
                    id="submit_location_large"
                    class="btn btn-primary d-none d-lg-block mt-3"
                    t-att-disabled="!this.props.selectedLocationId"
                    t-on-click="this.props.validateSelection"
                    t-out="chooseLocationButtonLabel"/>
                </div>
                
                <!-- Schedule -->
                <LocationSchedule
                openingHours="selectedLocation.opening_hours"
                wrapClass="'col-lg-7 flex-grow-1 flex-lg-grow-0 ps-lg-4'"
                />
                
                <!-- medium size screen like Tablets, etc. -->
                <button
                t-if="this.props.validateSelection"
                type="button"
                id="submit_location_medium"
                class="btn btn-primary d-block d-lg-none align-self-stretch ms-lg-4"
                t-att-disabled="!this.props.selectedLocationId"
                t-on-click="this.props.validateSelection"
                t-out="chooseLocationButtonLabel"/>
            </div>

            <!-- Mobile infos -->
            <button
                t-if="selectedLocation and this.props.showDetailsTextArea"
                class="btn collapsed d-flex d-md-none gap-2 gap-lg-3 w-100 border-0 p-3 bg-transparent text-start"
                type="button"
                data-bs-target="#map_collapseHours"
                aria-expanded="false"
                aria-controls="map_collapseHours"
                data-bs-toggle="collapse"
            >
                <strong
                    t-if="this.props.showIndexes and this.props.locations.length !== 1"
                    t-out="this.props.locations.indexOf(selectedLocation) + 1"
                    class="o_location_selector_number fw-bold text-center"
                />
                <span class="d-flex flex-column gap-1 w-100">
                    <span class="d-flex flex-column">
                        <strong class="fw-bold" t-out="selectedLocation.name"/>
                        <small class="text-muted">
                            <span t-out="selectedLocation.street"/>
                            <span class="d-block" t-out="this.getCityAndZipCode(selectedLocation)"/>
                        </small>
                    </span>

                    
                    <!-- Additional details -->
                    <t t-if="(this.props.showImage and selectedLocation.image_256) or (this.props.showPhone and selectedLocation.phone) or (this.props.showEmail and selectedLocation.email) or (this.props.showWebsite and selectedLocation.website)">
                        <span class="d-flex align-items-center gap-1 small fw-bold">
                            Additional details:
                            <i class="o_location_selector_hours_caret fa fa-caret-up ms-auto transition-base"/>
                        </span>
                        <span class="collapse" id="map_collapseHours">
                            <t t-if="this.props.showPhone and selectedLocation.phone">
                                <small>
                                    <i class="fa fa-phone fa-fw me-1"/>
                                    <t t-out="selectedLocation.phone"/>
                                </small>
                                <br/>
                            </t>
                            <t t-if="this.props.showEmail and selectedLocation.email">
                                <small>
                                    <i class="fa fa-envelope fa-fw me-1"/>
                                    <a t-attf-href="mailto:{{selectedLocation.email}}">
                                        <t t-out="selectedLocation.email"/>
                                    </a>
                                </small>
                                <br/>
                            </t>
                            <t t-if="this.props.showWebsite and selectedLocation.website">
                                <small>
                                    <i class="fa fa-globe fa-fw me-1"/>
                                    <a t-attf-href="{{selectedLocation.website}}" target="_blank">
                                        <t t-out="selectedLocation.website"/>
                                    </a>
                                </small>
                                <br/>
                            </t>
                            <t t-if="this.props.showImage and selectedLocation.image_256">
                                <img t-attf-src="data:image/png;base64,{{selectedLocation.image_256}}" style="max-width: 256px; width: 100%; height: auto;"/>
                                <br/>
                            </t>
                            <t t-if="Object.keys(selectedLocation.opening_hours || {}).length">
                                <small class="d-flex align-items-center gap-1 small">
                                    <i class="fa fa-clock-o" role="img"/>
                                    <t t-out="openingHoursLabel"/>
                                </small>
                                <LocationSchedule openingHours="selectedLocation.opening_hours"/>
                            </t>
                        </span>
                    </t>
                    <t t-else="">
                        <!-- Schedule -->
                        <span class="d-flex align-items-center gap-1 small fw-bold {{Object.keys(selectedLocation.opening_hours).length > 0 ? 'd-md-none' : 'd-none'}}">
                            <i class="fa fa-clock-o" role="img"/>
                            <t t-out="openingHoursLabel"/>
                            <i class="o_location_selector_hours_caret fa fa-caret-up ms-auto transition-base"/>
                        </span>
                        <span class="collapse" id="map_collapseHours">
                            <LocationSchedule openingHours="selectedLocation.opening_hours"/>
                        </span>
                    </t>    

                </span>
            </button>
        </div>
    </t>
</templates>
