<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">

<t t-name="website.search_image_item">
    <img t-if="result['image_url']" t-att-src="result['image_url']" class="flex-shrink-0 o_image_64_cover"/>
    <i t-else="" t-attf-class="o_image_64_contain text-center pt16 fa #{result['_fa']}" style="font-size: 34px;"/>
</t>

<t t-name="website.search_items_page">
    <t t-foreach="bucket.data" t-as="result" t-key="result_index">
        <div t-attf-class="#{row_classes}">
            <a t-att-href="result['website_url']" class="h-100 p-2 text-decoration-none d-flex align-items-center">
                <div class="o_search_result_item_content p-2">
                    <div class="fs-6 fw-bold" t-out="result['name']"/>
                    <div id="o_search_item_matching_content">
                        <p t-if="result['description']" class="small"
                            t-out="result['description']"/>
                    </div>
                </div>
            </a>
        </div>
    </t>
</t>

<!-- Search Bar autocomplete item -->
<div t-name="website.s_searchbar.autocomplete" class="o_dropdown_menu show position-absolute w-100 p-2">
    <!-- Fuzzy search fallback -->
    <t t-if="fuzzySearch and Object.keys(results).length !== 0">
        <span class="dropdown-item-text">
            <span class="text-muted">
                No results found for '<t t-out="search"/>'. Showing results for
                '<a href="#" class="s_searchbar_fuzzy_submit" t-out="fuzzySearch"/>'.
            </span>
        </span>
    </t>
    <!-- No result state -->
    <t t-elif="Object.keys(results).length === 0">
        <span class="dropdown-item-text">
            <span class="text-muted">No results found. Please try another search.</span>
        </span>
    </t>
    <!-- Render results -->
    <t t-foreach="Object.values(results)" t-as="group_result" t-key="group_result_index">
        <t t-set="bucket" t-value="group_result"/>
        <!-- Group header -->
        <div class="d-flex align-items-center justify-content-between">
            <div t-if="Object.keys(results).length > 1 || widget.searchType === 'all'" class="d-flex gap-1 p-2">
                <span class="fw-bold" t-out="bucket.groupName"/>
                <span class="text-muted"> - <t t-out="bucket.searchCount"/> <t t-out="(bucket.searchCount > 1) ? 'results': 'result'" /></span>
            </div>
            <!-- Show 'View More' if bucket has more results than visibility limit -->
            <t t-set="redirect_hash" t-value="bucket['groupName'].replace(' ', '_').toLowerCase()"/>
            <a t-if="bucket.searchCount > limit and widget.searchType === 'all'"
                type="button"
                class="text-primary-emphasis fw-semibold btn btn-link btn-sm"
                t-attf-href="/website/search?search=#{search}##{redirect_hash}">
                View More
            </a>
        </div>

        <t t-set="row_classes" t-value="'o_search_result_item col-12 ' + (displayType === 'columns' ? 'col-md-6 col-lg-4' : '')"/>

        <!-- Items -->
         <div class="row g-0 p-2">
            <t t-call="{{ bucket.templateKey }}"/>
         </div>
    </t>
</div>

</templates>
