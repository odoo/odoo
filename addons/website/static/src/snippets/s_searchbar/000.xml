<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">

<t t-name="website.search_image_item">
    <div class="d-flex align-items-center justify-content-baseline flex-column">
        <img t-if="result['image_url']" t-att-src="result['image_url']"
            class="flex-shrink-0 o_image_64_contain"/>
        <i t-else="" t-attf-class="o_image_64_contain text-center pt16 fa #{result['_fa']}"
            style="font-size: 34px;"/>
    </div>
</t>

<t t-name="website.search_description_item">
    <t t-set="description" t-value="result['description']"/>
    <p t-if="description" class="mb-0 w-100 text-truncate" t-out="description"/>
</t>

<t t-name="website.search_items">
    <div class="o_before_search_result_item_detail d-flex align-items-center justify-content-baseline flex-column flex-shrink-0"/>
    <div class="o_search_result_item_detail px-3" style="max-width: 100%; width: 60%;">
        <div t-attf-class="h6 fw-bold #{description ? '' : 'mb-0'}" t-out="result['name']"/>
            <!-- There is no separate module for website.page  -->
        <t t-if="result['model'] == 'website.page'" t-call="website.search_description_item"/>
    </div>
    <div class="o_after_search_result_item_detail flex-shrink-0 ms-auto" style="font-size: 13px;"/>
</t>

    <!-- Search Bar autocomplete item -->
<div t-name="website.s_searchbar.autocomplete"
     class="o_dropdown_menu show position-absolute w-100">

    <!-- Fuzzy search fallback -->
    <t t-if="fuzzySearch and Object.keys(results).length === 0">
        <span class="dropdown-item-text">
            <span class="text-muted">
                No results found for '<t t-out="search"/>'. Showing results for
                '<a href="#" class="s_searchbar_fuzzy_submit" t-out="fuzzySearch"/>'.
            </span>
        </span>
    </t>

    <!-- Normal no-result state -->
    <t t-elif="Object.keys(results).length === 0">
        <span class="dropdown-item-text">
            <span class="text-muted">No results found. Please try another search.</span>
        </span>
    </t>

    <!-- Render results -->
    <t t-foreach="Object.entries(results)" t-as="grp" t-key="grp[0]">

        <!-- grp[0] = Group Name (Pages, Blogs, etc.) -->
        <!-- grp[1] = Single bucket object -->
        <t t-set="bucket" t-value="grp[1]"/>

        <!-- Group header -->
        <div class="d-flex align-items-center justify-content-between">
            <div class="px-3 py-2 fw-bold">
                <t t-out="bucket.rowTitle"/>
            </div>

            <!-- Show 'View More' if bucket has data equal or more results than limit -->
            <button t-if="bucket.data.length >= limit"
                    type="button"
                    class="text-primary-emphasis fw-semibold btn btn-link btn-sm"
                    t-att-data-group-name="bucket.model">
                View More
            </button>
        </div>

        <!-- Items -->
        <div class="row g-0 px-2 py-2">
            <t t-foreach="bucket.data" t-as="result" t-key="result['website_url']">
                <div class="col-12 col-md-4">
                    <a  t-att-href="result['website_url']"
                        class="dropdown-item o_search_result_item p-2 text-wrap w-100 h-100
                            d-flex align-items-center justify-content-baseline
                            flex-nowrap text-truncate"
                        style="min-height: 80px;">
                        <t t-call="website.search_items"/>
                    </a>
                </div>
            </t>
        </div>
    </t>
</div>


</templates>
