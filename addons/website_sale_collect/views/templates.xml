<?xml version="1.0" encoding="utf-8" ?>
<odoo>

    <template
        id="payment_confirmation_status"
        inherit_id="website_sale.payment_confirmation_status"
    >
        <xpath expr="(//div[hasclass('card-body')])[1]" position="replace">
            <t t-if="tx_sudo.provider_id.custom_mode == 'on_site'">
                <div class="card-body">
                    <div class="o_header_carrier_message">
                        <b t-out="order.carrier_id.name"/>
                        <span class="text-muted"> (In-store pickup)</span>
                    </div>
                    <div class="o_body_carrier_message">
                        <t t-out="order.carrier_id.website_description"/>
                    </div>
                </div>
            </t>
            <t t-else="">
                <t>$0</t> <!-- Replaced by old content. -->
            </t>
        </xpath>
    </template>

    <template id="product_page_click_and_collect" inherit_id="website_sale.product">
        <xpath expr="//div[@id='o_wsale_cta_wrapper']" position="before">
            <owl-component
                t-if="combination_info.get('show_click_and_collect_availability')"
                name="website_sale_collect.ClickAndCollectAvailability"
                t-att-props="json.dumps({
                    'productId': product_variant.id,
                    'zipCode': zip_code,
                    'selectedWhLocation': selected_wh_location or {},
                    'inStoreStock': combination_info['in_store_stock'],
                })"
                class="d-flex o_not_editable"
            />
        </xpath>
    </template>

    <template id="delivery_location_selector" inherit_id="website_sale.delivery_address_row">
        <div id="delivery_address_row" position="inside">
            <div name="o_pickup_location" class="o_portal_address_row d-none">
                <t t-set="pickup_location_data" t-value="order.pickup_location_data or {}"/>
                <a
                    t-if="not pickup_location_data"
                    name="o_pickup_location_selector"
                    role="button"
                    class="o_address_find_store d-flex align-items-center justify-content-center rounded no-decoration"
                >
                    <div>
                        <span class="d-md-inline">
                            <i class="fa fa-search"/>
                        </span>
                        <span>
                            Choose Store
                        </span>
                    </div>
                </a>
                <span
                    name="o_pickup_location_selector"
                    t-attf-class="card position-relative
                        {{'bg-primary border border-primary js_change_address'
                        if pickup_location_data else 'border border-0 d-none'}}"
                    t-att-data-location-id="pickup_location_data.get('id')"
                    t-att-data-zip-code="pickup_location_data.get('zip_code')"
                    t-att-data-pickup-location-data="json.dumps(pickup_location_data)"
                >
                    <div t-attf-class="card-body d-flex flex-column align-items-start">
                        <div class="d-flex justify-content-between w-100">
                            <span
                                name="o_pickup_location_name"
                                class="d-block fw-bold"
                                t-out="pickup_location_data.get('name', '')"
                            />
                            <a
                                name="edit_pickup_address"
                                t-attf-class="js_edit_address btn btn-link p-0 mt-auto
                                    {{'d-none' if not pickup_location_data else ''}}"
                                role="button"
                            >
                                <i class="fa fa-search me-1"/>Change Store
                            </a>
                        </div>
                        <span name="o_pickup_location_address" class="lh-sm">
                            <t t-out="pickup_location_data.get('street', '')"/>
                            <br/>
                            <t
                                t-out="pickup_location_data.get('city', '')
                                + ' ' + pickup_location_data.get('zip_code', '')"
                            />
                            <br/>
                            <t t-out="pickup_location_data.get('country', '')"/>
                        </span>
                        <span name="o_pickup_location_details"></span>
                    </div>
                </span>
            </div>
        </div>
        <div id="delivery_address_row" position="attributes">
            <attribute name="class" separator=" " add="delivery_address_row"/>
        </div>
    </template>

</odoo>
