<?xml version="1.0" encoding="utf-8"?>
<openerp>
 <data>
          <menuitem
            id="hr.menu_hr_reporting"
            name="Reporting"
            parent="hr.menu_hr_root"
            sequence="40" />

        <!-- Tasks by projects and users


        <record id="view_task_project_form" model="ir.ui.view">
            <field name="name">task.report.form</field>
            <field name="model">task.report</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Tasks by User">
                    <field name="user_id" select="1"/>
                    <field name="company_id" select="1" widget="selection" groups="base.group_multi_company"/>
                    <field name="task_nbr" select="2"/>
                    <field name="task_hrs" select="2"/>
                    <field name="task_progress" select="2"/>
                    <field name="task_state" select="1"/>
                </form>
            </field>
        </record>

        <record id="view_task_project_graph" model="ir.ui.view">
            <field name="name">task.report.graph</field>
            <field name="model">task.report</field>
            <field name="type">graph</field>
            <field name="arch" type="xml">
                <graph string="Tasks by User" type="bar">
                    <field name="user_id"/>
                    <field name="task_progress" operator="+"/>
                </graph>
            </field>
        </record>

        <record id="view_task_project_tree" model="ir.ui.view">
            <field name="name">task.report.tree</field>
            <field name="model">task.report</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Tasks by User">
                	<field name="date_start" select="1"  invisible="1"/>
                	<field name="name" select="1"/>
                	<field name="project_id" select="1"/>
                	<field name="assign_to" select="1"/>
                	<field name="type" select="1" invisible="1"/>
                	<field name="priority" select="1" invisible="1"/>
                	<field name="date_end" select="1" invisible="1"/>
	                <field name="month" select="1" invisible="1"/>
	                <field name="year" select="1" invisible="1"/>
                    <field name="user_id" invisible="1"/>
                    <field name="remaining_hrs"/>
                    <field name="date_deadline" invisible="1"/>
                    <field name="company_id" groups="base.group_multi_company"/>
                    <field name="task_nbr"/>
                    <field name="task_hrs"/>
                    <field name="task_progress"/>
                    <field name="task_state"/>
                </tree>
            </field>
        </record>

        <record id="view_report_task_search" model="ir.ui.view">
            <field name="name">task.report.search</field>
            <field name="model">task.report</field>
            <field name="type">search</field>
            <field name="arch" type="xml">
            	<search string="Tasks by User">
            		<group>
	            		<filter icon="terp-project" string="This Year" domain="[('year','=',time.strftime('%%Y'))]" help="Tasks performed in this year"/>
	            		<filter icon="terp-project" string="This Month" domain="[('month','=',time.strftime('%%m'))]" help="Tasks performed in this month"/>
	            		<separator orientation="vertical"/>
	            		<filter string="Start Date" icon="terp-project" domain="[('date_start','=',time.strftime('%%Y/%%m/%%d'))]"/>
                 		<filter string="End Date" icon="terp-project" domain="[('date_end','=',time.strftime('%%Y/%%m/%%d'))]"/>
                 	   <filter string="Deadline Date" icon="terp-project" domain="[('date_deadline','=',time.strftime('%%Y/%%m/%%d'))]"/>
	            		<separator orientation="vertical"/>
	            		<field name="project_id" select="1"/>
	                    <field name="user_id" select="1" widget="selection">
	            			<filter icon="terp-project" name="my_task" string="My Task" domain="[('user_id','=',uid)]" default="1"/>
                		</field>
                		<newline/>
                		<group expand="1" string="Extended options..." colspan="10" col="12">
                    		<filter icon="terp-project"
                    		string="Very urgent"
                    		domain="[('priority','=','0')]"/>
                    		<filter icon="terp-project"
                    		string="Urgent"
                    		domain="[('priority','=','1')]"/>
                    		<filter icon="terp-project"
                    		string="Medium"
                    		domain="[('priority','=','2')]"/>
                    		<filter icon="terp-project"
                    		string="Low"
                    		domain="[('priority','=','3')]"/>
                    		<filter icon="terp-project"
                    		string="Very Low"
                    		domain="[('priority','=','4')]"/>
                		</group>
	                    <newline/>
                		<group expand="1" string="Group By..." >
                    		<filter string="User" icon="terp-project" context="{'group_by':'user_id'}" />
                    		<filter string="Project" icon="terp-project" context="{'group_by':'project_id'}" />
                    		<filter string="Company" icon="terp-project" context="{'group_by':'company_id'}" />
                 			<separator orientation="vertical"/>
                 			<filter string="State" icon="terp-project" context="{'group_by':'task_state'}"/>
                 			<filter string="Stage" icon="terp-project" context="{'group_by':'type'}"/>
   							<separator orientation="vertical"/>
                    		<filter string="Month" icon="terp-project" context="{'group_by':'month'}"/>
                    		<filter string="Year" icon="terp-project" context="{'group_by':'year'}"/>
                		</group>
	                </group>
            	</search>
            </field>
        </record>

        <record id="action_project_task" model="ir.actions.act_window">
            <field name="name">Tasks</field>
            <field name="res_model">task.report</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,graph</field>
            <field name="domain">[]</field>
            <field name="context">{"search_default_my_task":1}</field>
            <field name="search_view_id" ref="view_report_task_search"/>
        </record>
        <menuitem id="base.menu_project_report" name="Reporting" parent="base.menu_main_pm" sequence="50"/>
        <menuitem action="action_project_task" id="menu_project_task_user_tree" parent="base.menu_project_report"/>
-->
        <!-- Report for Users' Timesheet and Task Hours per Month -->

		<record id="view_report_timesheet_task_user_tree" model="ir.ui.view">
            <field name="name">report.timesheet.task.user.tree</field>
            <field name="model">report.timesheet.task.user</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Timesheet/Task hours Report Per Month" >
                    <field name="name" select="1"/>
                    <field name="year" select="1" invisible="1"/>
                    <field name="month" select="1" invisible="1"/>
                    <field name="user_id" select="1"/>
                    <field name="timesheet_hrs" widget="float_time" />
                    <field name="task_hrs"  widget="float_time"/>
                </tree>
            </field>
        </record>
      <record id="view_report_timesheet_task_user_search" model="ir.ui.view">
            <field name="name">report.timesheet.task.user.search</field>
            <field name="model">report.timesheet.task.user</field>
            <field name="type">search</field>
            <field name="arch" type="xml">
            	<search string="Tasks by User">
            		<group colspan="4" col="3">
	            		<filter icon="terp-project" string="This Year" domain="[('year','=',time.strftime('%%Y'))]" />
	            		<filter icon="terp-project" string="This Month" domain="[('month','=',time.strftime('%%m'))]" />
	            		<separator orientation="vertical"/>
	                    <field name="user_id" select="1" widget="selection">
	            			<filter icon="terp-project" string="My Task" domain="[('user_id','=',uid)]" />
                		</field>
                	</group>
                	<newline/>
                	<group expand="1" string="Group By..." colspan="4" col="3">
                	    <filter string="User" icon="terp-project" context="{'group_by':'user_id'}" />
                    	<filter string="Year" icon="terp-project" context="{'group_by':'year'}" />
                    	<filter string="Month" icon="terp-project" context="{'group_by':'month'}" />
                	</group>
            	</search>
            </field>
        </record>
        <record id="action_report_timesheet_task_user" model="ir.actions.act_window">
            <field name="name">Timesheet / Task Hours Per Month</field>
            <field name="res_model">report.timesheet.task.user</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree</field>
            <field name="context">{"search_default_User":1}</field>
            <field name="search_view_id" ref="view_report_timesheet_task_user_search"/>
        </record>
        <menuitem id="menu_timesheet_task_user" parent="hr.menu_hr_reporting" action="action_report_timesheet_task_user"/>

    </data>
</openerp>
