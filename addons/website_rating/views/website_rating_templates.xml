<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="assets_frontend" inherit_id="website.assets_frontend" name="Website rating frontend assets">
        <xpath expr="." position="inside">
            <script type="text/javascript" src="/website_rating/static/src/js/website_mail.js"></script>
            <link rel="stylesheet" type="text/scss" href="/website_rating/static/src/scss/website_rating.scss"/>
        </xpath>
    </template>

    <template id="message_thread" inherit_id="portal.message_thread">
        <xpath expr="//div[@id='discussion']" position="attributes">
            <attribute name="t-att-data-display_rating">display_rating or False</attribute>
        </xpath>
    </template>

    <!--
        Rating widget static: show 5 stars (full or empty) regarding the given rating_avg and rating_count
    -->
    <template id="rating_widget_stars_static" name="Rating: static star widget">
        <t t-set="rating_avg" t-value="round(rating_avg * 100) / 100"/>
        <t t-set="val_decimal" t-value="round(rating_avg % 1, 1)"/>
        <t t-set="val_integer" t-value="int(rating_avg)"/>
        <t t-set="empty_star" t-value="5 - (val_integer+1) if val_decimal else 5 - val_integer"/>
        <div class="o_website_rating_static" t-att-style="'display:inline' if inline_mode else ''" t-att-title="rating_avg">
            <t t-foreach="range(0, val_integer)" t-as="num">
                <i class="fa fa-star" role="img"></i>
            </t>
            <t t-if="val_decimal">
                <i class="fa fa-star-half-o" role="img"></i>
            </t>
            <t t-foreach="range(0, empty_star)" t-as="num" role="img">
                <i class="fa fa-star-o"></i>
            </t>
            <t t-if="rating_count">
                (<t t-esc="rating_count"/>)
            </t>
        </div>
    </template>

</odoo>
