<?xml version="1.0"?>
<openerp>
    <data>

        <!-- Top menu item -->
        <menuitem name="Point of Sale"
            id="menu_point_root"
            groups="group_pos_manager,group_pos_user"
            icon="fa-suitcase"
            web_icon="point_of_sale,static/description/icon.png"
            sequence="20"/>

        <record model="ir.ui.view" id="view_pos_pos_form">
            <field name="name">pos.order</field>
            <field name="model">pos.order</field>
            <field name="arch" type="xml">
                <form string="Point of Sale Orders">
                    <header>
                        <button name="%(action_pos_payment)d" string="Payment" class="oe_highlight" type="action" states="draft" context="{'pos_session_id' : session_id}"/>
                        <button name="action_invoice" string="Invoice" type="object" states="paid" attrs="{'readonly': [('partner_id','=',False)]}"/>
                        <button name="refund" string="Return Products" type="object" 
                            attrs="{'invisible':[('state','=','draft')]}"/>
                        <button name="%(action_report_pos_receipt)d" string="Reprint" type="action" states="paid,done,invoiced"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,paid,done" statusbar_colors='{"cancel":"red"}'/>
                    </header>
                    <sheet>
                    <group col="4" colspan="4" name="order_fields">
                        <field name="name"/>
                        <field name="date_order"/>
                        <field name="session_id" />
                        <field name="partner_id" on_change="onchange_partner_id(partner_id, context)" domain="[('customer', '=', True)]" context="{'search_default_customer':1}" attrs="{'readonly': [('state','=','invoiced')]}"/>
                        <field name="fiscal_position_id" options="{'no_create': True}"/>
                    </group>
                    <notebook colspan="4">
                        <page string="Products">
                            <field name="lines" colspan="4" nolabel="1">
                                <tree string="Order lines" editable="bottom">
                                    <field name="product_id" on_change="onchange_product_id(parent.pricelist_id,product_id,qty,parent.partner_id)"/>
                                    <field name="qty" on_change="onchange_qty(parent.pricelist_id,product_id, discount, qty, price_unit, context)"/>
                                    <field name="price_unit" on_change="onchange_qty(parent.pricelist_id,product_id, discount, qty, price_unit, context)" widget="monetary"/>
                                    <field name="discount"  on_change="onchange_qty(parent.pricelist_id,product_id, discount, qty, price_unit, context)" widget="monetary"/>
                                    <field name="tax_ids_after_fiscal_position" widget="many2many_tags"/>
                                    <field name="tax_ids" invisible="1"/>
                                    <field name="price_subtotal" widget="monetary"/>
                                    <field name="price_subtotal_incl" widget="monetary"/>
                                </tree>
                                <form string="Order lines">
                                    <group col="4">
                                        <field name="product_id" on_change="onchange_product_id(parent.pricelist_id,product_id,qty,parent.partner_id)"/>
                                        <field name="qty" on_change="onchange_qty(parent.pricelist_id,product_id, discount, qty, price_unit, context)"/>
                                        <field name="discount"  on_change="onchange_qty(parent.pricelist_id,product_id, discount, qty, price_unit, context)" widget="monetary"/>
                                        <field name="price_unit" on_change="onchange_qty(parent.pricelist_id,product_id, discount, qty, price_unit, context)" widget="monetary"/>
                                        <field name="price_subtotal" invisible="1" widget="monetary"/>
                                        <field name="price_subtotal_incl" invisible="1" widget="monetary"/>
                                        <field name="tax_ids_after_fiscal_position" widget="many2many_tags"/>
                                        <field name="tax_ids" invisible="1"/>
                                        <field name="notice"/>
                                    </group>
                                </form>
                            </field>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="order_total">
                                <field name="amount_tax" widget="monetary"/>
                                <div class="oe_subtotal_footer_separator oe_inline">
                                    <label for="amount_total" />
                                    <button name="button_dummy"
                                        states="draft" string="(update)" class="oe_edit_only oe_link"/>
                                </div>
                                <field name="amount_total" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary"/>
                            </group>
                            <div class="oe_clear"/>
                        </page>
                        <page string="Payments">
                            <field name="statement_ids" colspan="4" nolabel="1">
                                <tree editable="bottom" string="Statement lines">
                                    <field name="journal_id"/>
                                    <field name="statement_id"/>
                                    <field name="amount"/>
                                </tree>
                            </field>
                        </page>
                        <page name="extra" string="Extra Info">
                            <group string="General Information">
                                <field name="company_id" groups="base.group_multi_company"/>
                                <field name="location_id" widget="selection" groups="stock.group_locations"/>
                                <field name="user_id" context="{'default_groups_ref': ['base.group_user', 'base.group_partner_manager', 'point_of_sale.group_pos_user']}"/>
                                <field name="pricelist_id" groups="product.group_sale_pricelist"/>
                                <field name="picking_id" readonly="1"/>
                                <field name="pos_reference"/>
                            </group>
                            <group string="Accounting Information">
                                <group>
                                    <field name="sale_journal" domain="[('type','=','sale')]"/>
                                    <field name="invoice_id" readonly="1"
                                        attrs="{'invisible':[('state','&lt;&gt;','invoiced')]}"/>
                                    <field name="account_move" readonly="1"
                                        attrs="{'invisible':[('state','&lt;&gt;','done')]}"/>
                                </group>
                                <group>
                                    <button name="%(pos_invoice_report)d" string="Re-Print"
                                        icon="gtk-print" type="action" attrs="{'invisible':[('state','&lt;&gt;','invoiced')]}"/>
                                </group>
                            </group>
                        </page>
                        <page string="Notes" >
                            <field name="note"/>
                        </page>
                    </notebook>
                </sheet>
                </form>
            </field>
        </record>
        <record model="ir.actions.act_window" id="action_pos_pos_form">
            <field name="name">Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">pos.order</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" eval="False"/>
            <field name="domain">[]</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to create a new order.
              </p><p>
                Use this menu to browse previous orders. To record new
                orders, you may use the menu <i>Your Session</i> for
                the touchscreen interface.
              </p>
            </field>
        </record>
        <record model="ir.ui.view" id="view_pos_order_tree">
            <field name="name">Orders</field>
            <field name="model">pos.order</field>
            <field name="arch" type="xml">
                <tree string="POS Orders" decoration-info="state == 'draft'" decoration-muted="state in ('done','cancel')">
                    <field name="name"/>
                    <field name="pos_reference"/>
                    <field name="partner_id"/>
                    <field name="date_order"/>
                    <field name="user_id"/>
                    <field name="invoice_id"/>
                    <field name="amount_total" sum="Amount total" widget="monetary"/>
                    <field name="company_id" groups="base.group_multi_company"/>
                    <field name="state"/>
                    <field name="session_id" />
                </tree>
            </field>
        </record>
        <record id="view_pos_order_filter" model="ir.ui.view">
            <field name="name">pos.order.list.select</field>
            <field name="model">pos.order</field>
            <field name="arch" type="xml">
                <search string="Search Sales Order">
                    <field name="name" string="Sales Order"/>
                    <field name="date_order"/>
                    <field name="pos_reference"/>
                    <filter string="New" domain="[('state','=','draft')]"/>
                    <filter string="Done" domain="[('state','in',('paid','invoiced','done'))]"/>
                    <filter string="Invoiced" domain="[('state','=','invoiced')]"/>
                    <filter string="Posted" domain="[('state','=','done')]"/>
                    <field name="user_id"/>
                    <group expand="0" string="Group By">
                        <filter string="Customer" domain="[]" context="{'group_by':'partner_id'}"/>
                        <filter string="Salesperson" domain="[]" context="{'group_by':'user_id'}"/>
                        <filter string="Status" domain="[]" context="{'group_by':'state'}"/>
                        <filter string="Order Month" domain="[]" context="{'group_by':'date_order'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record model="ir.ui.view" id="view_pos_order_search">
            <field name="name">pos.order.search.view</field>
            <field name="model">pos.order</field>
            <field name="arch" type="xml">
                <search string="Point of Sale Orders">
                    <field name="name"/>
                    <field name="config_id"/>
                </search>
            </field>
        </record>

        <menuitem name="Orders" id="menu_point_of_sale" parent="menu_point_root" sequence="10"/>
        <menuitem parent="menu_point_of_sale" id="menu_point_ofsale" action="action_pos_pos_form" sequence="1" groups="group_pos_manager,group_pos_user"/>

        <record id="product_template_action" model="ir.actions.act_window">
            <field name="name">Products</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">product.template</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,kanban</field>
            <field name="context" eval="{}"/>
            <field name="domain" eval="[('available_in_pos','&lt;&gt;',False)]"/>
            <field name="search_view_id" eval="False"/> <!-- Force empty -->
            <field name="view_id" eval="False"/> <!-- Force empty -->
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to add a new product.
              </p><p>
                You must define a product for everything you sell through
                the point of sale interface.
              </p><p>
                Do not forget to set the price and the point of sale category
                in which it should appear. If a product has no point of sale
                category, you can not sell it through the point of sale
                interface.
              </p>
            </field>
        </record>
        <menuitem
            action="product_template_action"
            id="menu_pos_products"
            parent="menu_point_of_sale" sequence="3"/>

        <record model="ir.ui.view" id="view_pos_order_line">
            <field name="name">Sale lines</field>
            <field name="model">pos.order.line</field>
            <field name="arch" type="xml">
                <tree string="POS Order lines">
                    <field name="product_id" readonly="1"/>
                    <field name="qty" readonly="1" sum="Total qty"/>
                    <field name="discount" readonly="1" widget="monetary"/>
                    <field name="price_unit" readonly="1" widget="monetary"/>
                    <field name="price_subtotal" readonly="1" sum="Sum of subtotals" widget="monetary"/>
                    <field name="price_subtotal_incl" readonly="1" sum="Sum of subtotals" widget="monetary"/>
                    <field name="create_date" readonly="1"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="view_pos_order_line_form">
            <field name="name">Sale line</field>
            <field name="model">pos.order.line</field>
            <field name="arch" type="xml">
                <form string="POS Order line">
                    <group col="4">
                        <field name="product_id" />
                        <field name="qty" />
                        <field name="discount" widget="monetary"/>
                        <field name="price_unit" widget="monetary"/>
                        <field name="create_date" />
                    </group>
                </form>
            </field>
        </record>

        <record model="ir.actions.act_window" id="action_pos_order_line">
            <field name="name">Sale line</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">pos.order.line</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_pos_order_line"/>
        </record>

        <record model="ir.actions.act_window" id="action_pos_order_line_form">
            <field name="name">Sale line</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">pos.order.line</field>
            <field name="view_type">form</field>
            <field name="view_mode">form,tree</field>
            <field name="view_id" ref="view_pos_order_line_form"/>
        </record>

        <record model="ir.actions.act_window" id="action_pos_order_line_day">
            <field name="name">Sale line</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">pos.order.line</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_pos_order_line"/>
            <field name="domain">[('create_date', '&gt;=', time.strftime('%Y-%m-%d 00:00:00')),('create_date', '&lt;=', time.strftime('%Y-%m-%d 23:59:59'))]</field>
        </record>



        <!-- report -->

        <record model="ir.ui.view" id="view_pos_trans_user_form">
            <field name="name">report.trans.pos.user.form</field>
            <field name="model">report.transaction.pos</field>
            <field name="arch" type="xml">
                <form string="POS ">
                    <group col="4">
                        <field name="user_id"/>
                        <field name="journal_id"/>
                        <field name="jl_id"/>
                        <field name="date_create" widget="date"/>
                        <field name="no_trans"/>
                        <field name="amount"/>
                        <field name="invoice_id"/>
                    </group>
                </form>
            </field>
        </record>


        <record model="ir.ui.view" id="view_trans_pos_user_tree">
            <field name="name">Sales by user</field>
            <field name="model">report.transaction.pos</field>
            <field name="arch" type="xml">
                <tree string="POS">
                    <field name="date_create" widget="date" />
                    <field name="user_id"/>
                    <field name="journal_id"/>
                    <field name="jl_id"/>
                    <field name="no_trans" sum="Total Transaction"/>
                    <field name="amount" sum="Amount total"/>
                    <field name="product_nb" />
                    <field name="invoice_id"/>
                    <field name="disc"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="view_report_transaction_pos_calendar">
            <field name="name">report.transaction.pos.calendar</field>
            <field name="model">report.transaction.pos</field>
            <field eval="2" name="priority"/>
            <field name="arch" type="xml">
                <calendar color="user_id" date_start="date_create" string="POS Report">
                    <field name="journal_id"/>
                    <field name="amount"/>
                </calendar>
            </field>
         </record>

         <record model="ir.ui.view" id="view_report_transaction_pos_graph">
            <field name="name">report.transaction.pos.graph</field>
            <field name="model">report.transaction.pos</field>
            <field eval="2" name="priority"/>
            <field name="arch" type="xml">
                <graph  type="bar" string="POS Report">
                    <field name="user_id" />
                    <field name="amount"/>
                    <field group="True" name="journal_id"/>
                </graph>
            </field>
         </record>

        <record model="ir.actions.act_window" id="action_trans_pos_tree_today">
            <field name="name">Sales by day</field>
            <field name="res_model">report.transaction.pos</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,calendar,form,graph</field>
            <field name="domain">[('date_create','=',time.strftime('%Y-%m-%d'))]</field>
        </record>


        <record model="ir.actions.act_window" id="action_trans_pos_tree_month">
            <field name="name">Sales by month</field>
            <field name="res_model">report.transaction.pos</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,calendar,form,graph</field>
            <field name="domain">[('date_create','like',time.strftime('%Y-%m'))]</field>
        </record>


        <record model="ir.actions.act_window" id="action_trans_pos_tree">
            <field name="name">Sales by user</field>
            <field name="res_model">report.transaction.pos</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,calendar,form,graph</field>
            <field name="view_id" ref="view_trans_pos_user_tree"/>
        </record>


        <record model="ir.ui.view" id="view_report_sales_by_user_pos_form">
            <field name="name">report.sales.by.user.pos.form</field>
            <field name="model">report.sales.by.user.pos</field>
            <field name="arch" type="xml">
                <form string="POS ">
                    <group col="4">
                        <field name="date_order" widget="date"/>
                        <field name="qty"/>
                        <field name="amount"/>
                        <field name="user_id"/>
                    </group>
                </form>
            </field>
        </record>


        <record model="ir.ui.view" id="view_report_sales_by_user_pos_tree">
            <field name="name">report.sales.by.user.pos.tree</field>
            <field name="model">report.sales.by.user.pos</field>
            <field name="arch" type="xml">
                <tree string="POS">
                    <field name="date_order" widget="date"/>
                    <field name="qty"/>
                    <field name="amount"/>
                    <field name="user_id"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="view_report_sales_by_user_pos_calendar">
            <field name="name">report.sales.by.user.pos.calendar</field>
            <field name="model">report.sales.by.user.pos</field>
            <field eval="2" name="priority"/>
            <field name="arch" type="xml">
                <calendar color="user_id" date_start="date_order" string="POS Report">
                    <field name="qty"/>
                    <field name="amount" />
                </calendar>
            </field>
         </record>

        <record model="ir.ui.view" id="view_report_sales_by_user_pos_graph">
            <field name="name">report.sales.by.user.pos.graph</field>
            <field name="model">report.sales.by.user.pos</field>
            <field eval="2" name="priority"/>
            <field name="arch" type="xml">
                <graph  type="bar" string="Sales by User">
                    <field name="user_id" />
                    <field name="amount"/>
                </graph>
            </field>
         </record>

         <record model="ir.actions.act_window" id="action_report_sales_by_user_pos_today">
            <field name="name">Sales by User</field>
            <field name="res_model">report.sales.by.user.pos</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,calendar,form,graph</field>
            <field name="domain">[('date_order','=',time.strftime('%Y-%m-%d'))]</field>
         </record>


        <!-- Sales of user by month -->

        <record model="ir.ui.view" id="view_report_sales_by_user_pos_month_form">
            <field name="name">report.sales.by.user.pos.month.form</field>
            <field name="model">report.sales.by.user.pos.month</field>
            <field name="arch" type="xml">
                <form string="POS ">
                    <group col="4">
                        <field name="date_order" widget="date"/>
                        <field name="qty"/>
                        <field name="amount"/>
                        <field name="user_id"/>
                    </group>
                </form>
            </field>
        </record>


        <record model="ir.ui.view" id="view_report_sales_by_user_pos_month_tree">
            <field name="name">report.sales.by.user.pos.month.tree</field>
            <field name="model">report.sales.by.user.pos.month</field>
            <field name="arch" type="xml">
                <tree string="POS">
                    <field name="date_order" widget="date"/>
                    <field name="qty"/>
                    <field name="amount"/>
                    <field name="user_id"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="view_report_sales_by_user_pos_month_calendar">
            <field name="name">report.sales.by.user.pos.month.calendar</field>
            <field name="model">report.sales.by.user.pos.month</field>
            <field eval="2" name="priority"/>
            <field name="arch" type="xml">
                <calendar color="user_id" date_start="date_order" string="POS Report">
                    <field name="qty"/>
                    <field name="amount" />
                </calendar>
            </field>
         </record>

        <record model="ir.ui.view" id="view_report_sales_by_user_pos_month_graph">
            <field name="name">report.sales.by.user.pos.month.graph</field>
            <field name="model">report.sales.by.user.pos.month</field>
            <field eval="2" name="priority"/>
            <field name="arch" type="xml">
                <graph  type="bar" string="Sales by User">
                    <field name="user_id" />
                    <field name="amount"/>
                </graph>
            </field>
         </record>


         <record model="ir.actions.act_window" id="action_report_sales_by_user_pos_month">
            <field name="name">Sales by User Monthly</field>
            <field name="res_model">report.sales.by.user.pos.month</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,calendar,form,graph</field>
            <field name="domain">[('date_order','like',time.strftime('%Y-%m'))]</field>
        </record>



        <!-- Product Public Categories -->
        <record id="product_pos_category_form_view" model="ir.ui.view">
            <field name="name">pos.category.form</field>
            <field name="model">pos.category</field>
            <field name="arch" type="xml">
                <form string="Pos Categories">
                    <sheet>
                        <field name="image_medium" widget='image' class="oe_avatar oe_right"/>
                        <div class="oe_left">
                            <group>
                                <field name="name"/>
                                <field name="parent_id"/>
                                <field name="sequence"/>
                            </group>
                        </div>
                    </sheet>
                </form>
            </field>
        </record>
        <record id="product_pos_category_tree_view" model="ir.ui.view">
            <field name="name">pos.category.tree</field>
            <field name="model">pos.category</field>
            <field name="field_parent" eval="False"/>
            <field name="arch" type="xml">
                <tree string="Product Product Categories">
                    <field name="sequence" widget="handle"/>
                    <field name="complete_name"/>
                </tree>
            </field>
        </record>
        <record id="product_pos_category_action" model="ir.actions.act_window">
            <field name="name">Pos Product Categories</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">pos.category</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" eval="False"/>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to define a new category.
              </p><p>
                Categories are used to browse your products through the
                touchscreen interface.
              </p><p>
                If you put a photo on the category, the layout of the
                touchscreen interface will automatically. We suggest not to put
                a photo on categories for small (1024x768) screens.
              </p>
            </field>
        </record>
        <menuitem name="Configuration" parent="menu_point_root"
            id="menu_point_config_product" sequence="100" groups="group_pos_manager,base.group_configuration"/>
        <menuitem action="product_pos_category_action" id="menu_product_pos_category" parent="menu_point_config_product" sequence="20" />
        <!-- END -->

        <record id="product_template_form_view" model="ir.ui.view">
            <field name="name">product.template.form.inherit</field>
            <field name="model">product.template</field>
            <field name="inherit_id" ref="product.product_template_form_view"/>
            <field name="arch" type="xml">
                <group name="sale_condition" position="after">
                    <group name="pos" string="Point of Sale">
                        <field name="available_in_pos"/>
                        <field name="pos_categ_id" attrs="{'invisible': [('available_in_pos', '=', False)]}"/>
                        <field name="to_weight" attrs="{'invisible': [('available_in_pos', '=', False)]}"/>
                    </group>
                </group>
            </field>
        </record>
        <record id="product_template_tree_view" model="ir.ui.view">
            <field name="name">product.template.tree.inherit</field>
            <field name="model">product.template</field>
            <field name="inherit_id" ref="product.product_template_tree_view"/>
            <field name="arch" type="xml">
                <field name="name" position="before">
                    <field name="sequence" widget="handle" />
                </field>
            </field>
        </record>

        <!-- END -->

        <record id="action_account_journal_form" model="ir.actions.act_window">
            <field name="name">Payment Methods</field>
            <field name="res_model">account.journal</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="context" eval="{'default_journal_user': 1, 'default_type': 'cash'}"/>
            <field name="domain">[('journal_user','=', 1)]</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to add a payment method.
              </p><p>
                Payment methods are defined by accounting journals having the
                field <i>PoS Payment Method</i> checked. In order to be useable
                from the touchscreen interface, you must set the payment method
                on the <i>Point of Sale</i> configuration.
              </p>
            </field>
        </record>

        <menuitem action="action_account_journal_form"
            id="menu_action_account_journal_form_open"
            parent="menu_point_config_product"
            sequence="20"/>

        <record model="ir.ui.view" id="view_pos_order_tree_all_sales_lines">
            <field name="name">POS Sales Lines</field>
            <field name="model">pos.order.line</field>
            <field name="arch" type="xml">
                <tree string="POS Orders lines">
                    <field name="order_id" />
                    <field name="create_date" />
                    <field name="product_id" />
                    <field name="qty" />
                    <field name="price_unit" widget="monetary"/>
                </tree>
            </field>
        </record>
         <record model="ir.actions.act_window" id="action_pos_all_sales_lines">
            <field name="name">All sales lines</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">pos.order.line</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="view_pos_order_tree_all_sales_lines" />
        </record>

        <!--  Miscellaneous Operations/Reporting -->
        <menuitem name="Reports" parent="menu_point_root" id="menu_point_rep" sequence="99" groups="group_pos_manager"/>
        <!-- Invoice -->

        <record model="ir.actions.act_window" id="action_pos_invoice">
            <field name="name">Invoices</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">account.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('origin','like','POS')]</field>
        </record>

        <menuitem action="action_report_pos_details"
                id="menu_pos_details" parent="menu_point_rep" sequence="6" />

        <record model="ir.actions.act_url" id="action_pos_pos">
            <field name="name">Start Point of Sale</field>
            <field name="url">/pos/web/</field>
            <field name="target">self</field>
        </record>

        <!-- Top menu item -->
        <record model="ir.ui.view" id="view_pos_config_form">
            <field name="name">pos.config.form.view</field>
            <field name="model">pos.config</field>
            <field name="arch" type="xml">
                <form string="Point of Sale Configuration">
                    <header>
                        <button string="Set to Active" name="set_active" type="object" states="inactive,deprecated"/>
                        <button string="Set to Inactive" name="set_inactive" type="object" states="active" />
                        <button string="Set to Deprecated" name="set_deprecate" type="object" states="active,inactive" />
                        <field name="state" widget="statusbar" statusbar_visible="active,inactive,deprecated" statusbar_colors='{"deprecated" : "red"}' nolabel="1"/>
                    </header>

                    <sheet>
                        <label for="name" class="oe_edit_only"/>
                        <h1>
                            <field name="name"/>
                        </h1>
                        <group col="4">
                            <field name="picking_type_id" widget="selection" groups="stock.group_locations" 
                                on_change="onchange_picking_type_id(picking_type_id)"/>
                            <field name="stock_location_id" groups="stock.group_locations"/>
                            <field name="company_id" groups="base.group_multi_company"/>
                            <field name="pricelist_id" groups="product.group_sale_pricelist"/>
                            <field name="journal_id" widget="selection"/>
                            <field name="group_by" groups="account.group_account_user"/>
                            <field name="barcode_nomenclature_id" />
                            <field name="sequence_id" readonly="1" groups="base.group_no_one"/>
                            <field name="fiscal_position_ids" widget="many2many_tags" options="{'no_create': True}"/>
                            <field name="currency_id" invisible="1"/>
                        </group>
                        <separator string="Available Payment Methods" colspan="4"/>
                        <field name="journal_ids" colspan="4" nolabel="1" context="{'default_journal_user': 1}">
                            <tree string="Journals">
                                <field name="code" />
                                <field name="name" />
                                <field name="type" />
                            </tree>
                        </field>
                        <group name="features" string="Features" >
                            <group>
                                <field name="iface_vkeyboard" />
                                <field name="iface_invoicing" />
                                <field name="iface_precompute_cash" />
                                <field name="iface_start_categ_id" />
                                <field name="tip_product_id" />
                                <field name="iface_tax_included" />
                            </group>
                            <group>
                                <field name="iface_big_scrollbars" />
                                <field name="iface_print_auto" />
                                <field name="iface_display_categ_images" />
                                <field name="iface_print_skip_screen"  attrs="{'invisible' : [('iface_print_auto', '=', False)]}" />
                                <field name="cash_control" />
                            </group>
                        </group>
                        <group string="Hardware Proxy / PosBox" >
                            <field name="proxy_ip" />
                            <field name="iface_print_via_proxy" string="Receipt Printer" on_change="onchange_iface_print_via_proxy(iface_print_via_proxy)"/>
                            <field name="iface_scan_via_proxy" string="Barcode Scanner"/>
                            <field name="iface_electronic_scale" />
                            <field name="iface_cashdrawer" />
                        </group>
                        <group name="receipt" string="Receipt" >
                            <field name="receipt_header" string="Header" placeholder="A custom receipt header message"/>
                            <field name="receipt_footer" string="Footer" placeholder="A custom receipt footer message"/>
                        </group>
                    </sheet>

                </form>
            </field>
        </record>

        <record model="ir.ui.view" id="view_pos_config_tree">
            <field name="name">pos.config.tree.view</field>
            <field name="model">pos.config</field>
            <field name="arch" type="xml">
                <tree string="Point of Sale Configuration" decoration-muted="state == 'inactive'">
                    <field name="name" />
                    <field name="stock_location_id" groups="stock.group_locations"/>
                    <field name="state" />
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="view_pos_config_search">
            <field name="name">pos.config.search.view</field>
            <field name="model">pos.config</field>
            <field name="arch" type="xml">
                <search string="Point of Sale Config">
                    <field name="name" />
                    <filter string="Active" domain="[('state', '=', 'active')]" />
                    <filter string="Inactive" domain="[('state', '=', 'inactive')]" />
                    <field name="stock_location_id" groups="stock.group_locations" />
                </search>
            </field>
        </record>

        <!-- Sessions -->

        <act_window
            id="act_pos_config_sessions"
            name="Sessions"
            src_model="pos.config"
            res_model="pos.session"
            domain="[('config_id', '=', active_id)]" />

        <record model="ir.actions.act_window" id="action_pos_config_pos">
            <field name="name">Point of Sale</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">pos.config</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="view_pos_config_search" />
        </record>

        <menuitem
            parent="menu_point_config_product"
            action="action_pos_config_pos"
            id="menu_pos_config_pos"
            groups="group_pos_manager"/>

        <act_window
            id="act_pos_session_orders"
            name="Orders"
            src_model="pos.session"
            res_model="pos.order"
            context="{'search_default_session_id': active_id, 'default_session_id' : active_id }" />



        <record model="ir.ui.view" id="view_pos_session_form">
            <field name="name">pos.session.form.view</field>
            <field name="model">pos.session</field>
            <field name="arch" type="xml">
                <form string="Point of Sale Session">
                    <header>
                        <button name="open" type="workflow" string="Open Session"
                                attrs="{'invisible' : ['|', ('cash_control', '=', False), ('state', '!=', 'opening_control')]}"
                                class="oe_highlight"/>
                        <button name="open_frontend_cb" type="object" string="Continue Selling" states="opened"
                            class="oe_highlight"/>
                        <button name="cashbox_control" type="workflow" string="End of Session"
                            attrs="{'invisible' : ['|', ('cash_control', '=', False),('state', '!=', 'opened')]}" 
                            class="oe_highlight" />
                        <button name="close" type="workflow" string="Validate Closing &amp; Post Entries"
                            attrs="{'invisible' : ['|', ('cash_control', '=', True),('state', '!=', 'opened')]}"
                            class="oe_highlight" />
                        <button name="close" type="workflow" string="Validate Closing &amp; Post Entries" states="closing_control"
                            class="oe_highlight" />
                        
                        <field name="state" widget="statusbar" statusbar_visible="opening_control,opened,closing_control,closed" nolabel="1" />
                        
                    </header>
                    <sheet>
                        <field name="cash_register_id" invisible="1"/>
                        <div class="oe_button_box" name="button_box">
                            <button class="oe_stat_button" name="%(action_pos_box_in)d"
                                    type="action" icon="fa-level-down"
                                    attrs="{'invisible': ['|', ('cash_control', '=', False), ('state', 'not in', ['opened', 'closing_control'])]}">
                                <div class="o_form_field o_stat_info">
                                    <span class="o_stat_text">Put</span>
                                    <span class="o_stat_text">Money In</span>
                                </div>
                            </button>
                            <button class="oe_stat_button" name="%(action_pos_box_out)d"
                                    type="action" icon="fa-level-up"
                                    attrs="{'invisible': ['|', ('cash_control', '=', False), ('state', 'not in', ['opened', 'closing_control'])]}">
                                <div class="o_form_field o_stat_info">
                                    <span class="o_stat_text">Take</span>
                                    <span class="o_stat_text">Money Out</span>
                                </div>
                            </button>
                            <button name="%(account.action_view_account_bnk_stmt_cashbox)d"
                                    class="oe_stat_button"
                                    attrs="{'invisible':['|', ('cash_control', '=', False), ('state', '!=', 'opening_control')]}"
                                    icon="fa-money"
                                    type="action" context="{'balance': 'start', 'bank_statement_id': cash_register_id}">
                                <span class="o_stat_text">Set Opening Balance</span>
                            </button>
                            <button name="%(account.action_view_account_bnk_stmt_cashbox)d"
                                    class="oe_stat_button"
                                    attrs="{'invisible':['|', '|', ('cash_control', '=', False), ('state', '=', 'opening_control'), ('state', '=', 'closed')]}"
                                    icon="fa-money"
                                    type="action" context="{'balance': 'end', 'bank_statement_id': cash_register_id}">
                                <span class="o_stat_text">Set Closing Balance</span>
                            </button>
                        </div>
                        <h1 class="oe_title">
                            Session:
                            <field name="name" attrs="{'invisible': [('name','=','/')]}" class="oe_inline"/>
                        </h1>
                        <group>
                            <field name="cash_control" invisible="1" />
                            <group>
                                <field name="user_id" context="{'default_groups_ref': ['base.group_user', 'base.group_partner_manager', 'point_of_sale.group_pos_manager', 'base.group_sale_manager']}"/>
                                <field name="currency_id" invisible="1"/>
                                <field name="config_id"/>
                                <field name="rescue" attrs="{'invisible': [('rescue', '=', False)]}" />
                            </group>
                            <group>
                                <field name="start_at" attrs="{'invisible' : [('state', '=', 'opening_control')]}"/>
                                <field name="stop_at" attrs="{'invisible' : [('state', '!=', 'closed')]}"/>
                            </group>
                            <newline/>

                            <div attrs="{'invisible' : [('cash_control', '=', False)]}">
                                <group class="oe_subtotal_footer oe_right">
                                    <field name="cash_register_balance_start" readonly="1" string="Opening Balance" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <label for="cash_register_total_entry_encoding" attrs="{'invisible' : [('state', '=', 'opening_control')]}" string="+ Transactions" class="oe_force_bold oe_opening_total"/>
                                    <field name="cash_register_total_entry_encoding" nolabel="1" attrs="{'invisible' : [('state', '=', 'opening_control')]}" class="oe_bold oe_pos_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <label for="cash_register_balance_end" attrs="{'invisible' : [('state', '=', 'opening_control')]}" string="= Theoretical Closing Balance" class="oe_force_bold oe_opening_total"/>
                                    <field name="cash_register_balance_end" nolabel="1" attrs="{'invisible' : [('state', '=', 'opening_control')]}" class="oe_bold oe_pos_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                </group>
                            </div>
                            <div>
                                <group class="oe_subtotal_footer oe_right" attrs="{'invisible': ['|', ('cash_control', '=', False), ('state', '=', 'opening_control')]}">
                                    <field name="cash_register_balance_end_real" string="Real Closing Balance" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                </group>
                                <group/>
                                <group/>
                                <group class="oe_subtotal_footer oe_right" attrs="{'invisible': ['|', ('cash_control', '=', False), ('state', '=', 'opening_control')]}">
                                    <field name="cash_register_difference" class="oe_subtotal_footer_separator oe_right oe_pos_total oe_pos_difference" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                </group>
                            </div>
                        </group>
                        <separator string="Summary by Payment Methods" attrs="{'invisible' : [('state', '=', 'opening_control')]}"/>
                        <field name="statement_ids" attrs="{'invisible' : [('state', '=', 'opening_control')]}">
                            <tree string="Statements">
                                <field name="name" />
                                <field name="journal_id" />
                                <field name="balance_start" />
                                <field name="total_entry_encoding" />
                                <field name="balance_end_real" />
                                <field name="difference" />
                                <field name="currency_id" groups="base.group_multi_currency" />
                                <field name="state" />
                            </tree>
                        </field>

                    </sheet>
                </form>
            </field>
        </record>

        <record model="ir.ui.view" id="view_pos_session_tree">
            <field name="name">pos.session.tree.view</field>
            <field name="model">pos.session</field>
            <field name="arch" type="xml">
                <tree string="Point of Sale Session">
                    <field name="config_id" />
                    <field name="name" />
                    <field name="user_id" />
                    <field name="start_at" />
                    <field name="stop_at" />
                    <field name="state" />
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="view_pos_session_search">
            <field name="name">pos.session.search.view</field>
            <field name="model">pos.session</field>
            <field name="arch" type="xml">
                <search string="Point of Sale Session">
                    <field name="name" />
                    <filter string="Open" domain="[('state', '=', 'opened')]" />
                    <separator/>
                    <filter string="Today" domain="[('start_at', '>=', datetime.datetime.combine(context_today(), datetime.time(0,0,0)))]" />
                    <field name="config_id" />
                    <field name="user_id" />
                    <group expand="0" string="Group By">
                        <filter string="User" domain="[]" context="{'group_by' : 'user_id'}" />
                        <filter string="Point of Sale" domain="[]" context="{'group_by': 'user_id'}" />
                    </group>
                </search>
            </field>
        </record>


        <record model="ir.actions.act_window" id="action_pos_session">
            <field name="name">Sessions</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">pos.session</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="view_pos_session_search" />
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to start a new session.
              </p><p>
                A session is a period of time, usually one day, during which
                you sell through the point of sale. The user has to check the
                currencies in your cash registers at the beginning and the end
                of each session.
              </p><p>
                Note that you may use the menu <i>Your Session</i>
                to quickly open a new session.
              </p>
            </field>
        </record>

        <menuitem
            parent="menu_point_of_sale"
            action="action_pos_session"
            id="menu_pos_session_all"
            sequence="2"
            groups="group_pos_manager"/>

        <record id="view_pos_order_filter" model="ir.ui.view">
            <field name="name">pos.order.list.select</field>
            <field name="model">pos.order</field>
            <field name="arch" type="xml">
                <search string="Search Sales Order">
                    <field name="name"/>
                    <field name="date_order"/>
                    <filter string="New" domain="[('state','=','draft')]"/>
                    <filter string="Done" domain="[('state','in',('paid','invoiced','done'))]"/>
                    <filter string="Invoiced" domain="[('state','=','invoiced')]"/>
                    <filter string="Posted" domain="[('state','=','done')]"/>
                    <field name="user_id"/>
                    <field name="session_id"/>
                    <group expand="0" string="Group By">
                        <filter string="Customer" domain="[]" context="{'group_by':'partner_id'}"/>
                        <filter string="Salesman" domain="[]" context="{'group_by':'user_id'}"/>
                        <filter string="Session" domain="[]" context="{'group_by':'session_id'}"/>
                        <filter string="Status" domain="[]" context="{'group_by':'state'}"/>
                        <filter string="Order Month" domain="[]" context="{'group_by':'date_order'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record model="ir.actions.act_window" id="action_pos_config_kanban">
            <field name="name">Point of Sale</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">pos.config</field>
            <field name="view_type">form</field>
            <field name="view_mode">kanban,tree,form</field>
            <field name="search_view_id" ref="view_pos_config_search" />
            <field name="domain">[('state','=','active')]</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to create a new PoS config.
              </p><p>
                Configure at least one Point of Sale to be able to sell through the PoS interface.
              </p>
            </field>
        </record>

        <menuitem action="action_pos_config_kanban"
            parent="menu_point_root" name="Dashboard"
            id="menu_pos_dashboard" sequence="1"/>

        <!-- Barcode Nomenclatures -->
        <menuitem parent="menu_point_config_product" action="barcodes.action_barcode_nomenclature_form" id="menu_pos_barcode_nomenclature_all"
            sequence="30"/>
    </data>
</openerp>
