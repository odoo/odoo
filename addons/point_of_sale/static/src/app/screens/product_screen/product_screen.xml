<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">
    <t t-name="point_of_sale.ProductScreen">
        <div class="product-screen d-flex h-100">
            <div t-att-class="{'flex-grow-1 w-100 mw-100': this.ui.isSmall, 'flex-shrink-0': !this.ui.isSmall, 'd-none': this.ui.isSmall and this.pos.mobile_pane !== 'left'}"
                class="leftpane d-flex flex-column pb-2 border-end bg-view">
                <OrderSummary />
                <div class="pads px-2">
                    <div class="control-buttons d-flex justify-content-between gap-2 w-100 py-2">
                        <ControlButtons t-if="!this.ui.isSmall" onClickMore.bind="this.displayAllControlPopup"/>
                    </div>
                    <div class="subpads d-flex flex-column gap-2">
                        <Numpad t-if="!this.currentOrder?.isEmpty() and this.pos.getOrder()?.uiState.selected_orderline_uuid" class="'d-grid'" buttons="this.getNumpadButtons()" onClick.bind="this.onNumpadClick"/>
                        <ActionpadWidget 
                            partner="this.currentOrder?.getPartner()" 
                            onClickMore.bind="this.displayAllControlPopup"
                            actionName.translate="Payment"
                            actionToTrigger="() => this.pos.pay()"
                            showActionButton="!this.currentOrder?.isEmpty()"
                            fastValidate="(paymentMethod) => this.fastValidate(paymentMethod)"
                        />
                    </div>
                </div>
            </div>
            <div class="rightpane d-flex flex-grow-1 flex-column bg-secondary" t-if="!this.ui.isSmall || this.pos.mobile_pane === 'right'">
                <div class="position-relative d-flex flex-column flex-grow-1 overflow-hidden">
                    <CategorySelector t-if="!this.ui.isSmall || !this.pos.scanning" />
                    <BarcodeVideoScanner t-if="this.pos.scanning" t-props="this.barcodeVideoScannerProps" />
                    <div t-elif="this.pos.productToDisplayByCateg.length > 0" class="overflow-y-auto" t-on-scroll="this.onScroll">
                        <div t-foreach="this.pos.productToDisplayByCateg" t-as="productCateg" t-key="productCateg[0]" class="product-list d-grid gap-1 gap-lg-2 px-2 pt-0 pb-2">
                            <ProductCard
                                t-foreach="productCateg[1]" t-as="product" t-key="product.id"
                                productId="product.id"
                                product="product"
                                class="this.pos.productViewMode"
                                name="this.getProductName(product)"
                                color="product.color || product.pos_categ_ids?.at(-1)?.color"
                                imageUrl="this.pos.config.show_product_images and this.getProductImage(product)"
                                onClick.bind="() => this.addProductToOrder(product)"
                                t-on-mousedown="(event) => this.onMouseDown(event, product)"
                                t-on-mouseup="this.longPressHandlers.onMouseUp"
                                t-on-touchstart="(event) => this.onTouchStart(product)"
                                t-on-touchend="this.longPressHandlers.onTouchEnd"
                                productCartQty="this.state.quantityByProductTmplId[product.id]" />
                        </div>
                    </div>
                    <div t-else="" class="flex-grow-1 text-center mt-5">
                        <p t-if="this.searchWord">No products found for <b>"<t t-esc="this.searchWord"/>"</b> in this category.</p>
                         <div t-elif="!this.pos.selectedCategory" class="o_view_nocontent">
                            <div class="o_nocontent_help">
                                <p class="o_view_nocontent_smiling_face">No Product Yet?</p>
                                <p>Scan a barcode to create automatically, or load our sample data.</p>
                                <p >
                                    <button class="btn btn-lg btn-primary me-2" t-on-click="()=> this.doLoadSampleData.call()" t-att-disabled="this.doLoadSampleData.status === 'loading' ? 'disabled' : null">
                                        <t t-if="this.doLoadSampleData.status === 'loading'">Loading...</t>
                                        <t t-else="">Load Sample</t>
                                     </button>
                                    <button class="btn btn-lg btn-secondary" t-on-click="()=>this.pos.editProduct()">Create Manually</button>
                                </p>
                            </div>
                        </div>
                        <p t-else="">There are no products in this category.</p>
                    </div>
                    <div t-if="this.searchWord" class="search-more-button d-flex justify-content-center m-2">
                        <button class="btn btn-primary btn-lg lh-lg" t-on-click="() => this.pos.searchProductsFromDB()">Search more</button>
                    </div>
                </div>
                <t t-if="this.ui.isSmall">
                    <div class="switchpane d-flex gap-2 p-2 border-top bg-view">
                        <button t-if="!this.pos.scanning" class="btn-switchpane pay-button btn btn-lg flex-grow-1" t-attf-class="{{ this.currentOrder.isEmpty() ? 'btn-secondary' : 'btn-primary' }}" t-on-click="() => this.pos.pay()">
                            <span class="d-block">Pay</span>
                            <span t-esc="this.total" />
                        </button>
                        <button class="btn-switchpane btn btn-secondary review-button flex-grow-1" t-on-click="this.switchPane">
                            <span class="d-block">Cart</span>
                            <small><t t-esc="this.items"/> items</small>
                        </button>
                        <button t-if="this.pos.scanning" class="btn-switchpane btn btn-secondary btn-lg flex-grow-1" t-on-click="() => this.pos.scanning = false">
                            <span class="d-block">Products</span>
                        </button>
                    </div>
                </t>
            </div>
        </div>
    </t>

</templates>
