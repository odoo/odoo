<?xml version="1.0" encoding="utf-8"?>
<templates>
    <div t-name="spreadsheet_dashboard.DashboardAction" class="o_action o_spreadsheet_dashboard_action o_field_highlight">
        <ControlPanel display="controlPanelDisplay">
            <t t-set-slot="layout-actions">
                <t t-set="status" t-value="state.activeDashboard and state.activeDashboard.status"/>
                <FilterValue
                    t-if="status === Status.Loaded"
                    filter="filter"
                    model="state.activeDashboard.model"
                    t-as="filter"
                    t-foreach="filters"
                    t-key="filter.id"
                />
            </t>
            <t t-set-slot="control-panel-navigation-additional" t-if="state.activeDashboard">
                <SpreadsheetShareButton t-key="activeDashboardId" model="state.activeDashboard?.model" onSpreadsheetShared.bind="shareSpreadsheet"/>
            </t>
        </ControlPanel>
        <t t-set="dashboard" t-value="state.activeDashboard"/>
        <div class="o_content o_component_with_search_panel" t-att-class="{ o_mobile_dashboard: env.isSmall }">
            <!-- Dashboard selection -->
            <t t-if="env.isSmall">
                <DashboardMobileSearchPanel
                    onDashboardSelected="(dashboardId) => this.openDashboard(dashboardId)"
                    activeDashboard="dashboard"
                    groups="getDashboardGroups()"/>
            </t>
            <t t-else="">
                <t t-if="state.sidebarExpanded" t-call="spreadsheet_dashboard.DashboardAction.Expanded"/>
                <t t-else="" t-call="spreadsheet_dashboard.DashboardAction.Collapsed"/>
            </t>
            <!-- Main content -->
            <t t-if="!dashboard" t-call="spreadsheet_dashboard.DashboardLandingPage"/>
            <t t-else="">
                <t t-set="status" t-value="dashboard.status"/>
                <h3 t-if="status === Status.Loading" class="dashboard-loading-status">Loading...</h3>
                <div t-elif="status === Status.Error" class="dashboard-loading-status error">
                    An error occured while loading the dashboard
                </div>
                <t t-else="">
                    <MobileFigureContainer t-if="env.isSmall" spreadsheetModel="dashboard.model" t-key="dashboard.id"/>
                    <div t-else="" class="o_renderer">
                        <SpreadsheetComponent
                            model="dashboard.model"
                            t-key="dashboard.id"/>
                    </div>
                </t>
            </t>
        </div>
    </div>

    <t t-name="spreadsheet_dashboard.DashboardAction.Collapsed">
        <div class="bg-view h-100 o_search_panel_sidebar cursor-pointer" t-on-click="toggleSidebar">
            <div class="d-flex">
                <button class="btn btn-light btn-sm m-1 mb-2 p-2">
                    <i class="fa fa-angle-double-right"/>
                </button>
                <div class="mx-auto" t-if="state.activeDashboard">
                    <span class="fw-bolder" t-esc="activeDashboardGroupName"/>
                    /
                    <t t-esc="state.activeDashboard.displayName"/>
                </div>
            </div>
        </div>
    </t>

    <t t-name="spreadsheet_dashboard.DashboardAction.Expanded">
        <div class="o_spreadsheet_dashboard_search_panel o_search_panel flex-grow-0 border-end flex-shrink-0 pe-2 pb-5 ps-4 h-100 bg-view overflow-auto position-relative">
            <button t-if="!env.isSmall and state.activeDashboard" class="btn btn-light btn-sm end-0 m-1 mb-2 position-absolute px-2 py-1 top-0 z-index-1" t-on-click="toggleSidebar">
                <i class="fa fa-fw fa-angle-double-left"/>
            </button>
            <div class="mt-2"/>
            <section t-foreach="getDashboardGroups()" t-as="group" t-key="group.id" class="o_search_panel_section o_search_panel_category">
                <header class="o_search_panel_section_header pt-4 pb-2 text-uppercase o_cursor_default user-select-none">
                    <b t-esc="group.name"/>
                </header>
                <ul class="list-group d-block o_search_panel_field">
                    <li t-foreach="group.dashboards" t-as="dashboard" t-key="dashboard.id"
                        t-on-click="() => this.openDashboard(dashboard.id)"
                        t-esc="dashboard.displayName"
                        t-att-data-name="dashboard.displayName"
                        class="o_search_panel_category_value list-group-item cursor-pointer border-0"
                        t-att-class="{'active': dashboard.id === state.activeDashboard?.id}"/>
                </ul>
            </section>
        </div>
    </t>

    <div t-name="spreadsheet_dashboard.DashboardLandingPage" class="mx-auto h-100" style="max-width:1000px;">
        <h1 class="text-primary text-center pt-3">Welcome to Dashboards</h1>
        <h2 class="text-action">What is Dashboards?</h2>
        <p>
            Dashboards allows you to access all your important information.
            Your data is sorted into customizable categories and translated
            into visual representations for easy comprehension and informed decision-making.
        </p>
        <img src="/spreadsheet_dashboard/static/img/dashboards.png" alt="Dashboards" class="mb-5 mx-auto border shadow w-75"/>
        <h2 class="text-action pt-3">How do you create a dashboard?</h2>
        <p>
            To create or edit a dashboard, you need to have the proper rights (Dashboards: Admin).<br/>
            Then you can either go to:
            <ul>
                <li>Dashboards > Configuration > Select a category > click on Add a spreadsheet > select a Blank spreadsheet</li>
                <li>Documents > New spreadsheet > File > Add to dashboard > select a category</li>
            </ul>
        </p>
        <p>
            Once in your spreadsheet, the first sheet on the left will be the one displayed in Dashboards. You can then make your calculations on other sheets and place your visuals in the first sheet.
        </p>
        <h2 class="text-action pt-3">How do you insert data in your dashboard?</h2>
        <h3>Odoo List</h3>
        <p>
            To insert a list in a spreadsheet, you can go to any list and then click on insert in spreadsheet in the tool button.
        </p>
        <img src="/spreadsheet_dashboard/static/img/insert_list.png" alt="Odoo List" class="mb-5 mx-auto border shadow w-75"/>
        <h3>Odoo Pivot</h3>
        <p>
            A pivot table is usually composed of :
            <ul>
                <li>A first dimension on the vertical axis. A first field by which you group-by.</li>
                <li>A second dimension on the horizontal axis. A second field by which you group-by.</li>
                <li>A measure : any quantitative summable field that needs to be measured at the intersection of these two dimensions.</li>
            </ul>
        </p>
        <img src="/spreadsheet_dashboard/static/img/insert_pivot.png" alt="Odoo Pivot" class="mb-5 mx-auto border shadow w-75"/>
        <h3>Odoo Graph</h3>
        <p>
            To insert a chart in a spreadsheet, you can go to any chart and then click on insert in spreadsheet in the tool button.
        </p>
        <img src="/spreadsheet_dashboard/static/img/insert_chart.png" alt="Odoo Graph" class="mb-5 mx-auto border shadow w-75"/>
    </div>
</templates>
