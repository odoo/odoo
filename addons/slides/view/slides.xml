<?xml version="1.0" ?>
<openerp>
	<data>
		<!-- Layout add nav and footer -->
		<template id="slide_footer" inherit_id="website.footer_default"
			name="Footer Slides Link">
			<xpath expr="//div[@id='info']//ul[@class='list-unstyled']"
				position="inside">
				<li>
					<a href="/slides?filters=ppt">Presentations</a>
				</li>
				<li>
					<a href="/slides?filters=video">Videos</a>
				</li>
			</xpath>
		</template>
		<!-- Layout add nav and footer -->

		<template id="header" name="header">
			<div class="container">
				<div class="row page-header">
					<h1>
					<div class="col-lg-9 col-md-9 col-sm-12 col-xs-12">						
						<t t-esc="attachment_count" />
						<span>Slides</span>
						<small class="dropdown" t-if="filters in ('all', 'ppt','doc','video')">
							<a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown">
								<t t-if="filters == 'all'">All</t>
								<t t-if="filters == 'ppt'">Presentations</t>
								<t t-if="filters == 'doc'">Documents</t>
								<t t-if="filters == 'video'">Videos</t>
								<t t-if="search"><t t-esc="search" /></t>
								<t t-if="tags"><t t-esc="tags" /></t>
								<t t-if="sorting == 'creation'"> by Latest Published</t>
								<t t-if="sorting == 'date'"> by Last Activity date</t>
								<t t-if="sorting == 'view'"> by Most viewed</t>
								<b class="caret" />
							</a>
							<ul class="dropdown-menu">
								<li class="dropdown-header">Filter on</li>
								<li t-att-class="filters == 'all' and 'active' or '' ">
									<a
										t-att-href="url_for('/slides') + '?' + keep_query( 'search', 'sorting', 'tags', filters='all')">All</a>
								</li>
								<li t-att-class="filters == 'ppt' and 'active' or '' ">
									<a
										t-att-href="url_for('/slides') + '?' + keep_query( 'search', 'sorting', 'tags', filters='ppt')">Presentations</a>
								</li>
								<li t-att-class="filters == 'doc' and 'active' or '' ">
									<a
										t-att-href="url_for('/slides') + '?' + keep_query( 'search', 'sorting', 'tags', filters='doc')">Documents</a>
								</li>
								<li t-att-class="filters == 'video' and 'active' or '' ">
									<a
										t-att-href="url_for('/slides') + '?' + keep_query( 'search', 'sorting', 'tags', filters='video')">Videos</a>
								</li>
								<li class="dropdown-header">Search</li>
								<li t-if="search" t-att-class="search and 'active' or '' ">
									<a t-att-href="url_for('/slides') + '?' + keep_query('filters', 'tags', 'sorting', search='')">
										<span class="glyphicon glyphicon-remove"></span><t t-esc="search" />
									</a>
								</li>
								<li class="dropdown-header">Tags</li>
								<li t-if="tags" t-att-class="tags and 'active' or '' ">
									<a t-att-href="url_for('/slides') + '?' + keep_query('filters', 'sorting', 'search', tags='')">
										<span class="glyphicon glyphicon-remove"></span><t t-esc="tags" />
									</a>
								</li>
								<li class="dropdown-header">Sort by</li>
								<li t-att-class="sorting == 'creation' and 'active' or '' ">
									<a
										t-att-href="url_for('/slides') + '?' + keep_query( 'search', 'filters', 'tags', sorting='creation')">Latest Published</a>
								</li>
								<li t-att-class="sorting == 'date' and 'active' or '' ">
									<a
										t-att-href="url_for('/slides') + '?' + keep_query( 'search', 'filters', 'tags', sorting='date')">Last Activity date</a>
								</li>
								<li t-att-class="sorting == 'view' and 'active' or '' ">
									<a
										t-att-href="url_for('/slides') + '?' + keep_query( 'search', 'filters', 'tags', sorting='view')">Most viewed</a>
								</li>
							</ul>
						</small>
					</div>
					<div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 pull-right">						
						<form action="/slides" role="search" method="get">
							<div class="input-group">
								<input type="text" class="form-control" name="search"
									placeholder="Search Slides..." t-att-value="search" />
								<span class="input-group-btn">
									<button class="btn btn-primary" type="submit">
										<span class="glyphicon glyphicon-search"></span>
									</button>
								</span>
							</div>
						</form>						
					</div>
					</h1>
				</div>
			</div>
		</template>

		<template id='home' name="slide">
			<t t-set="head">
				<link href="/slides/static/src/css/slides.css" rel="stylesheet" />
				<script type="text/javascript" src="/slides/static/src/js/slides.js"></script>
			</t>
			<t t-call="website.layout">
				<t t-call="slides.header"></t>				
				<div class="container">
					<div class="row">
						<t t-if="slideview"><t t-call="slides.detailview"></t></t>
						<t t-if="not slideview"><t t-call="slides.gridview"></t></t>
					</div>
				</div>
				<t t-if="not slideview">
				<div class="container">
					<div class="row">
						<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 text-center">
							<t t-call="website.pager" />
						</div>
					</div>
				</div>
				</t>
			</t>
		</template>


		<template id='gridview' name="slide">
			<div class="col-lg-3 col-md-4 col-sm-6 col-xs-12" t-foreach="attachment_ids" t-as="attachment">
				<div class="thumbnail oe-slides-grid-thumbnail">
					<a t-attf-href="/slides/view/#{attachment.id}#{url_for('') + '?' + keep_query( 'search', 'filters', 'sorting', 'tags')}">
						<t t-if="not attachment.youtube_id">
							<img t-attf-src="/slides/thumb/#{attachment.id}" class="img-responsive shadow"/>
						</t>
						<t t-if="attachment.youtube_id">										
							<i class="fa fa-play-circle-o fa-3x play_button"></i>
							<img t-attf-src="/slides/thumb/#{attachment.id}" class="img-responsive shadow"/>
						</t>
					</a>
					<a t-attf-href="/slides/view/#{attachment.id}#{url_for('') + '?' + keep_query( 'search', 'filters', 'sorting', 'tags')}">
						<h4 class="oe-slides-text-truncation">
							<t t-esc="attachment.name"/>
						</h4>
					</a>					
					<p t-if="attachment.tag_ids" class="oe-slides-text-truncation">
						<i class="fa fa-tags"></i>
						<t t-foreach="attachment.tag_ids" t-as="att_tag">
							<a t-att-href="url_for('/slides') + '?' + keep_query( 'search', 'filters', 'sorting' ,tags=att_tag.name)">
								<span t-attf-class="badge #{tags and tags == att_tag.name and 'badge-active' ''}" t-field="att_tag.name"/>
							</a>
						</t>						
					</p>									
					<small class="text-muted">
						<t t-esc="attachment.create_date" />
					</small>
					<small class="text-muted pull-right">
						<t t-esc="attachment.slide_views" />
						Views
					</small>
				</div>
			</div>
		</template>


		<template id='detailview' name="slide">
			<div class="col-lg-9 col-md-9 col-sm-12 col-xs-12">
				<t t-if="slideview.datas">
					<iframe id="viewer"
						t-attf-src="/slides/static/src/pdfjs/web/viewer.html?file=#{slideview.url}"
						width='100%' height='588' allowfullscreen="true"
						webkitallowfullscreen="true" style="overflow:hidden;border:1px solid #ccc;" scrolling="no"></iframe>
				</t>
				<t t-if="slideview.youtube_id">
					<iframe id="viewer"
						t-attf-src="//www.youtube.com/embed/#{slideview.youtube_id}?theme=light"
						width='100%' height='588' allowfullscreen="true"
						webkitallowfullscreen="true" style="overflow:hidden;border:1px solid #ccc;"></iframe>
				</t>
				<h2 class="page-header">
					<span t-field="slideview.name"/>
					<div t-if="slideview.tag_ids" class="pull-right">
						<t t-foreach="slideview.tag_ids" t-as="att_tag">
							<a t-att-href="url_for('/slides') + '?' + keep_query( 'search', 'filters', 'sorting' ,tags=att_tag.name)">
								<span t-attf-class="badge #{tags and tags == att_tag.name and 'badge-active' ''}" t-field="att_tag.name"/>
							</a>
						</t>
					</div>
					<span class="text-muted">
						<span t-esc="slideview.slide_views"/> Views
					</span>
					<br/>
				</h2>
				<p class="text-muted">Presentation Transcript</p>				
				<p t-field="slideview.index_content"></p>
			</div>		
			<div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">	
				<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 thumbnail oe-slides-detail-thumbnail" t-foreach="attachment_ids" t-as="attachment">							
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6" style="padding:0px;">
						<a t-attf-href="/slides/view/#{attachment.id}#{url_for('') + '?' + keep_query( 'search', 'filters', 'sorting', 'tags')}">
							<t t-if="not attachment.youtube_id">
								<img t-attf-src="/slides/thumb/#{attachment.id}" class="img-responsive shadow"/>
							</t>
							<t t-if="attachment.youtube_id">										
								<i class="fa fa-play-circle-o fa-3x play_button"></i>
								<img t-attf-src="/slides/thumb/#{attachment.id}" class="img-responsive shadow"/>
							</t>
						</a>
					</div>
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
						<a t-attf-href="/slides/view/#{attachment.id}#{url_for('') + '?' + keep_query( 'search', 'filters', 'sorting', 'tags')}">
							<h5 class="oe-slides-text-truncation">
								<t t-esc="attachment.name"/>
							</h5>
						</a>
						<small class="text-muted">
							<t t-esc="attachment.create_date" />
						</small>
						<small class="text-muted">
							<t t-esc="attachment.slide_views" />
							Views
						</small>						
					</div>				
				</div>
			</div>	
		</template>
	</data>
</openerp>