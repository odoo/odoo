<?xml version="1.0" encoding="utf-8"?>
<templates>
    <t t-name="partner_autocomplete.PartnerAutoComplete" t-inherit="web.AutoComplete" t-inherit-mode="primary">
        <xpath expr="//ul" position="inside">
            <t t-if="this.sources &amp;&amp; this.sources.at(-1)?.options.length !== 0 &amp;&amp; !this.shouldSearchWorldwide">  <!-- 1 because IAP sources (potential partners) are loaded after DB sources (existing partners)-->
                <li
                    class="o-autocomplete--dropdown-item ui-menu-item d-block"
                    t-on-pointerdown="() => this.ignoreBlur = true"
                    t-on-mouseleave="() => this.onOptionMouseLeave()"
                    t-on-click="(ev) => this.searchWorldwide(ev)"
                >
                    <a
                        t-attf-id="{{this.props.id or 'autocomplete'}}_{{this.source_index}}_{{this.option_index}}"
                        role="option"
                        href="#"
                        class="dropdown-item ui-menu-item-wrapper text-truncate text-info"
                        t-att-class="{ 'ui-state-active': this.isActiveSourceOption([this.source_index, this.option_index]) }"
                        t-att-aria-selected="this.isActiveSourceOption([this.source_index, this.option_index]) ? 'true' : 'false'"
                    >
                        Search Worldwide ðŸŒŽ
                    </a>
                </li>
            </t>
        </xpath>
    </t>

    <t t-name="partner_autocomplete.PartnerAutoCompleteCharField" t-inherit="web.CharField" t-inherit-mode="primary">
        <xpath expr="//t[@t-else='']" position="before">
            <t t-elif="this.props.record.resModel !== 'res.partner' || !this.props.record.data.parent_id">
                <PartnerAutoComplete
                    value="this.props.record.data[this.props.name] || ''"
                    sources="this.sources"
                    input="this.inputRef"
                    placeholder="this.props.placeholder || ''"
                >
                    <t t-set-slot="partnerOption" t-slot-scope="partnerOptionScope">
                        <t t-call="partner_autocomplete.DropdownOption">
                            <t t-set="option" t-value="this.partnerOptionScope"/>
                        </t>
                    </t>
                </PartnerAutoComplete>
            </t>
        </xpath>
    </t>

    <t t-name="partner_autocomplete.PartnerAutoCompleteMany2XField" t-inherit="web.Many2XAutocomplete" t-inherit-mode="primary">
        <xpath expr="//AutoComplete" position="replace">
            <PartnerAutoComplete t-else=""
                value="this.props.value || ''"
                autoSelect="true"
                sources="this.sources"
                onChange.bind="this.onChange"
                input="this.inputRef"
                placeholder="this.placeholder || ''"
                slots="this.props.slots"
                id="this.props.id"
            />
        </xpath>
    </t>

    <t t-name="partner_autocomplete.DropdownOption">
        <div style="display: flex; justify-content: space-between; align-items: center; height: 24px;">
            <div>
                <span t-esc="this.option.label"/>,
                <span class="text-muted" t-esc="this.option.data.description"/>
            </div>
        </div>
    </t>

    <t t-name="partner_autocomplete.InsufficientCreditNotification">
        <div class="o-hidden-ios">
            <a class="btn btn-link" t-att-href="this.credits_url"><i class="oi oi-arrow-right"/> Buy more credits</a>
        </div>
    </t>

    <t t-name="partner_autocomplete.AccountTokenMissingNotification">
        <div class="">
            <a class="btn btn-link" t-att-href="this.account_url" ><i class="oi oi-arrow-right"/> Set Your Account Token</a>
        </div>
    </t>

    <t t-name="partner_autocomplete.PartnerAutoCompleteMany2one">
        <Many2One t-props="this.m2oProps">
            <t t-set-slot="partnerOption" t-slot-scope="partnerOptionScope">
                <t t-call="partner_autocomplete.DropdownOption">
                    <t t-set="option" t-value="this.partnerOptionScope"/>
                </t>
            </t>
        </Many2One>
    </t>

</templates>
