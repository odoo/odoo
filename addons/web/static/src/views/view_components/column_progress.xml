<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="web.ColumnProgress">
        <div class="o_column_progress progress bg-300 w-75" t-att-class="this.offlineService.offline ? 'opacity-50 pe-none': ''">
            <t t-set="maxWidth" t-value="100 - Math.max(0, this.props.progressBar.bars.filter(x => x.count > 0).length - 1) * 5"/>
            <t t-foreach="this.props.progressBar.bars" t-as="bar" t-key="bar.value">
                <t t-set="progressWidth" t-value="Math.max(5, bar.count / (this.props.group.count or 1) * 100)"/>
                <div t-if="bar.count > 0"
                    role="progressbar"
                    class="progress-bar o_bar_has_records cursor-pointer"
                    t-att-class="{ 'progress-bar-animated progress-bar-striped': this.props.progressBar.activeBar === bar.value, 'border border-white': !this.props.group.isFolded and this.props.progressBar.activeBar }"
                    t-attf-class="bg-{{ bar.color }}"
                    t-attf-style="width: {{ Math.min(progressWidth, maxWidth) }}%;"
                    aria-valuemin="0"
                    t-att-aria-valuemax="this.props.group.count"
                    t-att-aria-valuenow="bar.count"
                    aria-label="Progress bar"
                    t-attf-data-tooltip="{{ bar.count }} {{ bar.string }}"
                    data-tooltip-delay="0"
                    t-on-click="() => this.onBarClick(bar)"
                />
            </t>
        </div>
        <t t-if="this.props.progressBar.isReady">
            <AnimatedNumber
                value="this.props.aggregate.value"
                title="this.props.aggregate.title"
                duration="1000"
                currencies="this.props.aggregate.currencies"
                animationClass="this.props.aggregate.value > 999 ? 'o_animated_grow' : 'o_animated_grow_huge'"
            />
        </t>
    </t>

</templates>
