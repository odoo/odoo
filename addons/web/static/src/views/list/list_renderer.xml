<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="web.ListRenderer" owl="1">
        <div class="o_list_view">
            <div class="table-responsive">
                <table t-attf-class="o_list_table table table-sm table-hover table-striped {{props.list.isGrouped ? 'o_list_table_grouped' : 'o_list_table_ungrouped'}}">
                    <thead>
                        <tr>
                            <th t-if="props.hasSelectors" class="o_list_record_selector">
                                <CheckBox value="selection.length === props.list.data.length" t-on-change="toggleSelection"/>
                            </th>
                            <t t-foreach="state.columns" t-as="column" t-key="column.name">
                                <th t-if="column.sortable" t-att-class="getColumnClass(column)" t-on-click="onClickSortColumn(column)">
                                  <t t-esc="column.string"/>
                                </th>
                                <th t-else="" t-att-class="getColumnClass(column)" >
                                  <t t-esc="column.string"/>
                                </th>
                            </t>
                        </tr>
                    </thead>
                    <tbody class="ui-sortable">
                        <t t-call="web.ListRenderer.Rows">
                            <t t-set="list" t-value="props.list"/>
                        </t>
                    </tbody>
                    <tfoot>
                        <tr>
                            <td t-if="props.hasSelectors"/>
                            <t t-set="aggregates" t-value="props.list.getAggregates(selection)"/>
                            <t t-foreach="state.columns" t-as="column" t-key="column.name">
                                <t t-set="aggregate" t-value="aggregates[column.name]"/>
                                <td t-if="aggregate" class="o_list_number" t-att-data-tooltip="aggregate.help">
                                    <t t-esc="aggregate.value"/>
                                </td>
                                <td t-else=""/>
                            </t>
                        </tr>
                    </tfoot>
                    <Dropdown class="o_optional_columns_dropdown"
                              position="'bottom-end'"
                              t-on-dropdown-item-selected="toggleOptionalField" >
                        <t t-set-slot="toggler">
                            <i class="fa fa-ellipsis-v"/>
                        </t>
                        <t t-foreach="getOptionalFields" t-as="field" t-key="field_index">
                            <CheckBoxDropdownItem
                            parentClosingMode="'none'"
                            payload="field"
                            value="field.value">
                                <t t-esc="field.string"/> <t t-if="env.debug" t-esc="' (' + field.name + ')'" />
                            </CheckBoxDropdownItem>
                        </t>
                    </Dropdown>
                </table>
            </div>
        </div>
    </t>

    <t t-name="web.ListRenderer.Rows" owl="1">
        <t t-if="!list.isGrouped">
            <t t-foreach="list.data" t-as="record" t-key="record.id">
                <t t-call="web.ListRenderer.RecordRow"/>
            </t>
        </t>
        <t t-else="">
            <t t-foreach="list.data" t-as="group" t-key="group.id">
                <t t-call="web.ListRenderer.GroupRow"/>
                <t t-if="group.isLoaded">
                    <t t-call="web.ListRenderer.Rows">
                        <t t-set="list" t-value="group"/>
                    </t>
                </t>
            </t>
        </t>
    </t>

    <t t-name="web.ListRenderer.GroupRow" owl="1">
        <tr t-attf-class="{{group.count > 0 ? 'o_group_has_content' : ''}} o_group_header {{group.isLoaded ? 'o_group_open' : ''}}" t-on-click="toggleGroup(group)">
            <th class="o_group_name" t-att-colspan="getGroupNameCellColSpan(group)">
                <span t-attf-class="fa {{group.isLoaded ? 'fa-caret-down' : 'fa-caret-right'}}"
                    t-attf-style="padding-left: {{2 + getGroupLevel(group) * 20}}px; padding-right: 5px"/>
                <t t-esc="group.displayName"/> (<t t-esc="group.count"/>)
            </th>
            <td t-foreach="getAggregateColumns(group)" t-as="column" t-key="column.name" class="o_list_number">
                <t t-esc="group.aggregates[column.name]"/>
            </td>
            <t t-set="groupPagerColspan" t-value="getGroupPagerCellColspan(group)"/>
            <th t-if="groupPagerColspan > 0" t-att-colspan="groupPagerColspan"/>
        </tr>
    </t>

    <t t-name="web.ListRenderer.RecordRow" owl="1">
        <tr class="o_data_row">
            <td t-if="props.hasSelectors" class="o_list_record_selector">
                <CheckBox value="selection.includes(record)" t-on-change="toggleRecordSelection(record)"/>
            </td>
            <t t-foreach="state.columns" t-as="column" t-key="column.name">
                <td class="o_data_cell" t-att-class="getCellClass(column)" t-on-click="openRecord(record)">
                    <Field name="column.name" record="record" readonly="true" type="column.widget" />
                </td>
            </t>
        </tr>
    </t>
</templates>
