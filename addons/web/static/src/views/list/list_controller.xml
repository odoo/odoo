<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="web.ListView">
        <div t-att-class="this.className" t-ref="root">
            <Layout className="this.model.useSampleModel ? 'o_view_sample_data' : ''" display="this.display">
                <t t-set-slot="control-panel-buttons">
                    <t t-call="{{ this.props.buttonTemplate }}"/>
                    <t t-foreach="this.archInfo.headerButtons" t-as="button" t-key="this.button.id" t-if="!this.evalViewModifier(this.button.invisible)">
                        <MultiRecordViewButton
                            t-if="this.button.display === 'always'"
                            list="this.model.root"
                            className="button.className"
                            clickParams="button.clickParams"
                            defaultRank="'btn-secondary'"
                            domain="this.props.domain"
                            icon="button.icon"
                            string="button.string"
                            title="button.title"
                            attrs="button.attrs"
                        />
                    </t>
                </t>

                <t t-set-slot="control-panel-actions">
                    <SearchBar t-if="!this.offlineService.offline" toggler="this.searchBarToggler" autofocus="this.firstLoad"/>
                    <OfflineSearchBar t-else="" toggler="this.searchBarToggler" autofocus="this.firstLoad"/>
                </t>
                <t t-set-slot="control-panel-navigation-additional">
                    <t t-if="!this.hasSelectedRecords">
                        <t t-if="this.offlineService.offline" t-component="this.searchBarToggler.offlineComponent" t-props="this.searchBarToggler.props"/>
                        <t t-else="" t-component="this.searchBarToggler.component" t-props="this.searchBarToggler.props"/>
                    </t>
                </t>

                <t t-set-slot="control-panel-additional-actions">
                    <CogMenu t-if="!this.hasSelectedRecords"/>
                    <CogMenu t-elif="this.env.isSmall and (this.props.info.actionMenus or this.archInfo.headerButtons.length)" t-props="this.actionMenuProps" hasSelectedRecords="this.hasSelectedRecords">
                        <t t-foreach="this.archInfo.headerButtons" t-as="button" t-key="this.button.id" t-if="!this.evalViewModifier(this.button.invisible)">
                            <DropdownItem class="'o-dropdown-item-unstyled-button'">
                                <MultiRecordViewButton
                                    t-if="this.button.display !== 'always'"
                                    list="this.model.root"
                                    className="button.className"
                                    clickParams="button.clickParams"
                                    defaultRank="'btn-secondary'"
                                    domain="this.props.domain"
                                    icon="button.icon"
                                    string="button.string"
                                    title="button.title"
                                    attrs="button.attrs"
                                />
                            </DropdownItem>
                        </t>
                    </CogMenu>
                </t>
                <t t-set-slot="control-panel-selection-actions">
                    <div t-if="this.hasSelectedRecords" class="o_selection_container m-1 m-md-0 d-flex gap-1">
                        <SelectionBox root="this.model.root"/>
                        <t t-if="!this.env.isSmall">
                            <t t-foreach="this.archInfo.headerButtons" t-as="button" t-key="this.button.id" t-if="!this.evalViewModifier(this.button.invisible)">
                                <MultiRecordViewButton
                                    t-if="this.button.display !== 'always'"
                                    list="this.model.root"
                                    className="button.className"
                                    clickParams="button.clickParams"
                                    defaultRank="'btn-secondary'"
                                    domain="this.props.domain"
                                    icon="button.icon"
                                    string="button.string"
                                    title="button.title"
                                    attrs="button.attrs"
                                />
                            </t>
                            <t t-if="this.props.info.actionMenus">
                                <ActionMenus t-props="this.actionMenuProps"/>
                            </t>
                        </t>
                    </div>
                </t>
                <t t-component="this.props.Renderer" t-if="this.model.isReady"
                    list="this.model.root"
                    activeActions="this.activeActions"
                    archInfo="this.archInfo"
                    allowSelectors="this.props.allowSelectors"
                    editable="this.editable"
                    onOpenFormView="this.onOpenFormView"
                    hasOpenFormViewButton="this.hasOpenFormViewButton"
                    openRecord.bind="this.openRecord"
                    noContentHelp="this.props.info.noContentHelp"
                    onAdd.bind="this.createRecord"
                    optionalActiveFields="this.optionalActiveFields"
                    readonly="this.props.readonly"
                />
                <t t-elif="this.model.couldNotLoadRootOffline">
                    <OfflineActionHelper/>
                </t>
            </Layout>
        </div>
    </t>

    <t t-name="web.ListView.Buttons">
        <button t-if="!this.env.inDialog and !this.editedRecord and this.activeActions.create" type="button" class="btn btn-primary o_list_button_add" data-hotkey="c" t-on-click="this.onClickCreate" data-bounce-button="">
            New
        </button>
        <button t-if="this.editedRecord" type="button" class="btn btn-primary o_list_button_save" data-hotkey="s" t-on-click.stop="this.onClickSave">
            Save
        </button>
        <button t-if="this.editedRecord" type="button" class="btn btn-secondary o_list_button_discard" data-hotkey="j" t-on-click.stop="this.onClickDiscard" t-on-mousedown="this.onMouseDownDiscard">
            Discard
        </button>
    </t>

</templates>
