<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="web.CalendarFilterSection">
        <div t-if="this.section.filters.length gt 0 or this.section.canAddFilter"
             class="o_calendar_filter d-flex flex-column gap-1 my-2"
             t-att-data-name="this.section.fieldName"
        >
            <t t-if="this.section.label">
                <div
                    class="o_calendar_filter_items_checkall o-checkbox form-check w-100"
                    data-value="section"
                >
                    <input
                        type="checkbox"
                        name="select-all"
                        class="form-check-input"
                        t-attf-id="o_calendar_filter_{{this.nextFilterId}}"
                        t-att-checked="this.isAllActive"
                        t-att-disabled="this.section.filters.length === 0"
                        t-on-change="(ev) => this.onAllFilterInputChange(ev)"
                    />
                    <label
                        class="d-flex align-items-center"
                        type="button"
                        t-on-click.stop.prevent="() => this.toggleSection(this.ev)"
                    >
                        <span class="o_cw_filter_label fw-bolder text-truncate flex-grow-1" t-esc="this.section.label"/>
                        <i
                            class="o_cw_filter_collapse_icon fa ms-1"
                            t-attf-class="fa-caret-{{ this.state.collapsed ? 'left' : 'down' }}"
                        />
                    </label>
                </div>
            </t>
            <t t-if="!this.state.collapsed">
                <div class="o_calendar_filter_items d-flex flex-column gap-1">
                    <t t-foreach="this.getSortedFilters()" t-as="filter" t-key="this.filter.value">
                        <t t-set="filterId" t-value="this.nextFilterId"/>
                        <t t-call="{{ this.constructor.subTemplates.filter }}"/>
                    </t>
                </div>
                <AutoComplete t-if="this.section.canAddFilter" t-props="this.autoCompleteProps">
                    <t t-set-slot="option" t-slot-scope="optionScope">
                        <t t-if="this.optionScope.data.id and this.section.avatar.field">
                            <img class="rounded me-1 o_avatar" t-attf-src="/web/image/{{ this.section.avatar.model }}/{{ optionScope.data.id }}/{{ this.section.avatar.field }}"/>
                        </t>
                        <t t-esc="this.optionScope.label" />
                    </t>
                </AutoComplete>
            </t>
        </div>
    </t>

    <t t-name="web.CalendarFilterSection.filter">
        <div
            class="o_calendar_filter_item o-checkbox form-check position-relative w-100 cursor-pointer"
            t-att-class="this.getFilterColor(this.filter)"
            t-att-data-value="this.filter.value"
        >
            <input
                type="checkbox"
                name="selection"
                class="o_cw_filter_input_bg form-check-input"
                t-att-style="this.filter.colorIndex and typeof this.filter.colorIndex !== 'number' ? `border-color: ${filter.colorIndex}; background-color: ${filter.colorIndex};` : ''"
                t-attf-id="o_calendar_filter_item_{{this.filterId}}"
                t-att-checked="this.filter.active"
                t-on-change="(ev) => this.onFilterInputChange(this.filter, ev)"
            />
            <label
                class="d-flex align-items-center gap-1"
                t-attf-for="o_calendar_filter_item_{{this.filterId}}"
            >
                <t t-if="this.section.hasAvatar and this.filter.hasAvatar">
                    <img
                        class="o_cw_filter_avatar o_avatar rounded"
                        t-attf-src="/web/image/{{ this.section.avatar.model }}/{{ this.filter.value }}/{{ this.section.avatar.field }}"
                        alt="Avatar"
                    />
                </t>
                <span
                    class="o_cw_filter_title flex-grow-1 text-truncate lh-base"
                    t-esc="this.filter.label"
                />
                <span t-if="this.filter.aggregatedValue" t-esc="this.filter.aggregatedValue"/>
            </label>
            <t t-if="this.filter.canRemove">
                <button
                    class="o_remove btn position-absolute top-0 end-0 py-0 p-1 bg-view text-body transition-base"
                    role="img"
                    title="Remove this favorite from the list"
                    aria-label="Remove this favorite from the list"
                    t-on-click="(ev) => this.onFilterRemoveBtnClick(this.filter, ev)"
                >
                    <i class="oi oi-close"/>
                </button>
            </t>
        </div>
    </t>

</templates>
