<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

<t t-name="web.SwitchCompanyMenu">
    <DropdownGroup group="'web-navbar-group'">
        <Dropdown
            position="'bottom-end'"
            menuRef="this.containerRef"
            state="this.dropdown"
            onStateChanged.bind="this.handleDropdownChange"
            navigationOptions="this.navigationOptions"
            menuClass="'o_switch_company_menu_dropdown'"
            disabled="this.isSingleCompany"
        >
            <button data-hotkey="shift+u" t-att-disabled="this.isSingleCompany" t-att-title="this.user.activeCompany.name" class="o_switch_company_menu d-none d-md-flex">
                <i class="fa fa-building d-lg-none"/>
                <span class="oe_topbar_name d-none d-lg-block text-truncate" t-esc="this.user.activeCompany.name"/>
            </button>

            <t t-set-slot="content">
                <t t-call="web.SwitchCompanyMenu.Items"/>
            </t>
        </Dropdown>
    </DropdownGroup>
</t>

<t t-name="web.SwitchCompanyMenu.Items">
    <div class="d-flex flex-row pe-2 mb-2" t-att-class="{ 'visually-hidden': !this.state.showFilter }">
        <div
            role="menuitemcheckbox"
            t-att-aria-checked="this.hasSelectedCompanies ? 'true' : 'false'"
            t-att-aria-label="this.hasSelectedCompanies ? 'Deselect all' : 'Select all'"
            t-att-title="this.hasSelectedCompanies ? 'Deselect all' : 'Select all'"
            t-on-click="() => this.selectAll()"
        >
            <span class="btn border-0 pt-2 px-2" t-att-class="this.selectAllClass">
                <i class="fa fa-fw" t-att-class="this.selectAllIcon"/>
            </span>
        </div>
        <div
            class="form-control d-flex align-items-center py-1"
            role="search"
        >
            <i class="oi oi-search me-2" role="img" aria-label="Search..." title="Search..."/>
            <div class="d-flex flex-grow-1 flex-wrap gap-1">
                <input
                    t-on-input="this.onSearch"
                    t-att-value="this.state.searchFilter"
                    t-ref="inputRef"
                    type="text"
                    class="o_input flex-grow-1 border-0 o-navigable"
                    placeholder="Search..."
                    role="searchbox"
                />
            </div>
        </div>
    </div>

    <div class="o_switch_company_menu_items">
        <t t-foreach="this.visibleCompanies" t-as="entry" t-key="this.entry.company.id">
            <SwitchCompanyItem company="entry.company" level="entry.level"/>
        </t>
    </div>

    <div t-if="this.companySelector.hasSelectionChanged" class="o_switch_company_menu_buttons d-flex justify-content-end gap-2 px-2 pt-2">
        <button
            class="btn btn-primary o-navigable flex-grow-1 text-center"
            t-on-click="() => this.confirm()"
        >
            Confirm
        </button>
        <button
            class="btn btn-secondary o-navigable flex-grow-1 text-center"
            t-on-click="() => this.companySelector.reset()"
        >
            Reset
        </button>
    </div>
</t>

</templates>
