<templates>

<t t-name="web_tour.TourInteraction" owl="1">
  <div t-ref="tourController" t-if="activeTours.length"
      class="o-tour-controller bg-black border border-2 text-white position-absolute p-3 d-flex gap-3 flex-column" t-att-style="contentStyle">

      <div class="d-flex o-tour-controller--bar" style="cursor: move;">
        <div class="ms-auto" role="button" t-on-click="toggleCollapse">
          <i class="fa" t-att-class="localState.isExpanded ? 'fa-minus' : 'fa-plus'" />
        </div>
      </div>

      <div class="d-flex gap-3 h-100 overflow-hidden" t-if="localState.isExpanded">
        <div class="o-tour-controller--active-tours d-flex flex-column">
          <div t-foreach="activeTours" t-as="tour" t-key="tour" t-esc="tour" t-on-click="() => this.showTour(tour)" t-att-class="localState.shownTour === tour ? 'bg-primary' : ''" class="p-2" />
        </div>

        <div t-if="currentTour" class="border" />

        <t t-call="web_tour.TourInteraction.Steps" />
      </div>
  </div>
</t>

<t t-name="web_tour.TourInteraction.Steps">
    <div class="o-tour-controller--current-tour-steps d-flex flex-column gap-1" t-if="currentTour" style="max-width: 300px;" t-ref="stepsContainer">
      <button class="btn btn-primary" t-on-click="() => currentTour.nextStep()">Next</button>

      <div class="d-flex flex-column gap-2 overflow-auto">
        <t t-set="tourName" t-value="this.localState.shownTour" />
        <div class="p-1 d-flex flex-row gap-1"
            t-foreach="currentTour.steps" t-as="step" t-key="step_index"
            t-att-class="getStepClass(step_value)">

            <div class="d-flex flex-column justify-content-around border-end align-items-center">
              <button t-on-click="() => this.toggleSuspend(step)" class="btn bg-transparent text-100 fs-5">
                <i class="fa" t-att-class="step_value.shouldStop ? 'fa-circle' : 'fa-circle-o'" />
              </button>

              <button t-on-click="() => this.playUntil(step)" class="btn bg-transparent text-100 fs-5">
                <i class="fa fa-fast-forward fa-rotate-90" />
              </button>
            </div>

            <div>
              <div>Absolute position: <t t-esc="step_value.step.absolutePosition" /></div>
              <div
                  t-on-mouseover="() => this.onStepTriggerMouseOver(step_value)"
                  t-on-mouseout="() => this.onStepTriggerMouseOver(step_value, 'remove')" >
                <div class="text-wrap text-break">trigger: "<t t-esc="step_value.step.trigger" />"</div>
                <div t-if="step_value.step.extra_trigger" class="text-wrap text-break">extra_trigger: "<t t-esc="step_value.extra_trigger" />"</div>
              </div>
            </div>
        </div>
      </div>

    </div>
</t>

</templates>