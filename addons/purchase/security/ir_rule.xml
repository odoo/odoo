<?xml version="1.0" encoding="utf-8"?>
<odoo noupdate="1">

    <!-- Multi-Company Rules -->
    <record id="purchase_order_comp_rule" model="ir.rule">
        <field name="name">Purchase Order multi-company</field>
        <field name="model_id" ref="model_purchase_order" />
        <field name="domain_force">[('company_id', 'in', company_ids)]</field>
    </record>

    <record id="purchase_order_line_comp_rule" model="ir.rule">
        <field name="name">Purchase Order Line multi-company</field>
        <field name="model_id" ref="model_purchase_order_line" />
        <field name="domain_force">[('company_id', 'in', company_ids)]</field>
    </record>

    <record id="purchase_order_report_comp_rule" model="ir.rule">
        <field name="name">Purchase Order Report multi-company</field>
        <field name="model_id" ref="model_purchase_report" />
        <field name="domain_force">[('company_id', 'in', company_ids)]</field>
    </record>

    <!-- Portal Access Rules -->
    <record id="portal_purchase_order_user_rule" model="ir.rule">
        <field name="name">Portal Purchase Orders</field>
        <field name="model_id" ref="model_purchase_order" />
        <field name="domain_force">[('partner_id', 'child_of', [user.commercial_partner_id.id])]</field>
        <field name="groups" eval="[(4, ref('base.group_portal'))]" />
        <field name="perm_unlink" eval="True" />
        <field name="perm_write" eval="True" />
        <field name="perm_read" eval="True" />
        <field name="perm_create" eval="False" />
    </record>

    <record id="portal_purchase_order_line_rule" model="ir.rule">
        <field name="name">Portal Purchase Order Lines</field>
        <field name="model_id" ref="model_purchase_order_line" />
        <field name="domain_force">[('order_id.partner_id','child_of',[user.commercial_partner_id.id])]</field>
        <field name="groups" eval="[(4, ref('base.group_portal'))]" />
    </record>

    <!-- Multi-Buyer Purchase Order Assignment Rules -->
    <record id="purchase_order_personal_rule" model="ir.rule">
        <field name="name">Personal Purchase Orders</field>
        <field name="model_id" ref="model_purchase_order" />
        <field name="domain_force">['|', ('user_id', '=', user.id), ('user_id', '=', False)]</field>
        <field name="groups" eval="[(4, ref('purchase.group_purchase_user'))]" />
    </record>

    <record id="purchase_order_see_all_rule" model="ir.rule">
        <field name="name">All Purchase Orders</field>
        <field name="model_id" ref="model_purchase_order" />
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('purchase.group_purchase_user_all'))]" />
    </record>

    <record id="purchase_order_line_personal_rule" model="ir.rule">
        <field name="name">Personal Purchase Order Lines</field>
        <field name="model_id" ref="model_purchase_order_line" />
        <field name="domain_force">['|', ('user_id', '=', user.id), ('user_id', '=', False)]</field>
        <field name="groups" eval="[(4, ref('purchase.group_purchase_user'))]" />
    </record>

    <record id="purchase_order_line_see_all_rule" model="ir.rule">
        <field name="name">All Purchase Order Lines</field>
        <field name="model_id" ref="model_purchase_order_line" />
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('purchase.group_purchase_user_all'))]" />
    </record>

    <record id="purchase_report_personal_rule" model="ir.rule">
        <field name="name">Personal Orders Analysis</field>
        <field name="model_id" ref="model_purchase_report" />
        <field name="domain_force">['|', ('user_id', '=', user.id), ('user_id', '=', False)]</field>
        <field name="groups" eval="[(4, ref('purchase.group_purchase_user'))]" />
    </record>

    <record id="purchase_report_see_all_rule" model="ir.rule">
        <field name="name">All Orders Analysis</field>
        <field name="model_id" ref="model_purchase_report" />
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('purchase.group_purchase_user_all'))]" />
    </record>

    <record id="purchase_bill_match_comp_rule" model="ir.rule">
        <field name="name">Purchases &amp; Bills Union multi-company</field>
        <field name="model_id" ref="model_purchase_bill_match" />
        <field name="domain_force">[('company_id', 'in', company_ids + [False])]</field>
    </record>

    <!-- Multi-Buyer Vendor Invoice Analysis Rules -->
    <record id="account_invoice_report_purchase_personal_rule" model="ir.rule">
        <field name="name">Personal Vendor Bills Analysis</field>
        <field name="model_id" ref="account.model_account_invoice_report" />
        <field name="domain_force">[('move_type', 'in', ('in_invoice', 'in_refund', 'in_receipt')), '|', ('invoice_user_id', '=', user.id), ('invoice_user_id', '=', False)]</field>
        <field name="groups" eval="[(4, ref('purchase.group_purchase_user'))]" />
    </record>

    <record id="account_invoice_report_purchase_see_all_rule" model="ir.rule">
        <field name="name">All Vendor Bills Analysis</field>
        <field name="model_id" ref="account.model_account_invoice_report" />
        <field name="domain_force">[('move_type', 'in', ('in_invoice', 'in_refund', 'in_receipt'))]</field>
        <field name="groups" eval="[(4, ref('purchase.group_purchase_user_all'))]" />
    </record>

    <!-- Multi-Buyer Vendor Invoice Assignment Rules -->
    <record id="purchase_user_account_move_personal_rule" model="ir.rule">
        <field name="name">Personal Vendor Bills</field>
        <field name="model_id" ref="account.model_account_move" />
        <field name="domain_force">[('move_type', 'in', ('in_invoice', 'in_refund', 'in_receipt')), '|', ('invoice_user_id', '=', user.id), ('invoice_user_id', '=', False)]</field>
        <field name="groups" eval="[(4, ref('purchase.group_purchase_user'))]" />
    </record>

    <record id="purchase_user_account_move_see_all_rule" model="ir.rule">
        <field name="name">All Vendor Bills</field>
        <field name="model_id" ref="account.model_account_move" />
        <field name="domain_force">[('move_type', 'in', ('in_invoice', 'in_refund', 'in_receipt'))]</field>
        <field name="groups" eval="[(4, ref('purchase.group_purchase_user_all'))]" />
    </record>

    <record id="purchase_user_account_move_line_personal_rule" model="ir.rule">
        <field name="name">Personal Vendor Bill Lines</field>
        <field name="model_id" ref="account.model_account_move_line" />
        <field name="domain_force">[('move_id.move_type', 'in', ('in_invoice', 'in_refund', 'in_receipt')), '|', ('move_id.invoice_user_id', '=', user.id), ('move_id.invoice_user_id', '=', False)]</field>
        <field name="groups" eval="[(4, ref('purchase.group_purchase_user'))]" />
    </record>

    <record id="purchase_user_account_move_line_see_all_rule" model="ir.rule">
        <field name="name">All Vendor Bill Lines</field>
        <field name="model_id" ref="account.model_account_move_line" />
        <field name="domain_force">[('move_id.move_type', 'in', ('in_invoice', 'in_refund', 'in_receipt'))]</field>
        <field name="groups" eval="[(4, ref('purchase.group_purchase_user_all'))]" />
    </record>

</odoo>