<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-name="website_livechat.LivechatChannelInfoList" t-inherit="im_livechat.LivechatChannelInfoList" t-inherit-mode="extension">
        <xpath expr="//t[@t-name='extra_infos']" position="inside">
            <t t-set="visitor" t-value="props.thread.livechat_visitor_id"/>
            <div t-if="props.thread.showCorrespondentCountry or visitor?.lang_id">
                <h6 class="pt-3" t-out="countryLanguageLabel"/>
                <div class="d-flex bg-inherit align-items-center gap-1">
                    <img t-if="props.thread.channel?.showCorrespondentCountry" class="o_country_flag" t-att-src="props.thread.channel.correspondentCountry.flagUrl" t-att-title="props.thread.channel.correspondentCountry.code or props.thread.channel.correspondentCountry.name" aria-label="Country"/>
                    <span t-if="visitor?.lang_id" title="Language" t-esc="visitor.lang_id.name"/>
                </div>
            </div>
            <div t-if="visitor?.pageVisitHistoryText" class="d-flex flex-column bg-inherit gap-1">
                <h6 class="pt-3">Recent page views</h6>
                <div t-if="visitor.website_id">
                    <i class="me-1 fa fa-globe" aria-label="Website"/>
                    <span t-esc="visitor.website_id.name"/>
                </div>
                <span t-esc="visitor.pageVisitHistoryText"/>
            </div>
            <div t-if="!props.thread.livechat_end_dt and recentConversations.length" class="d-flex flex-column bg-inherit gap-1">
                <h6 class="pt-3">Recent conversations</h6>
                <div class="btn btn-group o-rounded-bubble d-flex flex-column w-100 p-0 m-0" style="gap: 1px;">
                    <a
                        t-foreach="recentConversations" t-as="channel" t-key="channel.localId"
                        class="o-livechat-LivechatChannelInfoList-recentConversation btn btn-sm btn-secondary btn-group-item d-flex flex-column w-100 m-0 px-3 py-1"
                        t-attf-href="/odoo/discuss?active_id=discuss.channel_{{channel.id}}"
                        target="_blank"
                        t-att-class="{
                            'o-rounded-top-bubble': channel_first,
                            'o-rounded-bottom-bubble': channel_last,
                            'rounded-top-0': !channel_first,
                            'rounded-bottom-0 border-bottom': !channel_last,
                        }"
                    >
                        <div class="d-flex align-items-center">
                            <i class="fa fa-external-link me-2 o-mt-0_5 opacity-75"/>
                            <span>
                                <t t-if="channel.livechat_end_dt" t-out="CLOSED_ON_TEXT(channel)"/>
                                <t t-else="">Conversation ongoing</t>
                            </span>
                        </div>
                        <span t-if="channel.description" class="text-start text-muted smaller text-truncate" t-out="channel.description"/>
                    </a>
                </div>
            </div>
        </xpath>
    </t>
</templates>
