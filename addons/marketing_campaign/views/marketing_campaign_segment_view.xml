<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">

    <!-- Marketing Segments -->
    <record model="ir.ui.view" id="view_marketing_campaign_segment_form" >
        <field name="name">marketing.campaign.segment.form</field>
        <field name="model">marketing.campaign.segment</field>
        <field name="arch" type="xml">
            <form string="Marketing Campaign Segment">
            <header>
                <button name="state_running_set" string="Run" states="draft" class="oe_highlight"/>
                <button name="state_done_set" string="Close" states="running" class="oe_highlight"/>
                <button name="state_draft_set" string="Set to Draft" states="done,cancelled"/>
                <button name="state_cancel_set" string="Cancel Segment" states="running"/>
                <field name="state" readonly="1" widget="statusbar" statusbar_visible="draft,running,done"/>
            </header>
            <sheet string="Segments" >
                <group>
                    <group>
                        <field name="name"/>
                        <field name="campaign_id" on_change="onchange_campaign_id(campaign_id)"/>
                        <field name="object_id" invisible="1"/>
                        <field name="sync_mode" required="True"/>
                       <label for="sync_last_date"/>
                       <div>
                           <field name="sync_last_date" class="oe_inline"/>
                           <button string="Synchronize Manually" states="running" name="synchroniz" type="object"/>
                       </div>
                       <field name="date_next_sync"/>
                    </group>
                    <group>
                        <field name="ir_filter_id"/>
                        <field name="date_run" readonly="1"/>
                        <field name="date_done" readonly="1"/>
                    </group>
                </group>
            </sheet>
            </form>
        </field>
    </record>

    <record model="ir.ui.view" id="view_marketing_campaign_segment_tree">
        <field name="name">marketing.campaign.segment.tree</field>
        <field name="model">marketing.campaign.segment</field>
        <field name="arch" type="xml">
            <tree decoration-info="state == 'draft'" decoration-muted="state in ('done','cancelled')" string="Segments">
                <field name="name"/>
                <field name="campaign_id"/>
                <field name="date_run"/>
                <field name="sync_last_date"/>
                <field name="state"/>
            </tree>
        </field>
    </record>

    <record id="view_marketing_campaign_segment_search" model="ir.ui.view">
        <field name="name">marketing.campaign.segment.search</field>
        <field name="model">marketing.campaign.segment</field>
        <field name="arch" type="xml">
            <search string="Segments">
                <field name="name" string="Segment"/>
                <field name="date_run"/>
                <filter icon="terp-check" string="Running" name="running" domain="[('state','=','running')]"/>
                <filter icon="terp-document-new" string="Draft" domain="[('state','=','draft')]"/>
                <separator/>
                <filter icon="terp-gtk-jump-to-ltr" string="Newly Created" help="Sync mode: only records created after last sync" domain="[('sync_mode','=','create_date')]"/>
                <filter icon="terp-stock_effects-object-colorize" string="Newly Modified" help="Sync mode: only records updated after last sync" domain="[('sync_mode','=','write_date')]"/>
                <filter icon="terp-emblem-documents" string="All" help="Sync mode: all records" domain="[('sync_mode','=','all')]"/>
                <field name="campaign_id"/>
                <field name="object_id"/>
                <group expand="0" string="Group By">
                    <filter string="Campaign" name="Campaign" icon="terp-gtk-jump-to-rtl" context="{'group_by':'campaign_id'}"/>
                    <filter string="Status" name="Status" icon="terp-stock_effects-object-colorize" context="{'group_by':'state'}"/>
                    <filter string="Launch Month" name="Launch Date" icon="terp-go-month" context="{'group_by':'date_run'}"/>
                </group>
            </search>
        </field>
    </record>

    <record model="ir.actions.act_window" id="action_marketing_campaign_segment_form">
        <field name="name">Segments</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">marketing.campaign.segment</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="view_marketing_campaign_segment_tree"/>
        <field name="search_view_id" ref="view_marketing_campaign_segment_search"/>
        <field name="context">{'group_by': []}</field>
    </record>

    <menuitem id="menu_marketing_campaign_segment_form" parent="menu_marketing_campaign_campaigns" action="action_marketing_campaign_segment_form" sequence="2"/>

    </data>
</odoo>
