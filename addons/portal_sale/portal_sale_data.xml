<openerp>
    <!-- Mail template is done in a NOUPDATE block
         so users can freely customize/delete them -->
    <data noupdate="1">

        <!--Email template -->
        <record id="email_template_edi_sale" model="mail.template">
            <field name="name">Sales Order - Send by Email (Portal)</field>
            <field name="email_from">${(object.user_id.email or '')|safe}</field>
            <field name="subject">${object.company_id.name|safe} ${object.state in ('draft', 'sent') and 'Quotation' or 'Order'} (Ref ${object.name or 'n/a' })</field>
            <field name="partner_to">${object.partner_invoice_id.id}</field>
            <field name="model_id" ref="sale.model_sale_order"/>
            <field name="auto_delete" eval="True"/>
            <field name="report_template" ref="sale.report_sale_order"/>
            <field name="report_name">${(object.name or '').replace('/','_')}_${object.state == 'draft' and 'draft' or ''}</field>
            <field name="lang">${object.partner_id.lang}</field>
            <field name="body_html"><![CDATA[
<div style="font-family: 'Lucica Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 12px;">
    <img src="/web/static/src/img/logo.png" style="padding: 0px; margin-left:-4px; height: auto; width: 80px;" alt="Your Logo">
        <p>Hello 
        % if object.partner_id.company_type == 'company':
            ${ object.partner_id.child_ids and object.partner_id.child_ids[0].name or object.partner_id.name}
        % else :
            ${object.partner_id.name}
        % endif
    ,</p>
    <p>
        % if object.client_order_ref:
            With reference of ${object.client_order_ref}
        % endif
        Here is your ${object.state in ('draft', 'sent') and 'quotation' or 'order confirmation'}<strong>${object.name}</strong>
        % if object.origin:
            ( Order reference: ${object.origin} )
        % endif
        amounting <strong>${object.amount_total} ${object.pricelist_id.currency_id.name}</strong>, dated on ${format_tz(object.date_order, tz=user.tz, context={'lang':object.partner_id.lang})}
        from ${object.company_id.name}.
        % if object.validity_date and object.state in ('draft', 'sent'):
            <br/>The ${object.state in ('draft', 'sent') and 'quotation' or 'order confirmation'} will be expiring on <strong>${object.validity_date}</strong>.
        % endif
    </p>

    <% set signup_url = object.get_signup_url() %>
    % if signup_url and object.amount_total > 0 :
    <p>
    You can access this document and pay online via our Customer Portal:
    </p>
        <a style="display:block; width: 150px; height:20px; margin-left: 45px; color: #ffffff; font-family: 'Lucida Grande', Helvetica, Arial, sans-serif; font-size: 13px; font-weight: bold; text-align: center; text-decoration: none !important; line-height: 1; padding: 5px 0px 0px 0px; background-color: #a24689; border-radius: 3px 3px; background-repeat: repeat no-repeat;"
           href="${signup_url}">View ${object.state in ('draft', 'sent') and 'Quotation' or 'Order'}</a>
    % endif

    % if object.paypal_url and object.amount_total > 0 :
    <br/>
    <p>It is also possible to directly pay with Paypal:</p>
        <a style="margin-left: 45px;" href="${object.paypal_url}">
            <img class="oe_edi_paypal_button" src="/sale/static/img/btn_paynowcc_lg.gif"/>
        </a>
    % endif

    <br/>
    <p>If you have any question, do not hesitate to contact 
      % if object.user_id:
        <a href="mailto:${object.user_id.email or ''}?subject=Order%20${object.name}">${object.user_id.name}</a>
      % else:
        us
      % endif
    .</p>
    <p>Thank you!</p>
</div>
            ]]></field>
        </record>

        <record id="email_template_edi_invoice" model="mail.template">
            <field name="name">Invoice - Send by Email (Portal)</field>
            <field name="email_from">${(object.user_id.email or object.company_id.email or 'noreply@localhost')|safe}</field>
            <field name="subject">${object.company_id.name|safe} Invoice (Ref ${object.number or 'n/a' })</field>
            <field name="partner_to">${object.partner_id.id}</field>
            <field name="model_id" ref="account.model_account_invoice"/>
            <field name="auto_delete" eval="True"/>
            <field name="report_template" ref="account.account_invoices"/>
            <field name="report_name">Invoice_${(object.number or '').replace('/','_')}_${object.state == 'draft' and 'draft' or ''}</field>
            <field name="lang">${object.partner_id.lang}</field>
            <field name="body_html"><![CDATA[
<div style="font-family: 'Lucica Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 12px;">
    <img src="/web/static/src/img/logo.png" style="padding: 0px; margin-left:-4px; height: auto; width: 80px;" alt="Your Logo">
        <p>Hello 
        % if object.partner_id.company_type == 'company':
            ${ object.partner_id.child_ids and object.partner_id.child_ids[0].name or object.partner_id.name}
        % else :
            ${object.partner_id.name}
        % endif
    ,</p>

    <p>Here is an invoice <strong>${object.number}</strong>
    % if object.origin:
        (Oder reference : ${object.origin})
    %endif
    amounting <strong>${object.amount_total} ${object.currency_id.name}</strong> dated on  ${object.date_invoice}. </p>

    <% set signup_url = object.get_signup_url() %>
    % if signup_url:
    <p>
    You can access the invoice document and pay online via our Customer Portal:
    </p>
        <a style="display:block; width: 150px; height:20px; margin-left: 45px; color: #ffffff; font-family: 'Lucida Grande', Helvetica, Arial, sans-serif; font-size: 13px; font-weight: bold; text-align: center; text-decoration: none !important; line-height: 1; padding: 5px 0px 0px 0px; background-color: #a24689; border-radius: 3px 3px; background-repeat: repeat no-repeat;"
           href="${signup_url}">View Invoice</a>
    % endif
    
    % if object.paypal_url:
    <br/>
    <p>It is also possible to directly pay with Paypal:</p>
        <a style="margin-left: 45px;" href="${object.paypal_url}">
            <img class="oe_edi_paypal_button" src="/sale/static/img/btn_paynowcc_lg.gif"/>
        </a>
    % endif
    
    <br/>
    <p>If you have any question, do not hesitate to contact 
      % if object.user_id:
        <a href="mailto:${object.user_id.email or ''}?subject=Invoice%20${object.number}">${object.user_id.name}</a>
      % else:
        us
      % endif
    .</p>
    <p>Thank you!</p>
</div>
            ]]></field>
        </record>

    </data>
</openerp>
