<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="discuss.CallDeviceSelect">
        <Dropdown
            onStateChanged.bind="this.openSelect"
            disabled="!this.isPermissionGranted(this.props.kind)"
            openOnMouseEnter="false"
        >
            <button
                t-if="this.isPermissionGranted(this.props.kind)"
                class="o-mail-DeviceSelect-button btn cursor-pointer border-1 border-secondary align-items-center d-flex w-100 mw-100 shadow-sm o-dropdown--no-caret overflow-hidden"
                t-att-data-kind="this.props.kind"
                t-attf-class="{{ this.props.roundedType === 'pill' ? 'rounded-pill' : 'rounded' }}"
             >
                <i t-if="this.props.icon" t-att-class="this.props.icon"/>
                <span
                    class="pe-2 d-inline-block text-truncate flex-grow-1 min-w-0"
                    t-attf-class="{{ this.props.icon ? 'ps-2' : '' }}"
                    t-esc="this.selectLabel || this.BROWSER_DEFAULT"/>
                <span t-attf-class="oi smaller {{this.state.isSelectOpen ? 'oi-chevron-up': 'oi-chevron-down'}}"/>
            </button>
            <button
                t-else=""
                class="o-mail-DeviceSelect-button btn cursor-pointer border-1 border-secondary align-items-center d-flex w-100 mw-100 shadow-sm o-dropdown--no-caret"
                t-att-data-kind="this.props.kind"
                t-attf-class="{{ this.props.roundedType === 'pill' ? 'rounded-pill' : 'rounded' }}"
                t-on-pointerdown.prevent="() => this.showPermissionDialog(this.props.kind)"
                t-on-keydown.prevent="() => this.showPermissionDialog(this.props.kind)"
            >
                <i t-if="this.props.icon" t-att-class="this.props.icon"/>
                <span
                    class="d-inline-block text-truncate flex-grow-1 min-w-0"
                    t-attf-class="{{ this.props.icon ? 'ps-2' : '' }}"
                >
                    <t t-esc="this.PERMISSION_NEEDED"/>
                </span>
            </button>
            <t t-set-slot="content">
                <DropdownItem t-if="!this.isBrowserChrome or this.props.kind === 'videoinput'" onSelected="this.onSelectAudioDevice.bind(this)">
                    <i class="fa fa-check me-2" t-if="this.isSelected()"/>
                    <span t-esc="this.BROWSER_DEFAULT"/>
                </DropdownItem>
                <t t-foreach="this.state.userDevices" t-as="device" t-key="device_index">
                    <DropdownItem t-if="device.kind === this.props.kind" onSelected="this.onSelectAudioDevice.bind(this, device)">
                        <i t-if="this.isSelected(device.deviceId)" class="fa fa-check me-2"/>
                        <span t-esc="device.label || 'device ' + device_index"/>
                    </DropdownItem>
                </t>
            </t>
        </Dropdown>
    </t>

</templates>
