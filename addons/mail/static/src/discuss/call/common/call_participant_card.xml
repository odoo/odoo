<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="discuss.CallParticipantCard">
        <div class="o-discuss-CallParticipantCard position-relative cursor-pointer d-flex flex-column align-items-center justify-content-center mh-100 mw-100"
            t-att-class="{
                'o-isTalking': !this.props.minimized and this.isTalking,
                'o-isInvitation opacity-50': !this.rtcSession,
                'o-inset': this.props.inset,
                'pe-none': this.rtc.screenTrack and !this.rtc.screenTrack.enabled,
                'o-small': this.props.inset and (this.ui.isSmall or this.props.minimized),
                'o-active': this.isActiveRtcSession and !this.props.inset and this.props.compact,
                'p-1 rounded-1': !this.isActiveRtcSession,
            }"
            t-att-aria-label="this.name"
            t-att-data-is-context-menu-available="this.isContextMenuAvailable"
            t-attf-class="{{ this.props.className }}"
            t-on-click="this.onClick"
            t-on-mousedown="this.onMouseDown"
            t-on-touchmove="this.onTouchMove"
            t-ref="root"
        >
            <!-- card -->
            <t t-if="!this.props.isSidebarItem and this.props.cardData.type === 'screen' and this.rtc.screenTrack and !this.rtc.screenTrack.enabled">
                <div class="o-text-white display-5 gap-3">
                    <button class="pe-auto bg-transparent o-text-white border-0 opacity-25 opacity-75-hover" t-ref="resumeStream" t-on-click.stop="() => (this.rtc.screenTrack.enabled = true)">
                        <i class="fa fa-fw" t-att-class="{ 'fa-play-circle-o': this.resumeStreamHover.isHover, 'fa-pause-circle-o': !this.resumeStreamHover.isHover }"/> <span><t t-if="this.resumeStreamHover.isHover">Resume stream</t><t t-else="">Stream paused</t></span>
                    </button>
                </div>
            </t>
            <CallParticipantVideo t-elif="this.hasVideo" session="this.rtcSession" type="this.props.cardData.type" inset="this.props.inset"/>
            <div t-else="" class="o-discuss-CallParticipantCard-avatar d-flex align-items-center justify-content-center h-100 w-100 rounded-3" t-att-class="{ 'o-minimized': this.props.minimized, 'o-isRemoteVideo': this.isRemoteVideo }" draggable="false">
                <img t-if="!this.showRemoteWarning" alt="Avatar" class="h-100 rounded-circle border-5 object-fit-cover" t-att-src="this.channelMember?.avatarUrl" draggable="false" t-att-class="{
                    'o-isTalking': this.isTalking and this.props.minimized,
                    'o-isInvitation': !this.rtcSession,
                }"/>
            </div>
            <t t-if="this.rtcSession">
                <!-- overlay -->
                <span class="o-discuss-CallParticipantCard-overlay o-discuss-CallParticipantCard-overlayBottom z-1 position-absolute bottom-0 start-0 d-flex overflow-hidden rounded-3" t-att-class="{ 'o-proportional-container w-50': this.isSmall }" t-att-data-connection-state="this.rtcSession.connectionState">
                    <span t-if="!this.props.minimized and !this.props.inset" class="rounded-3 text-truncate o-proportional-text o-discuss-CallParticipantCard-overlayBottomName" t-att-class="{'o-minimized px-1 small': this.isSmall, 'o-px-1_5 py-1': !this.isSmall }" t-esc="this.name"/>
                    <small t-if="this.rtcSession.is_screen_sharing_on and this.props.minimized and !this.isOfActiveCall" class="user-select-none o-proportional-text o-minimized rounded text-bg-danger d-flex align-items-center fw-bolder p-1" title="live" aria-label="live">
                        LIVE
                    </small>
                </span>
                <span t-if="this.showRemoteWarning" class="o-discuss-CallParticipantCard-overlay o-proportional-container z-1 w-50 position-absolute d-flex align-items-center justify-content-center overflow-hidden">
                    <span class="fw-bolder p-1 rounded-3 o-video-text o-proportional-text">Video visible in the call tab</span>
                </span>
                <CallDropdown t-if="this.isContextMenuAvailable and ((!this.isMobileOS and this.rootHover.isHover) or (this.isMobileOS and !this.props.minimized))" class="'position-absolute top-0 end-0'" menuClass="'d-flex o-discuss-CallParticipantCard-contextMenu'">
                    <button class="o-discuss-CallParticipantCard-contextButton btn btn-secondary btn-sm rounded-circle border-0 smaller p-1" title="Participant options">
                        <i class="fa fa-chevron-down fa-fw"/>
                    </button>
                    <t t-set-slot="content">
                        <CallContextMenu rtcSession="this.rtcSession"/>
                    </t>
                </CallDropdown>
                <div class="o-discuss-CallParticipantCard-overlay position-absolute bottom-0 end-0 d-flex w-50 flex-row-reverse w-50" t-att-class="{ 'o-proportional-container': this.isSmall, 'mw-25': this.props.isSidebarItem or this.props.inset }">
                    <span t-if="this.hasRaisingHand" class="o-proportional-text d-flex flex-column justify-content-center me-1 rounded-circle bg-500" t-att-class="{'o-minimized p-1': this.isSmall, 'p-2': !this.isSmall }" title="raising hand" aria-label="raising hand">
                        <i class="fa fa-hand-paper-o"/>
                    </span>
                    <span t-if="this.rtcSession.is_muted and !this.rtcSession.is_deaf" class="o-proportional-text d-flex flex-column justify-content-center me-1 rounded-circle o-discuss-CallParticipantCard-iconBlackBg" t-att-class="{'o-minimized p-1': this.isSmall, 'p-2': !this.isSmall }" title="muted" aria-label="muted">
                        <i class="fa fa-microphone-slash"/>
                    </span>
                    <span t-if="this.rtcSession.is_deaf" class="o-proportional-text d-flex flex-column justify-content-center me-1 rounded-circle o-discuss-CallParticipantCard-iconBlackBg" t-att-class="{'o-minimized p-1': this.isSmall, 'p-2': !this.isSmall }" title="deaf" aria-label="deaf">
                        <i class="fa fa-deaf"/>
                    </span>
                    <span t-if="this.hasMediaError" class="o-discuss-CallParticipantCard-overlay-replayButton o-proportional-text d-flex flex-column justify-content-center me-1 rounded-circle" t-att-class="{'o-minimized p-1': this.isSmall, 'p-2': !this.isSmall }" title="media player Error" t-on-click.stop="this.onClickReplay">
                        <i t-if="this.rootHover.isHover" class="fa fa-repeat text-danger"/>
                        <i t-else="" class="fa fa-exclamation-triangle text-danger"/>
                    </span>
                    <span t-if="this.showConnectionState" class="o-proportional-text d-flex flex-column justify-content-center me-1 rounded-circle o-discuss-CallParticipantCard-iconBlackBg" t-att-class="{'o-minimized p-1': this.isSmall, 'p-2': !this.isSmall }" t-att-title="this.rtcSession.connectionState">
                        <i class="fa fa-exclamation-triangle text-warning"/>
                    </span>
                    <span t-if="this.showLiveLabel" class="user-select-none rounded o-proportional-text text-bg-danger d-flex align-items-center py-1 px-2 fw-bolder" title="live" aria-label="live">
                        LIVE
                    </span>
                </div>
            </t>
        </div>
    </t>

</templates>
