<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="mail.AttachmentPanel">
        <t t-set="title">Attachments</t>
        <ActionPanel title="title">
            <div t-if="hasToggleAllowPublicUpload" class="form-check form-switch">
                <label class="form-check-label">
                    <input t-on-change="toggleAllowPublicUpload" class="form-check-input" type="checkbox" role="switch" t-att-checked="props.thread.allow_public_upload"/>
                    <t t-if="props.thread.allow_public_upload">File upload is enabled for external users</t>
                    <t t-else="">File upload is disabled for external users</t>
                </label>
            </div>
            <div class="flex-grow-1">
                <div class="d-flex flex-column">
                    <div class="o-mail-AttachmentpanelCatgory" t-on-click="(ev) => this.handleTabSelection(ev)">
                        <div class="o-mail-AttachmentPanelCategory-title" t-att-class="state.current === 'media' ? 'active' : ''" data-tab="media">
                            Media
                        </div>
                        <div class="o-mail-AttachmentPanelCategory-title" t-att-class="state.current === 'links' ? 'active' : ''" data-tab="links">
                            Links
                        </div>
                        <div class="o-mail-AttachmentPanelCategory-title" t-att-class="state.current === 'files' ? 'active' : ''" data-tab="files" title="Files">
                            Files
                        </div>
                    </div>
                    <div t-if="state.current === 'media'">
                        <p t-if="state.media === 0" class="text-center fst-italic text-500 mt-4">
                            <t t-if="props.thread.type === 'channel'">This channel doesn't have any media attachments.</t>
                            <t t-else="" >This conversation doesn't have any media attachments.</t>
                        </p>
                        <div t-foreach="this.categorizedAttachments('media')" t-as="dateDay" t-key="dateDay">
                            <DateSection date="dateDay" className="'my-1'"/>
                            <AttachmentList imagesHeight="100" attachments="dateDay_value" unlinkAttachment="(attachment) => this.attachmentUploadService.unlink(attachment)"/>
                        </div>
                    </div>
                    <div t-elif="state.current === 'links'">
                        <p t-if="state.linkPreviews === 0" class="text-center fst-italic text-500 mt-4">
                            <t t-if="props.thread.type === 'channel'">This channel doesn't have any links.</t>
                            <t t-else="">This conversation doesn't have any links.</t>
                        </p>
                        <div t-foreach="this.categorizedAttachments('link')" t-as="links" t-key="link">
                            <DateSection date="links" className="'my-1'"/>
                            <LinkAttachment links="links_value"/>
                        </div>
                    </div>
                    <div t-elif="state.current === 'files'">
                        <p t-if="state.files === 0" class="text-center fst-italic text-500 mt-4">
                            <t t-if="props.thread.type === 'channel'">This channel doesn't have any file attachments.</t>
                            <t t-else="">This conversation doesn't have any file attachments.</t>
                        </p>
                        <div t-foreach="this.categorizedAttachments('file')" t-as="dateDay" t-key="dateDay">
                            <DateSection date="dateDay" className="'my-1'"/>
                            <AttachmentList imagesHeight="100" attachments="dateDay_value" unlinkAttachment="(attachment) => this.attachmentUploadService.unlink(attachment)"/>
                        </div>
                    </div>
                </div>
            </div>
            <span t-ref="load-older"/>
        </ActionPanel>
    </t>
</templates>
