<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-name="mail.DiscussSidebarSubchannel">
        <Dropdown t-if="this.store.discuss.isSidebarCompact" state="this.floating" position="'right-start'" menuClass="'o-mail-DiscussSidebar-floatingMenu rounded-2 o-discuss-dropdownMenu border-secondary mx-2 my-0 min-w-0 ' + this.store.discussDropdownMenuClass(this)" manual="true">
            <t t-call="mail.DiscussSidebarSubchannel.main"/>
            <t t-set-slot="content">
                <UseHoverOverlay hover="this.hover">
                    <div class="overflow-hidden d-flex flex-column" t-ref="floating">
                        <span class="fw-bolder user-select-none text-truncate d-inline-block p-2 pb-0" t-esc="this.channel.displayName"/>
                        <DiscussSidebarChannelActions channel="this.channel"/>
                    </div>
                </UseHoverOverlay>
            </t>
        </Dropdown>
        <t t-else="" t-call="mail.DiscussSidebarSubchannel.main"/>
    </t>

    <t t-name="mail.DiscussSidebarSubchannel.main">
        <li class="o-mail-DiscussSidebarSubchannel d-flex align-items-center flex-grow-1 position-relative" t-att-class="{ 'p-0': !this.store.discuss.isSidebarCompact, 'o-pt-0_5': !this.store.discuss.isSidebarCompact and this.props.isFirst }" t-ref="root">
            <t t-if="!this.store.discuss.isSidebarCompact">
                <svg xmlns="http://www.w3.org/2000/svg" t-if="this.props.isFirst" class="position-absolute opacity-75" style="top: -8px;" width="10" height="25" viewBox="0 0 10 25">
                    <line x1="0" y1="3" x2="0" y2="100%" stroke="currentColor" stroke-width="3"/>
                    <line x1="0" y1="100%" x2="100%" y2="100%" stroke="currentColor" stroke-width="3"/>
                </svg>
                <svg xmlns="http://www.w3.org/2000/svg" t-else="" class="position-absolute opacity-75" style="top: -18px;" width="10" height="33" viewBox="0 0 10 33">
                    <line x1="0" y1="3" x2="0" y2="100%" stroke="currentColor" stroke-width="3"/>
                    <line x1="0" y1="100%" x2="100%" y2="100%" stroke="currentColor" stroke-width="3"/>
                </svg>
            </t>
            <button class="o-mail-DiscussSidebarChannel-subChannel o-mail-DiscussSidebar-item btn btn-secondary border-0 bg-inherit d-flex flex-grow-1 smaller rounded-2 text-start text-truncate align-items-center" t-att-title="this.store.discuss.isSidebarCompact ? undefined : this.channel.displayName" t-on-click="(ev) => this.openChannel(ev, this.channel)" t-att-class="{
                'o-active': this.channel.discussAppAsThread,
                'px-1 py-2 mx-1 text-wrap word-break lh-1': this.store.discuss.isSidebarCompact,
                'o-nonCompact me-1 pe-0 ps-1 o-py-0_5': !this.store.discuss.isSidebarCompact,
                'o-unread': this.channel.self_member_id?.message_unread_counter > 0 and !this.channel.self_member_id?.mute_until_dt,
                'opacity-50': this.channel.self_member_id?.mute_until_dt,
            }">
                <span class="text-truncate" t-esc="this.channel.displayName" t-att-class="{
                    'fw-bolder': this.channel.self_member_id?.message_unread_counter > 0,
                    'opacity-75 opacity-100-hover': !(this.channel.self_member_id?.message_unread_counter > 0 and !this.channel.self_member_id?.mute_until_dt),
                }" t-att-style="this.store.discuss.isSidebarCompact ? 'text-overflow: clip;' : ''"/>
                <span class="flex-grow-1"/>
                <t t-if="!this.store.discuss.isSidebarCompact" t-call="mail.DiscussSidebarChannel.actions"/>
                <span t-if="this.channel.importantCounter > 0" t-attf-class="o-mail-DiscussSidebar-badge shadow-sm badge rounded-pill o-discuss-badge fw-bold {{this.channel.self_member_id?.mute_until_dt ? 'o-muted' : ''}}" t-att-class="{ 'mx-1': !this.store.discuss.isSidebarCompact, 'position-absolute o-compact': this.store.discuss.isSidebarCompact }" t-esc="this.channel.importantCounter"/>
            </button>
            <t t-if="this.channel.self_member_id?.message_unread_counter > 0 and !this.channel.self_member_id?.mute_until_dt and this.channel.importantCounter === 0" t-call="mail.DiscussSidebar.unreadIndicator"/>
        </li>
    </t>
</templates>
