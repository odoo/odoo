<?xml version="1.0" encoding="UTF-8" ?>
<templates xml:space="preserve">

<t t-name="mail.WelcomePage">
    <t t-set="showCallPreview" t-value="store.discuss.thread.default_display_mode === 'video_full_screen'"/>
    <div class="o-mail-WelcomePage w-100 d-flex flex-column justify-content-md-center align-items-center bg-light p-3" style="min-height: 100dvh;">
        <h1 class="fw-light text-center">
            <span t-if="this.store.discuss.thread.default_display_mode === 'video_full_screen'">You've been invited to a meeting!</span>
            <span t-else="">You've been invited to a chat!</span>
        </h1>
        <h2 class="m-3 m-md-5" t-esc="store.companyName"/>
        <div class="w-100 d-flex justify-content-center gap-5" t-att-class="{'flex-column': ui.isSmall}">
            <div t-if="showCallPreview" class="w-100 align-self-center" style="max-width: 640px;">
                <div class="position-relative d-flex flex-column align-items-center" t-ref="root">
                    <video class="shadow rounded-3 bg-dark object-fit-contain" t-attf-height="{{ui.isSmall ? 240 : 360}}" width="100%" autoplay="" t-ref="video"/>
                    <p t-if="hasRtcSupport and !state.videoStream" class="position-absolute bottom-50 text-light">
                        Camera is off
                    </p>
                    <p t-if="!hasRtcSupport" class="position-absolute bottom-50 text-light">
                        Your browser does not support videoconference
                    </p>
                    <div class="position-absolute d-flex gap-3 mb-3 bottom-0">
                        <button class="btn fa-stack p-0 rounded-circle fs-2 shadow" t-attf-class="{{ state.audioStream ? 'btn-dark' : 'btn-danger' }}" t-on-click="onClickMic">
                            <i class="fa" t-attf-class="{{ state.audioStream ? 'fa-microphone' : 'fa-microphone-slash' }}"/>
                            <span t-if="rtc.microphonePermission !== 'granted'" class="position-absolute text-dark fw-bolder mt-1 start-100 translate-middle p-1 badge rounded-circle bg-warning">
                                <i class="fa fa-exclamation-triangle"/>
                            </span>
                        </button>
                        <button class="btn fa-stack p-0 rounded-circle fs-2 shadow" t-attf-class="{{ state.videoStream ? 'btn-dark' : 'btn-danger' }}" t-on-click="onClickVideo">
                            <i class="fa fa-camera"/>
                            <span t-if="rtc.cameraPermission !== 'granted'" class="position-absolute text-dark fw-bolder mt-1 start-100 translate-middle p-1 badge rounded-circle bg-warning">
                                <i class="fa fa-exclamation-triangle"/>
                            </span>
                        </button>
                        <button t-if="state.videoStream" class="btn fa-stack p-0 rounded-circle fs-2 shadow" t-attf-class="{{ store.settings.useBlur ? 'btn-secondary' : 'btn-dark' }}" t-on-click="onClickBlur" t-att-title="blurButtonTitle">
                            <i class="fa fa-photo" t-att-class="{ 'opacity-50': !store.settings.useBlur }"/>
                        </button>
                    </div>
                    <audio autoplay="" t-ref="audio"/>
                </div>
                <div class="d-flex flex-column flex-md-row gap-2 text-muted mt-3">
                    <div class="w-100 text-uppercase">
                        <i class="fa fa-microphone"></i> Microphone
                        <DeviceSelect kind="'audioinput'"/>
                    </div>
                    <div class="w-100 text-uppercase">
                        <i class="fa fa-volume-up"></i> Output
                        <DeviceSelect kind="'audiooutput'"/>
                    </div>
                    <div class="w-100 text-uppercase">
                        <i class="fa fa-camera"></i> Camera
                        <DeviceSelect kind="'videoinput'"/>
                    </div>
                </div>
            </div>
            <div class="d-flex flex-column text-center justify-content-center">
                <div class="d-flex flex-column gap-2" t-if="store.self_guest and !store.self_partner">
                    <label class="fs-4" >What's your name?</label>
                    <input class="form-control mb-3 bg-white rounded" type="text" placeholder="Your name" t-model="state.userName" t-on-keydown="onKeydownInput"/>
                </div>
                <div class="fs-3" t-if="store.self_partner">
                    <p>Ready to join?</p>
                    <p t-if="showCallPreview and noActiveParticipants">No one else is here.</p>
                </div>
                <button class="d-flex btn btn-light rounded-pill align-items-center justify-content-center gap-3 px-4 fs-3" title="Join Channel" t-on-click="joinChannel">
                    <t t-if="showCallPreview" t-set="joinText">Join call</t>
                    <t t-else="" t-set="joinText">Join</t>
                    <span class="mb-0 text-success" t-esc="joinText"/>
                    <span class="rounded-circle bg-success d-flex align-items-center justify-content-center p-2">
                        <i class="oi oi-arrow-right text-white"/>
                    </span>
                </button>
            </div>
        </div>
    </div>
</t>

</templates>
