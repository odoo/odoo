<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-inherit="mail.MessagingMenu.content" t-inherit-mode="extension">
        <xpath expr="//*[@t-ref='threads']" position="replace">
            <t t-foreach="threads" t-as="thread" t-key="thread.localId" t-ref="threads">
                <t t-set="channel" t-value="getChannel(thread)"/>
                <t t-set="message" t-value="thread.isChatChannel or (thread.type === 'channel' and !thread.hasNeedactionMessages) ? thread.newestMessage : thread.newestNeedactionMessage"/>
                <NotificationItem
                    body="message?.inlineBody"
                    counter="thread.isChatChannel ? thread.message_unread_counter : thread.hasNeedactionMessages ? thread.message_needaction_counter : undefined"
                    datetime="message?.datetime"
                    displayName="thread.displayName"
                    iconSrc="thread.imgUrl"
                    hasMarkAsReadButton="thread.isUnread"
                    onClick="(isMarkAsRead) => this.onClickThread(isMarkAsRead, thread)"
                    onSwipeRight="hasTouch() and thread.isUnread ? { action: () => this.markAsRead(thread), icon: 'fa-check-circle', bgColor: 'bg-success' } : undefined"
                    onSwipeLeft="hasTouch() and threadService.canUnpin(thread) ? { action: () => this.threadService.unpin(thread), icon: 'fa-times-circle', bgColor: 'bg-danger' } : undefined"
                >
                    <t t-set-slot="icon">
                        <ImStatus t-if="channel?.type === 'chat'" persona="channel.correspondent" className="'position-absolute top-100 start-100 translate-middle mt-n1 ms-n1'"/>
                    </t>
                    <t t-if="message" t-set-slot="body-icon">
                        <t t-if="message.isSelfAuthored">
                            <i class="fa fa-mail-reply me-1"/>You:
                        </t>
                        <t t-elif="message.author">
                            <t t-esc="message.author.name"/>:
                        </t>
                    </t>
                </NotificationItem>
            </t>
        </xpath>
    </t>
</templates>
