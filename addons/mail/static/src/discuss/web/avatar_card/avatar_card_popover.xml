<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-name="mail.AvatarCardPopover">
        <div class="o_avatar_card card border-0 rounded">
            <div class="card-body bg-inherit rounded">
                <div class="d-flex align-items-start gap-2 bg-inherit">
                    <span class="o_avatar pt-1 position-relative o_card_avatar bg-inherit">
                        <img t-if="props.id"
                            t-attf-src="/web/image/{{props.model}}/{{props.id}}/avatar_128"
                            class="rounded"
                        />
                        <span t-if="partner?.im_status and partner.im_status !== 'im_partner'" name="icon" class="o_card_avatar_im_status position-absolute d-flex align-items-center justify-content-center bg-inherit">
                            <ImStatus persona="partner" />
                        </span>
                    </span>
                    <div class="d-flex flex-column o_card_user_infos overflow-hidden">
                        <div class="o-mail-avatar-card-name-actions d-flex align-items-center justify-content-center">
                            <span class="o-mail-avatar-card-name fw-bold" t-if="name" t-esc="name"/>
                            <div class="flex-grow-1"/>
                            <Dropdown t-if="canOpenSettingMenu" position="'right-start'">
                                <button class="btn btn-sm">
                                    <i class="oi oi-ellipsis-v"/>
                                </button>
                                <t t-set-slot="content">
                                    <DropdownItem t-if="canSetAdmin" onSelected="() => this.setChannelRole('admin')">
                                        Set Channel Admin
                                    </DropdownItem>
                                    <DropdownItem t-if="canRemoveAdmin or canRemoveOwner" onSelected="() => this.setChannelRole(false)">
                                        <t t-if="canRemoveOwner">Remove Channel Owner</t>
                                        <t t-if="canRemoveAdmin">Remove Channel Admin</t>
                                    </DropdownItem>
                                    <DropdownItem t-if="canSetOwner" onSelected="() => this.setChannelRole('owner')">
                                        Set Channel Owner
                                    </DropdownItem>
                                    <DropdownItem t-if="canRemoveMember" onSelected.bind="onClickRemove">
                                        <span class="text-danger">Remove from Channel</span>
                                    </DropdownItem>
                                </t>
                            </Dropdown>
                        </div>
                        <t t-if="userInfoTemplate" t-call="{{userInfoTemplate}}"/>
                        <a t-if="email" t-att-href="'mailto:'+email" t-att-title="email" class="text-truncate">
                            <i class="fa fa-fw fa-envelope me-1"/><t t-esc="email"/>
                        </a>
                        <a t-if="phone" class="o-mail-avatar-card-tel text-truncate" t-att-title="phone" t-att-href="'tel:'+phone">
                            <i class="fa fa-fw fa-phone me-1"/><t t-esc="phone"/>
                        </a>
                        <div t-if="state.partnerLocalDateTimeFormatted" class="text-muted">
                            <i class="fa fa-fw fa-clock-o me-1"/><t t-out="state.partnerLocalDateTimeFormatted"/>
                        </div>
                        <div class="o_avatar_card_buttons d-flex gap-2 mt-2">
                            <button t-if="(user?.share ?? partner?.partner_share) === false" class="btn btn-secondary btn-sm" t-on-click.stop="onSendClick">Send message</button>
                            <button t-if="showViewProfileBtn" class="btn btn-secondary btn-sm" t-custom-click.stop="(ev, isMiddleClick) => this.onClickViewProfile(isMiddleClick)" t-ref="viewProfileBtn">View Profile</button>
                        </div>
                    </div>
                </div>
            </div>
            <div t-if="hasFooter" class="o_avatar_card_details card-footer d-flex flex-column gap-3 rounded-bottom bg-100"/>
        </div>
    </t>
</templates>
