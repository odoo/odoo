<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="mail.Activity" owl="1">
        <t t-if="activityView">
            <div class="d-flex p-2" t-attf-class="{{ className() }}" t-on-click="activityView.onClickActivity" t-ref="root">
                <div class="mr-3" t-attf-class="{{ className('sidebar') }}">
                    <div class="position-relative h-100 w-100" t-attf-class="{{ className('user') }}">
                        <t t-if="activityView.activity.assignee">
                            <img class="rounded-circle h-100 w-100 o_object_fit_cover" t-attf-class="{{ className('userAvatar') }}" t-attf-src="/web/image/res.users/{{ activityView.activity.assignee.id }}/avatar_128" t-att-alt="activityView.activity.assignee.nameOrDisplayName"/>
                        </t>
                        <div class="d-flex align-items-center justify-content-center rounded-circle w-50 h-50 text-white"
                            t-attf-class="{{ className('iconContainer') }}"
                            t-att-class="{
                                'bg-success': activityView.activity.state === 'planned',
                                'bg-warning': activityView.activity.state === 'today',
                                'bg-danger': activityView.activity.state === 'overdue',
                            }"
                        >
                            <i class="fa small" t-attf-class="{{ className('icon') activityView.activity.icon }}"/>
                        </div>
                    </div>
                </div>
                <div t-attf-class="{{ className('core') }}">
                    <div class="d-flex align-items-baseline" t-attf-class="{{ className('info') }}">
                        <div class="me-2"
                            t-attf-class="{{ className('dueDateText') }}"
                            t-att-class="{
                                'text-danger': activityView.activity.state === 'overdue',
                                'text-success': activityView.activity.state === 'planned',
                                'text-warning': activityView.activity.state === 'today',
                            }"
                        >
                            <b t-esc="activityView.delayLabel"/>
                        </div>
                        <t t-if="activityView.activity.summary">
                            <b class="text-900 me-2" t-attf-class="{{ className('summary') }}">
                                <t t-esc="activityView.summary"/>
                            </b>
                        </t>
                        <t t-elif="activityView.activity.type">
                            <b class="text-900 me-2" t-attf-class="{{ className('summary', 'type') }}">
                                <t t-esc="activityView.activity.type.displayName"/>
                            </b>
                        </t>
                        <t t-if="activityView.activity.assignee">
                            <div t-attf-class="{{ className('userName') }}">
                                <t t-esc="activityView.assignedUserText"/>
                            </div>
                        </t>
                        <a
                            class="btn py-0"
                            t-attf-class="{{ className('detailsButton') }}"
                            t-att-class="activityView.areDetailsVisible ? 'text-primary' : 'btn-link btn-primary'"
                            t-on-click="activityView.onClickDetailsButton"
                            role="button"
                        >
                            <i class="fa fa-info-circle" role="img" title="Info"/>
                        </a>
                    </div>

                    <t t-if="activityView.areDetailsVisible">
                        <div t-attf-class="{{ className('details') }}">
                            <div class="d-md-table table table-sm mt-2 mb-3">
                                <div t-if="activityView.activity.type" class="d-md-table-row mb-3">
                                    <div class="d-md-table-cell font-weight-bold text-md-right m-0 py-md-1 px-md-4">Activity type</div>
                                    <div class="d-md-table-cell py-md-1 pr-4" t-attf-class="{{ className('type') }}">
                                        <t t-esc="activityView.activity.type.displayName"/>
                                    </div>
                                </div>
                                <div t-if="activityView.activity.creator" class="d-md-table-row mb-3">
                                    <div class="d-md-table-cell font-weight-bold text-md-right m-0 py-md-1 px-md-4">Created</div>
                                    <div class="d-md-table-cell py-md-1 pr-4" t-attf-class="{{ className('detailsCreation') }}">
                                        <t t-esc="activityView.formattedCreateDatetime"/>, <br t-if="messaging.device.isMobile"/>by
                                        <img class="ms-1 me-1 rounded-circle align-text-bottom" t-attf-class="{{ className('detailsUserAvatar', 'detailsCreatorAvatar') }}" t-attf-src="/web/image/res.users/{{ activityView.activity.creator.id }}/avatar_128" t-att-title="activityView.activity.creator.nameOrDisplayName" t-att-alt="activityView.activity.creator.nameOrDisplayName"/>
                                        <b t-attf-class="{{ className('detailsCreator') }}">
                                            <t t-esc="activityView.activity.creator.nameOrDisplayName"/>
                                        </b>
                                    </div>
                                </div>
                                <div t-if="activityView.activity.assignee" class="d-md-table-row mb-3">
                                    <div class="d-md-table-cell font-weight-bold text-md-right m-0 py-md-1 px-md-4">Assigned to</div>
                                    <div class="d-md-table-cell py-md-1 pr-4" t-attf-class="{{ className('detailsAssignation') }}">
                                        <img class="me-1 rounded-circle align-text-bottom" t-attf-class="{{ className('detailsUserAvatar', 'detailsAssignationUserAvatar') }}" t-attf-src="/web/image/res.users/{{ activityView.activity.assignee.id }}/avatar_128" t-att-title="activityView.activity.assignee.nameOrDisplayName" t-att-alt="activityView.activity.assignee.nameOrDisplayName"/>
                                        <b t-esc="activityView.activity.assignee.nameOrDisplayName"/>
                                    </div>
                                </div>
                                <div class="d-md-table-row">
                                    <div class="d-md-table-cell font-weight-bold text-md-right m-0 py-md-1 px-md-4">Due on</div>
                                    <div class="d-md-table-cell py-md-1 pr-4" t-attf-class="{{ className('detailsDueDate') }}">
                                        <span
                                            t-attf-class="{{ className('deadlineDateText') }}"
                                            t-att-class="{
                                                'text-danger': activityView.activity.state === 'overdue',
                                                'text-success': activityView.activity.state === 'planned',
                                                'text-warning': activityView.activity.state === 'today',
                                            }"
                                        >
                                            <t t-esc="activityView.formattedDeadlineDate"/>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>

                    <t t-if="activityView.activity.note">
                        <div t-attf-class="{{ className('note') }}">
                            <t t-out="activityView.activity.noteAsMarkup"/>
                        </div>
                    </t>

                    <t t-if="activityView.mailTemplateViews.length > 0">
                        <div t-attf-class="{{ className('mailTemplates') }}">
                            <t t-foreach="activityView.mailTemplateViews" t-as="mailTemplateView" t-key="mailTemplateView.localId">
                                <MailTemplate
                                    className="className('mailTemplate')"
                                    localId="mailTemplateView.localId"
                                />
                            </t>
                        </div>
                    </t>

                    <t t-if="activityView.activity.canWrite">
                        <div name="tools" class="d-flex" t-attf-class="{{ className('tools') }}">
                            <t t-if="!activityView.fileUploader">
                                <Popover position="'right'" title="activityView.markDoneText">
                                    <button class="btn btn-link btn-primary pt-0 pl-0" t-attf-class="{{ className('toolButton', 'markDoneButton') }}" t-att-title="activityView.markDoneText">
                                        <i class="fa fa-check"/> Mark Done
                                    </button>
                                    <t t-set-slot="opened">
                                        <ActivityMarkDonePopover localId="activityView.activityMarkDonePopoverView.localId"/>
                                    </t>
                                </Popover>
                            </t>
                            <t t-if="activityView.fileUploader">
                                <button class="btn btn-link btn-primary pt-0 pl-0" t-attf-class="{{ className('toolButton', 'uploadButton') }}" t-on-click="activityView.onClickUploadDocument">
                                    <i class="fa fa-upload"/> Upload Document
                                </button>
                            </t>
                            <button class="btn btn-link btn-primary pt-0" t-attf-class="{{ className('toolButton', 'editButton') }}" t-on-click="activityView.onClickEdit">
                                <i class="fa fa-pencil"/> Edit
                            </button>
                            <button class="btn btn-link btn-primary pt-0" t-attf-class="{{ className('toolButton', 'cancelButton') }}" t-on-click="activityView.onClickCancel" >
                                <i class="fa fa-times"/> Cancel
                            </button>
                        </div>
                    </t>
                </div>
            </div>
        </t>
    </t>

</templates>
