<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-name="mail.AttachmentImage" owl="1">
        <t t-if="attachmentImage">
            <div t-attf-class="{{ className }}" role="menu" t-att-aria-label="attachmentImage.attachment.displayName" t-ref="root">
                <div class="o_AttachmentImage d-flex position-relative flex-shrink-0 o-viewable"
                    t-att-class="{
                        'o-isUploading': attachmentImage.attachment.isUploading,
                    }"
                    t-att-title="attachmentImage.attachment.displayName ? attachmentImage.attachment.displayName : undefined"
                    t-att-data-id="attachmentImage.attachment.localId"
                    tabindex="0"
                    aria-label="View image"
                    role="menuitem"
                    t-on-click="attachmentImage.onClickImage"
                    t-att-data-mimetype="attachmentImage.attachment.mimetype"
                >
                    <t t-if="!attachmentImage.attachment.isUploading">
                        <img class="img img-fluid my-0 mx-auto" t-att-src="attachmentImage.imageUrl" t-att-alt="attachmentImage.attachment.name" t-attf-style="max-width: min(100%, {{ attachmentImage.width }}px); max-height: {{ attachmentImage.height }}px;"/>
                    </t>
                    <t t-if="attachmentImage.attachment.isUploading">
                        <div class="o_AttachmentImageUploading position-absolute top-0 bottom-0 start-0 end-0 d-flex align-items-center justify-content-center" title="Uploading">
                            <i class="fa fa-spin fa-spinner"/>
                        </div>
                    </t>
                    <div class="o_AttachmentImage_imageOverlay position-absolute top-0 bottom-0 start-0 end-0 p-2 text-white opacity-0 opacity-100-hover d-flex align-items-end flax-wrap flex-column">
                        <ImageActions actions="getActions(attachmentImage)" imagesHeight="props.imagesHeight"/>
                    </div>
                </div>
            </div>
        </t>
    </t>

    <t t-name="mail.ImageActions" owl="1">
        <div class="o_AttachmentImage_actions position-absolute top-0 bottom-0 start-0 end-0 p-1 text-white d-flex o-opacity-hoverable opacity-100-hover align-items-end flex-wrap flex-column" t-att-class="{ 'opacity-0': !actionsMenuState.isOpen }">
            <button t-if="props.actions.length === 1 and props.imagesHeight gt 75" class="btn btn-sm btn-light rounded px-1 py-0" t-att-class="{ 'opacity-75 opacity-100-hover': !isMobileOS }" tabindex="0" t-att-aria-label="props.actions[0].label" t-att-title="props.actions[0].label" role="menuitem" t-on-click.stop="props.actions[0].onSelect">
                <i t-att-class="props.actions[0].icon"/>
            </button>
            <Dropdown t-else="" onStateChanged="(state) => this.setActionsMenuState(state)" togglerClass="'btn btn-sm btn-light rounded px-1 py-0 o_AttachmentImage_actionDropdown'" menuClass="'d-flex flex-column py-0' + (props.actions.length gt 1 ? ' py-0' : '')" position="'right-start'">
                <t t-set-slot="toggler">
                    <i class="fa fa-fw fa-chevron-down" t-att-class="{ 'opacity-75 opacity-100-hover py-0': !isMobileOS }" tabindex="0" aria-label="Actions" title="Actions" role="menuitem"/>
                </t>
                <t t-set-slot="default">
                    <DropdownItem t-foreach="props.actions" t-as="action" t-key="action_index" class="`px-2 py-1 d-flex align-items-center rounded-0 ${action.class}`" onSelected="action.onSelect">
                        <i class="fa-fw" t-att-class="action.icon"/>
                        <span class="mx-2" t-esc="action.label"/>
                    </DropdownItem>
                </t>
            </Dropdown>
        </div>
    </t>

</templates>
