<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="mail.Chatter" owl="1">
        <div class="o_Chatter position-relative flex-grow-1 flex-column d-flex w-100 bg-view" t-attf-class="{{ className }}" t-ref="root">
            <DropZoneView t-if="dropZoneView"
                className="'o_Chatter_dropZone'"
                record="dropZoneView"
            />
            <div class="o_Chatter_fixedPanel">
                <div t-if="hasTopBar" class="o_ChatterTopbar justify-content-between d-flex">
                    <div class="o_ChatterTopbar_actions flex-fill d-flex border-transparent">
                        <div class="o_ChatterTopbar_controllers d-flex pe-2" t-if="threadView">
                            <button class="o_ChatterTopbar_button o_ChatterTopbar_buttonSendMessage btn text-nowrap me-2"
                                type="button"
                                t-att-class="{
                                    'o-active btn-odoo': composerView and !composerView.composer.isLog,
                                    'btn-odoo': !composerView,
                                    'btn-light': composerView and composerView.composer.isLog,
                                }"
                                t-att-disabled="!hasWriteAccess"
                                data-hotkey="m"
                                t-on-click="onClickSendMessage"
                            >
                                Send message
                            </button>
                            <button class="o_ChatterTopbar_button o_ChatterTopbar_buttonLogNote btn text-nowrap"
                                type="button"
                                t-att-class="{
                                    'o-active btn-odoo': composerView and composerView.composer.isLog,
                                    'btn-light': composerView and !composerView.composer.isLog or !composerView,
                                }"
                                t-att-disabled="!hasWriteAccess"
                                t-on-click="onClickLogNote"
                                data-hotkey="shift+m"
                            >
                                Log note
                            </button>
                        </div>
                        <div class="o_ChatterTopbar_tools position-relative d-flex flex-grow-1 border-bottom"
                            t-att-class="{
                                'border-start ps-2': hasActivities,
                            }"
                        >
                            <button t-if="hasActivities" class="o_ChatterTopbar_button o_ChatterTopbar_buttonScheduleActivity btn btn-light text-nowrap" type="button" t-att-disabled="!hasWriteAccess" t-on-click="onClickScheduleActivity" data-hotkey="shift+a">
                                <i class="fa fa-clock-o me-1"/>
                                <span>Activities</span>
                            </button>
                            <div class="flex-grow-1 border-start pe-2"
                                t-att-class="{
                                    'ms-2': hasActivities,
                                }"
                            />
                            <div class="o_ChatterTopbar_rightSection flex-grow-1 flex-shrink-0 justify-content-end d-flex">
                                <button t-if="thread.allAttachments.length === 0" class="o_ChatterTopbar_button o_ChatterTopbar_buttonAddAttachments btn btn-light btn-primary" type="button" t-att-disabled="!hasWriteAccess" t-on-click="onClickButtonAddAttachments" >
                                    <i class="fa fa-paperclip fa-lg me-1" role="img" aria-label="Attachments"/>
                                    <i t-if="isShowingAttachmentsLoading" class="o_ChatterTopbar_buttonAttachmentsCountLoader fa fa-circle-o-notch fa-spin" aria-label="Attachment counter loading..."/>
                                </button>
                                <button t-if="thread.allAttachments.length > 0" class="o_ChatterTopbar_button o_ChatterTopbar_buttonToggleAttachments btn btn-light btn-primary" type="button" t-att-disabled="!hasReadAccess" t-att-aria-expanded="attachmentBoxView ? 'true' : 'false'" t-on-click="onClickButtonToggleAttachments">
                                    <i class="fa fa-paperclip fa-lg me-1" role="img" aria-label="Attachments"/>
                                    <span t-if="!isShowingAttachmentsLoading" class="o_ChatterTopbar_buttonCount o_ChatterTopbar_buttonAttachmentsCount" t-esc="attachmentButtonText"/>
                                    <i t-if="isShowingAttachmentsLoading" class="o_ChatterTopbar_buttonAttachmentsCountLoader fa fa-circle-o-notch fa-spin" aria-label="Attachment counter loading..."/>
                                </button>
                                <t t-if="hasFollowers and thread">
                                    <FollowerListMenuView
                                        className="'o_ChatterTopbar_followerListMenu'"
                                        record="followerListMenuView"
                                    />
                                    <FollowButtonView t-if="followButtonView"
                                        className="'o_ChatterTopbar_followButton'"
                                        record="followButtonView"
                                    />
                                </t>
                            </div>
                        </div>
                    </div>
                    <button t-if="hasTopbarCloseButton" class="o_ChatterTopbar_buttonClose btn btn-dark flex-shrink-0 rounded-bottom-3" aria-label="Close" t-on-click="onClickChatterTopbarClose">
                        <i class="oi oi-large oi-close"/>
                    </button>
                </div>
                <ComposerView t-if="composerView"
                    className="'o_Chatter_composer border-bottom'"
                    classNameObj="{ 'o-bordered': hasExternalBorder }"
                    record="composerView"
                />
            </div>
            <div class="o_Chatter_scrollPanel overflow-auto" t-on-scroll="onScrollScrollPanel" t-ref="scrollPanel">
                <AttachmentBoxView t-if="attachmentBoxView"
                    className="'o_Chatter_attachmentBox'"
                    record="attachmentBoxView"
                />
                <ActivityBoxView t-if="activityBoxView"
                    className="'o_Chatter_activityBox'"
                    record="activityBoxView"
                />
                <ThreadView t-if="threadView"
                    className="'o_Chatter_thread'"
                    record="threadView"
                />
            </div>
        </div>
    </t>

</templates>
