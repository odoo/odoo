<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

<t t-name="mail.KanbanActivity">
    <div class="o_kanban_inline_block dropdown o_kanban_selection o_mail_activity">
        <a class="dropdown-toggle o-no-caret o_activity_btn" data-toggle="dropdown">
            <span class="fa fa-clock-o fa-lg fa-fw" t-att-title="widget.selection[widget.activityState]" role="img" t-att-aria-label="widget.selection[widget.activity_state]"/>
        </a>
        <div class="dropdown-menu o_activity" role="menu"/>
    </div>
</t>

<t t-name="mail.KanbanActivityLoading">
    <div class="dropdown-item text-center o_no_activity">
        <span class="fa fa-spinner fa-spin fa-2x" role="img" aria-label="Loading..." title="Loading..."/>
    </div>
</t>

<t t-name="mail.KanbanActivityDropdown">
    <span role="menuitem" t-if="_.isEmpty(records)" class="dropdown-item-text text-center o_no_activity">
        No activities planned.
    </span>
    <div t-else="" aria-haspopup="true" role="menu">
        <ul class="nav o_activity_log" role="menu">
            <t t-foreach="_.keys(records)" t-as="key">
                <t t-set="logs" t-value="records[key]" />
                <li role="menuitem" class="nav-item o_activity_label">
                    <strong t-attf-class="o_activity_color_#{key}">
                        <t t-esc="selection[key]" /> (<t t-esc="logs.length"/>)
                    </strong>
                </li>
                <li t-foreach="logs" t-as="log" t-att-data-activity-id="log.id" class="nav-item o_schedule_activity" role="menuitem">
                    <div class="o_activity_title float-left">
                        <span t-attf-class="fa #{log.icon} fa-fw" role="img" aria-label="Log" title="Log"/>
                        <strong>
                            <t t-esc="log.title_action or log.activity_type_id[1]" />
                        </strong>
                        <div>
                            <span class="fa fa-clock-o fa-fw" role="img" aria-label="Deadline" title="Deadline"/>
                            <span t-att-title="log.date_deadline"><t t-esc="log.label_delay" /></span>
                            <div class="mt16" t-att-data-activity-id="log.id" t-att-data-previous-activity-type-id="log.activity_type_id[0]">
                                <t t-if="log.mail_template_ids">
                                    <t t-foreach="log.mail_template_ids" t-as="mail_template">
                                        <div>
                                            <i class="fa fa-envelope-o" aria-label="Mail" title="Mail" role="img"></i>
                                            <span t-esc="mail_template.name"/>:
                                            <span class="o_activity_template_preview" t-att-data-template-id="mail_template.id">Preview</span>
                                            <span class="text-muted">or</span>
                                            <span class="o_activity_template_send" t-att-data-template-id="mail_template.id">Send Now</span>
                                        </div>
                                    </t>
                                </t>
                            </div>
                            <t t-if="log.user_id[0] != uid">
                                <span class="ml4 fa fa-user" role="img" aria-label="User" title="User"/>
                                <span><t t-esc="log.user_id[1]" /></span>
                            </t>
                        </div>
                    </div>
                    <div class="float-right">
                        <span class="o_mark_as_done o_activity_link o_activity_link_kanban fa fa-check-circle fa-2x mt4" t-att-data-previous-activity-type-id="log.activity_type_id[0]" t-att-data-activity-id="log.id" title="Mark as done" role="img" aria-label="Mark as done"/>
                    </div>
                </li>
            </t>
        </ul>
    </div>
    <div role="menuitem" class="o_schedule_activity text-center">
        <a role="button" class="btn btn-link btn-block">
            <i class="fa fa-plus fa-fw"></i><strong>Schedule an activity</strong>
        </a>
    </div>
</t>

</templates>
