<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-inherit="mail.Message" t-inherit-mode="extension">
        <xpath expr="//t[@name='bodyAsNotification']" position="replace">
            <t t-if="this.message.message_type === 'notification' or this.message.is_transient or this.message.trackingValues.length > 0" name="hasTrackingValue">
                <div>
                    <t t-if="this.message.subtype_id?.description">
                        <p class="mb-0">
                            <t t-out="this.props.messageSearch?.highlight(this.message.subtype_id.description) ?? this.message.subtype_id.description"/>
                        </p>
                    </t>
                    <t t-if="this.message.trackingValues.length">
                        <ul class="mb-0 list-unstyled d-flex flex-column gap-1">
                            <t name="trackingValues" t-foreach="this.message.trackingValues" t-as="trackingValue" t-key="this.trackingValue.id">
                                <li class="o-mail-Message-tracking" role="group">
                                    <span class="o-mail-Message-trackingOld text-muted fw-bold" t-out="this.formatTrackingOrNone(this.trackingValue.fieldInfo, this.trackingValue.oldValue)"/>
                                    <t t-if="!this.trackingValue.fieldInfo.isPropertyField">
                                        <i class="o-mail-Message-trackingSeparator fa fa-long-arrow-right mx-2 text-600"/>
                                        <span class="o-mail-Message-trackingNew me-1 fw-bold text-info" t-out="this.formatTrackingOrNone(this.trackingValue.fieldInfo, this.trackingValue.newValue)"/>
                                    </t>
                                    <span class="o-mail-Message-trackingField ms-1 fst-italic text-muted">(<t t-out="this.props.messageSearch?.highlight(this.trackingValue.fieldInfo.changedField) ?? this.trackingValue.fieldInfo.changedField"/>)</span>
                                </li>
                            </t>
                        </ul>
                    </t>
                    <div t-if="!this.message.isEmpty and this.message.richBody" t-call="mail.Message.bodyAsNotification" t-ref="body"/>
                </div>
            </t>
            <t t-else="">$0</t>
        </xpath>
        <xpath expr="//div[hasclass('o-mail-Message-avatarContainer')]" position="attributes">
            <attribute name="t-att-aria-label">this.getAuthorText()</attribute>
            <attribute name="t-on-click">this.ev =&gt; this.onClickAuthor(this.ev)</attribute>
        </xpath>
        <xpath expr="//span[hasclass('o-mail-Message-author')]" position="attributes">
            <attribute name="t-att-aria-label">this.getAuthorText()</attribute>
            <attribute name="t-on-click">this.ev =&gt; this.onClickAuthor(this.ev)</attribute>
        </xpath>
    </t>
    <t t-name="mail.Message.bodyInForward">
        <div><br/></div>
        <div>
            <span>---------- Forwarded message ----------</span><br/>
            <span>Date: <t t-esc="this.date"/></span><br/>
            <span>From: <t t-esc="this.name"/> <a t-att-href="'mailto:' + this.email" target="_blank">&lt;<t t-esc="this.email"/>&gt;</a></span><br/>
            <span>Subject: <t t-esc="this.message.subject || this.message.default_subject"/></span>
        </div>
        <t t-out="this.body"/>
    </t>

    <t t-name="mail.Message.bodyInReply">
        <div><br/></div>
        <div class="o_mail_reply_container">
            <div class="o_mail_reply_content">
                <div>
                    <span>On <t t-esc="this.date"/> <t t-esc="this.name"/> <a t-att-href="'mailto:' + this.email" target="_blank">&lt;<t t-esc="this.email"/>&gt;</a>wrote</span>
                </div>
                <blockquote t-out="this.body"/>
            </div>
        </div>
    </t>
</templates>
