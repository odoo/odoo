<?xml version="1.0" encoding="UTF-8" ?>
<templates xml:space="preserve">

    <t t-name="mail.DiscussSidebarMailboxes">
        <div class="d-flex flex-column flex-grow-0 o-gap-0_5 bg-inherit">
            <Mailbox t-if="this.store.self_user?.notification_type === 'inbox'" mailbox="this.store.inbox"/>
            <Mailbox mailbox="this.store.starred"/>
            <Mailbox t-if="this.store.self_user?.notification_type === 'inbox'" mailbox="this.store.history"/>
        </div>
    </t>

    <t t-name="mail.Mailbox">
        <Dropdown t-if="this.store.discuss.isSidebarCompact" state="this.floating" position="'right-middle'" menuClass="'o-mail-DiscussSidebar-floatingMenu px-2 mx-2 my-2 min-w-0 ' + this.store.discussDropdownMenuClass(this)" manual="true">
            <t t-call="mail.Mailbox.main"/>
            <t t-set-slot="content">
                <div class="overflow-hidden" t-ref="floating">
                    <span class="text-muted user-select-none" t-esc="this.mailbox.display_name"/>
                </div>
            </t>
        </Dropdown>
        <t t-else="" t-call="mail.Mailbox.main"/>
    </t>

    <t t-name="mail.Mailbox.main">
        <button
            class="o-mail-DiscussSidebar-item o-mail-Mailbox btn d-flex align-items-baseline px-0 o-mx-2_5 border-0 rounded fw-normal text-reset"
            t-att-class="{
                'bg-inherit': !this.mailbox.discussAppAsThread,
                'o-active': this.mailbox.discussAppAsThread,
                'justify-content-center position-relative o-compact py-2': this.store.discuss.isSidebarCompact,
                'o-py-0_5': !this.store.discuss.isSidebarCompact,
                'o-unread': this.mailbox.counter,
            }"
            style="line-height: 1.65;"
            t-att-data-mailbox-id="this.mailbox.id"
            t-on-click="(ev) => this.openThread(ev)"
            t-ref="root"
        >
            <ThreadIcon className="'bg-inherit opacity-75 justify-content-center ' + (this.store.discuss.isSidebarCompact ? '' : 'o-ms-1_5 me-2 pt-1')" thread="this.mailbox" size="this.store.discuss.isSidebarCompact ? 'large' : 'medium'"/>
            <t t-if="!this.store.discuss.isSidebarCompact">
                <div class="me-2 text-truncate small opacity-75 opacity-100-hover" t-esc="this.mailbox.display_name"/>
                <div t-attf-class="flex-grow-1 {{ this.mailbox.counter === 0 ? 'me-3': '' }}"/>
            </t>
            <t t-if="this.mailbox.counter > 0" t-call="mail.discuss_badge">
                <t t-set="counter" t-value="this.mailbox.counter"/>
                <t t-set="badgeClass" t-value="'o-mail-DiscussSidebar-badge ' + (this.store.discuss.isSidebarCompact ? 'position-absolute o-compact' : 'mx-1')"/>
                <t t-set="counterClass" t-value="(this.mailbox.id === 'starred' ? 'o-muted' : '')"/>
                <t t-set="floating" t-value="this.store.discuss.isSidebarCompact"/>
            </t>
        </button>
    </t>

</templates>
