<?xml version="1.0" encoding="UTF-8" ?>
<templates xml:space="preserve">

<t t-name="mail.composer" owl="1">
    <t t-set="compact" t-value="props.mode === 'compact'"/>
    <t t-set="normal" t-value="props.mode === 'normal'"/>
    <t t-set="extended" t-value="props.mode === 'extended'"/>
    <t t-set="messageToReplyTo" t-value="messaging.state.discuss.messageToReplyTo" />
    <div class="o-mail-composer-container" t-ref="composer">
        <div class="o-mail-composer d-grid flex-shrink-0"
                t-att-class="{
                    'px-3 py-2 o-mail-extended-composer': extended,
                    'p-3': normal,
                }">
            <div class="o-mail-composer-sidebar-main flex-shrink-0" t-if="!compact">
                <img class="o-mail-composer-avatar mt-1 rounded-circle" t-att-src="messaging.state.user.avatarUrl" alt="Avatar of user"/>
            </div>
            <div class="o-mail-composer-core-header text-truncate small p-2" t-if="hasReplyToHeader">
                <span class="cursor-pointer" t-on-click="() => props.highlightReplyTo and props.highlightReplyTo(messaging.state.discuss.messageToReplyTo.id)">
                    Replying to <b t-esc="messageToReplyTo.author.name"/>
                </span>
                <span t-if="thread and thread.type === 'mailbox'" class="o-mail-composer-origin-thread">
                    on: <b><t t-esc="messageToReplyTo.recordName"/></b>
                </span>
                <i t-if="!messageToReplyTo.needaction" class="fa fa-lg fa-times-circle rounded-circle p-0 ms-1 cursor-pointer" title="Stop replying" t-on-click="() => messaging.cancelReplyTo()"/>
            </div>
            <div class="o-mail-composer-core-main d-flex flex-nowrap flex-grow-1"
                t-att-class="{
                    'flex-column me-2': extended,
                    'border-end border-start border-bottom': compact,
                }"
            >
                <div class="position-relative flex-grow-1 align-self-stretch border-top"
                        t-att-class="{'rounder-start-3 border': !compact, 'border-end-0': !extended, 'border-bottom-0': extended}">
                    <textarea class="o-mail-composer-textarea form-control bg-view px-3 border-0 shadow-none overflow-auto" t-att-class="{'rounded-0 rounded-start-3': !compact }"
                        t-ref="textarea"
                        style="height:40px;"
                        t-on-keydown="onKeydown"
                        t-model="props.composer.textInputContent"
                        t-att-placeholder="placeholder"/>
                </div>
                <div class="d-flex py-1 border-top bg-view" t-att-class="{'border-bottom': normal, 'border': extended }">
                    <div class="d-flex align-items-center px-2" >
                        <button class="btn border-0 rounded-pill" t-ref="emoji-picker">
                            <i class="fa fa-smile-o" role="img" aria-label="Emojis"/>
                        </button>
                        <button class="btn fa fa-paperclip border-0 rounded-pill" title="Add attachment" aria-label="Add attachment" type="button"/>
                    </div>
                </div>
                <t t-if="!compact">
                    <t t-call="mail.Composer.actionButtons"/>
                </t>
            </div>
        </div>
        <t t-if="props.composer.messageId">
            <span class="text-muted">escape to <a href="#" t-on-click="props.onDiscardCallback">cancel</a>, enter to <a href="#" t-on-click="editMessage">save</a></span>
        </t>
    </div>
</t>

    <t t-name="mail.Composer.actionButtons" owl="1">
        <div class="d-flex">
            <button class="o-mail-composer-send-button btn btn-primary o-last border-start-0"
                t-att-class="{'mt-2': extended, 'rounded-0 rounded-end-3': !extended}"
                t-on-click="sendMessage"
                type="button"
                data-action="send"
                t-att-disabled="!props.composer.textInputContent"
            >
                Send
            </button>
        </div>
    </t>



</templates>
