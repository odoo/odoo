<?xml version="1.0" encoding="UTF-8" ?>
<templates xml:space="preserve">

<t t-name="mail.chatter" owl="1">
    <div class="o-mail-chatter h-100 d-flex flex-column" t-att-class="props.resId === false ? 'o-chatter-disabled' : ''" t-ref="root">
        <div class="o-mail-chatter-topbar d-flex flex-shrink-0 flex-grow-0 pe-2 mb-2">
            <button class="o-mail-chatter-topbar-send-message-button btn btn-odoo p-2 my-2 mx-3" t-att-class="{'btn-odoo': state.composing !== 'note'}" t-att-disabled="!props.resId" t-on-click="() => this.toggleComposer('message')">
                Send message
            </button>
            <button class="o-mail-chatter-topbar-log-note-button btn p-2 m-2" t-att-class="{'btn-odoo': state.composing === 'note'}" t-att-disabled="!props.resId" t-on-click="() => this.toggleComposer('note')">
                Log note
            </button>
            <div class="border-bottom border-start flex-grow-1 d-flex">
                <button t-if="props.hasActivity" class="o-mail-chatter-topbar-schedule-activity-button btn p-2 m-2" t-att-disabled="!props.resId" t-on-click="scheduleActivity">
                    <i class="fa fa-clock-o me-1"/>
                    Activities
                </button>
                <span class="flex-grow-1"/>
                <button class="o-mail-chatter-topbar-add-attachments btn px-2" t-att-disabled="!props.resId">
                    <i class="fa fa-paperclip fa-lg"/>
                </button>
                <Dropdown position="'bottom-end'" isDisabled="isDisabled" class="'o-mail-chatter-topbar-follower-list d-flex'" menuClass="'o-mail-chatter-topbar-follower-list-dropdown flex-column p-0'" menuDisplay="'d-flex'" title="followerButtonLabel" togglerClass="'o-mail-chatter-topbar-follower-list-button btn btn-light px-2'">
                    <t t-set-slot="toggler">
                        <i class="fa fa-user-o" role="img"/>
                        <span class="o-mail-chatter-topbar-followers-count ps-1" t-esc="state.followers.length"/>
                    </t>
                    <t t-set-slot="default">
                        <t t-if="this.props.resModel !== 'mail.channel' and thread.hasWriteAccess">
                            <a class="o-mail-chatter-topbar-follower-list-add-follower dropdown-item" href="#" role="menuitem" t-on-click.prevent="onClickAddFollowers">
                                Add Followers
                            </a>
                            <div t-if="state.followers.length > 0" role="separator" class="dropdown-divider"/>
                        </t>
                        <t t-if="state.followers.length > 0">
                            <div t-foreach="state.followers" t-as="follower" t-key="follower.id" class="dropdown-item o-mail-chatter-topbar-follower-list-follower" t-esc="follower.name"/>
                            <!-- <FollowerView
                                t-foreach="followerViews" t-as="followerView" t-key="followerView.localId"
                                className="'o_FollowerMenu_follower dropdown-item'"
                                record="followerView"
                            /> -->
                        </t>
                        <div t-elif="!thread.hasWriteAccess" class="o-mail-chatter-topbar-follower-list-no-followers dropdown-item disabled">
                            No Followers
                        </div>
                    </t>
                </Dropdown>
                <button t-if="isFollower" class="o-mail-chatter-topbar-unfollow btn px-0" t-att-class="{ 'text-success': !unfollowHover.isHover, 'text-warning': unfollowHover.isHover }" t-att-disabled="!props.resId" t-on-click="onClickUnfollow" t-ref="unfollow">
                    <div class="position-relative">
                        <!-- Hidden element used to set the button maximum size -->
                        <span class="invisible">
                            <i class="fa fa-fw fa fa-eye-slash"/> <t t-out="followingText.length > unfollowText.length ? followingText : unfollowText"/>
                        </span>
                        <span t-if="unfollowHover.isHover" class="o-mail-chatter-topbar-unfollow-text position-absolute end-0 top-0 bottom-0">
                            <i class="fa fa-fw fa-times"/> <span t-out="unfollowText"/>
                        </span>
                        <span t-if="!unfollowHover.isHover" class="o-mail-chatter-topbar-unfollow-text d-block position-absolute end-0 top-0 bottom-0">
                            <i class="fa fa-fw fa-check"/> <span t-out="followingText"/>
                        </span>
                    </div>
                </button>
                <button t-if="!isFollower" class="o-mail-chatter-topbar-follow btn btn-link text-600" t-on-click="onClickFollow">Follow</button>
            </div>
        </div>
        <t t-if="state.composing">
            <t t-if="state.composing === 'message'">
                <small class="px-3 pb-1 pt-2" style="margin-left:48px;"><em class="text-muted">To followers of:</em> <b class="px-1">"<t t-esc="props.displayName"/>"</b></small>
            </t>
            <t t-set="placeholder" t-value="state.composing === 'message' ? 'Send a message to followers...' : 'Log an internal note...'"/>
            <t t-set="type" t-value="state.composing === 'message' ? 'message' : 'note'"/>
            <Composer composer="thread.composer" autofocus="true" mode="'extended'" onPostCallback.bind="toggleComposer" placeholder="placeholder" type="type"/>
            <hr/>
        </t>
        <div class="overflow-auto">
            <t t-if="props.hasActivity and state.activities.length">
                <ActivityList activities="state.activities"/>
            </t>
            <Thread id="thread.id" t-key="thread.id" order="'desc'"/>
        </div>
    </div>


</t>

</templates>
