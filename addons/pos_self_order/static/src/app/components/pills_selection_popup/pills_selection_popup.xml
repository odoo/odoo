<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">
    <t t-name="pos_self_order.PillsSelectionPopup">
        <Dialog header="false"
            contentClass="'w-100 m-0 position-absolute self_order_pills_selection_popup_dialog'"
            bodyClass="'p-4 pb-3 m-0'"
            title="this.props.title">
            <div class="self_order_pills_selection_popup w-100 flex-column d-flex">
                <div class="d-flex justify-content-between align-items-start mb-2">
                    <div>
                        <h3 t-esc="this.props.title" class="mb-0 pb-0" />
                        <span t-esc="this.props.subtitle" />
                    </div>
                    <button class="btn btn-close" t-on-click="this.props.close"/>
                </div>
                <div t-ref="category-list" class="d-flex w-100 gap-1 mt-2 flex-nowrap overflow-x-auto no-scrollbar pb-2 flex-shrink-0">
                    <button class="btn py-3 d-flex flex-column align-items-center text-center text-nowrap"
                        t-foreach="this.categories" t-as="category" t-key="category.id"
                        t-on-click="(ev) => this.onClickScrollTracked(ev, category.id)"
                        t-att-class="{
                            'btn-primary': this.state.selectedCategoryId === category.id,
                            'btn-secondary': this.state.selectedCategoryId !== category.id
                        }">
                        <span class="fw-bold" t-esc="this.getCategoryDisplayName(category)" />
                    </button>
                </div>
                <div class="w-100 overflow-x-hidden">
                    <div t-foreach="this.getSelectedCategorySubCategories" t-as="subCateg" t-key="subCateg.id" class="mt-3 w-100">
                        <h5 t-if="subCateg.name" t-esc="subCateg.name" />
                        <t t-set="options" t-value="subCateg.options" />
                        <div class="container-fluid mt-2 mx-auto px-0 overflow-x-hidden no-scrollbar">
                            <div class="row gx-1 gy-1 w-100">
                                <div class="col-4 col-sm-3 col-md-2" t-foreach="options" t-as="option" t-key="option.id">
                                    <button class="option-item btn btn-secondary btn-sm w-100 py-2 fw-bold"
                                        t-esc="option.name"
                                        t-on-click="() => this.selectOption(option.id)"
                                        t-att-class="{
                                            'border border-primary': this.state.selectedOptionId === option.id,
                                        }" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="w-100 d-flex mt-3 me-1">
                    <button class="btn btn-secondary flex-grow-1 me-1"
                        t-on-click="this.props.close">
                        Cancel
                    </button>
                    <button class="btn btn-primary flex-grow-1"
                        t-on-click="this.confirmSelection"
                        t-att-disabled="!this.state.selectedOptionId">
                        Confirm
                    </button>
                </div>
            </div>
        </Dialog>
    </t>
</templates>
