<?xml version="1.0" encoding="utf-8"?>
<odoo>

<!-- Snippet - Country Events - Placeholder -->
<template id="s_country_events" name="Country Events">
    <div t-attf-class="s_country_events_list oe_country_events #{_classes}">
        <div class="country_events_list">
            <h6 class="o_wevent_sidebar_title">
                <i class="fa fa-globe mr-2"/>Upcoming Events
            </h6>
        </div>
    </div>
</template>

<!-- Snippet - Country Events - List -->
<template id="country_events_list" name="Country Events List">
    <div class="country_events_list">
        <t t-if="events">
            <h6 class="o_wevent_sidebar_title">
                <t t-if="country">
                    <i class="fa fa-flag mr-2"/>Events: <span t-esc="country.name"/>
                    <img class="img-fluid" t-att-src="website.image_url(country, 'image')" alt=""/>
                </t>
                <t t-else="">
                    <i class="fa fa-globe mr-2"/>Upcoming Events
                </t>
            </h6>
            <ul class="list-group mb-3">
                <li t-foreach="events[:5]" t-as="event_dict" class="list-group-item d-flex justify-content-between">
                    <a t-att-href="event_dict['url']">
                        <i t-if="not event_dict['event'].website_published" class="fa fa-ban text-danger mr-1" role="img" aria-label="Unpublished" title="Unpublished"/>
                        <span t-esc="event_dict['event'].name" t-attf-class="#{(not event_dict['event'].website_published) and 'text-danger' or ''}"/>
                    </a>
                    <span t-esc="event_dict['date']"/>
                </li>
            </ul>
            <div t-if="len(events) &gt; 5">
                <t t-if="country">
                    <a t-attf-href="/event?country=#{country.id}" class="small"><b>See all events from <span t-esc="country.name"/></b></a>
                </t>
                <t t-else="">
                    <a href="/event" class="small"><b>View all</b></a>
                </t>
            </div>
        </t>
    </div>
</template>

<!-- Snippet - Event dates -->
<template id="event_dates" name="Event Dates">
    <div class="o_website_event_dates p-1" t-if="event">
        <h6 class="o_wevent_sidebar_title">Date &amp; Time</h6>
        <div class="d-flex">
            <h5 t-field="event.with_context(tz=event.date_tz).date_begin" class="my-1 mr-1" t-options="{'date_only': 'true', 'format': 'full'}"/>
        </div>
        <t t-if="not event.is_one_day">Start -</t>
        <span t-field="event.with_context(tz=event.date_tz).date_begin" t-options="{'time_only': 'true', 'format': 'short'}"/>
        <t t-if="event.is_one_day">
            <i class="fa fa-long-arrow-right mx-1"/>
            <span t-field="event.with_context(tz=event.date_tz).date_end" t-options="{'time_only': 'true', 'format': 'short'}"/>
        </t>
        <t t-else="">
            <i class="fa fa-long-arrow-down d-block text-muted mx-3 my-2" style="font-size: 1.5rem"/>
            <div class="d-flex">
                <h5 t-field="event.with_context(tz=event.date_tz).date_end" class="my-1 mr-1" t-options="{'date_only': 'true', 'format': 'full'}"/>
            </div>
            <t t-if="not event.is_one_day">End -</t>
            <span t-field="event.with_context(tz=event.date_tz).date_end" t-options="{'time_only': 'true', 'format': 'short'}"/>
        </t>
        <small t-field="event.date_tz" class="d-block my-3 text-muted"/>
        <!-- Used to store the timestamp of the dates and to save the new values (need a different DOM element because we use the timestamp) -->
        <div class="o_website_event_date_begin d-none" t-field="event.date_begin" t-att-data-timestamp="event.date_begin.timestamp()"/>
        <div class="o_website_event_date_end d-none"   t-field="event.date_end"   t-att-data-timestamp="event.date_end.timestamp()"/>
    </div>
</template>

<!-- Snippets and options -->
<template id="snippets" inherit_id="website.snippets">
    <xpath expr="//t[@id='event_local_events_hook']" position="replace">
        <t t-snippet="website_event.s_country_events" t-thumbnail="/website_event/static/src/img/snippets_thumbs/s_country_events.png"/>
    </xpath>
    <xpath expr="//t[@id='event_speaker_bio_hook']" position="replace">
        <t t-snippet="website_event.s_speaker_bio" t-thumbnail="/website_event/static/src/img/snippets_thumbs/s_speaker_bio.png"/>
    </xpath>
</template>

<template id="snippet_options" inherit_id="website.snippet_options">
    <xpath expr="//*[@t-set='so_content_addition_selector']" position="inside">, .oe_country_events, .s_speaker_bio</xpath>
    <xpath expr="." position="inside">
        <div data-js="s_website_event_dates" data-selector=".o_website_event_dates" data-no-check="true">
            <h4>Event</h4>
            <we-datetimepicker string="Start Date" data-select-data-attribute="" data-attribute-name="startDate"/>
            <we-datetimepicker string="End Date" data-select-data-attribute=""   data-attribute-name="endDate"/>
            <we-select string="Timezone" data-attribute-name="timezone">
                <we-button t-foreach="env['event.event']._event_tz_get()" t-as="timezone" t-att-data-select-data-attribute="timezone[0]" t-esc="timezone[1]"/>
            </we-select>
        </div>
    </xpath>
</template>

<!-- Snippet - Speaker Bio -->
<template id="s_speaker_bio" name="Speaker Bio">
    <div class="s_speaker_bio" itemscope="itemscope" itemtype="http://schema.org/Person" itemprop="performer">
        <span class="badge badge-secondary text-uppercase o_wevent_badge">Speaker</span>
        <img src="/website_event/static/src/img/speaker.png" width="70" class="img-fluid rounded-circle float-left mr-3" alt=""/>
        <div class="overflow-hidden">
            <h4 class="mt-3 mb-1" itemprop="name">John DOE</h4>
            <h6 class="mb-4">Company</h6>
            <p>At just 13 years old, John DOE was already starting to develop his first business applications for customers. After mastering civil engineering, he founded TinyERP. This was the first phase of OpenERP which would later became Odoo, the most installed open-source business software worldwide.</p>
        </div>
    </div>
</template>

</odoo>
