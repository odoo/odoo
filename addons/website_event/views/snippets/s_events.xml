<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
<!-- Snippet -->
<template id="s_events" name="Events">
    <t t-call="website.s_dynamic_snippet_template">
        <t t-set="snippet_name" t-value="'s_events'"/>
        <t t-set="snippet_classes" t-value="'s_event_upcoming_snippet %s' % snippet_extra_classes"/>
        <t t-set="main_page_url" t-value="'/event'"/>
        <t t-set="custom_template_data" t-valuef='{"events_event_time_active":true, "events_event_location_active":true}'/>
        <t t-out="0"/>
    </t>
</template>
<!-- Multi record snippets -->
<template id="s_events_picture" name="Events Picture">
    <t t-set="snippet_extra_classes" t-value="'s_event_event_picture'"/>
    <t t-call="website_event.s_events">
        <t t-call="website_event.s_event_upcoming_snippet_preview_data"/>
    </t>
</template>
<template id="s_events_card" name="Events Card">
    <t t-set="snippet_extra_classes" t-value="'s_event_event_card'"/>
    <t t-call="website_event.s_events">
        <t t-call="website_event.s_event_upcoming_snippet_card_preview_data"/>
    </t>
</template>
<!-- Single record snippets -->
<template id="s_events_single_offset" name="Single Event Offset">
    <t t-set="is_single_record" t-value="True"/>
    <t t-set="snippet_extra_classes" t-value="'s_event_event_single_offset'"/>
    <t t-set="content_classes" t-value="'o_cc o_cc5 bg-transparent'"/>
    <t t-call="website_event.s_events">
        <t t-call="website_event.s_dynamic_snippet_events_single_offset_preview_data"/>
    </t>
</template>
<template id="s_events_single_entry" name="Single Event Entry">
    <t t-set="is_single_record" t-value="True"/>
    <t t-set="snippet_extra_classes" t-value="'s_event_event_single_entry'"/>
    <t t-set="content_classes" t-value="'o_cc o_cc5 bg-transparent'"/>
    <t t-call="website_event.s_events">
        <t t-call="website_event.s_dynamic_snippet_events_single_entry_preview_data"/>
    </t>
</template>
<template id="s_events_single_card" name="Single Event Card">
    <t t-set="is_single_record" t-value="True"/>
    <t t-set="snippet_extra_classes" t-value="'s_event_event_single_card'"/>
    <t t-call="website_event.s_events">
        <t t-call="website_event.s_dynamic_snippet_events_single_card_preview_data"/>
    </t>
</template>
<template id="s_events_single_badge" name="Single Event Badge">
    <t t-set="is_single_record" t-value="True"/>
    <t t-set="snippet_extra_classes" t-value="'s_event_event_single_badge'"/>
    <t t-call="website_event.s_events">
        <t t-call="website_event.s_dynamic_snippet_events_single_badge_preview_data"/>
    </t>
</template>
<template id="s_events_single_aside" name="Single Event Aside">
    <t t-set="is_single_record" t-value="True"/>
    <t t-set="snippet_extra_classes" t-value="'s_event_event_single_aside'"/>
    <t t-call="website_event.s_events">
        <t t-call="website_event.s_dynamic_snippet_events_single_aside_preview_data"/>
    </t>
</template>

<!-- Multi record templates-->
<!-- Picture Layout -->
<template id="dynamic_filter_template_event_event_picture" name="Picture Layout" priority="5">
    <div t-foreach="records" t-as="data" class="s_events_event w-100" data-extra-classes="g-3" data-column-classes="col-12 col-sm-6 col-lg-4">
        <t t-set="record" t-value="data['_record']._set_tz_context()"/>
        <a class="s_events_event_cover position-relative d-flex align-items-center rounded overflow-hidden text-decoration-none ratio ratio-1x1"
           t-att-href="data['call_to_action_url']">
            <t t-call="website.record_cover">
                <t t-set="_record" t-value="record"/>
                <t t-set="_resize_height" t-value="512"/>
                <t t-set="_resize_width" t-value="512"/>
                <t t-set="use_filters" t-value="True"/>
                <t t-set="additionnal_classes" t-value="'h-100 w-100 bg-600 position-absolute'"/>
            </t>

            <div class="text-center w-100 h-100 px-3 d-flex flex-column justify-content-center flex-grow-1">
                <div t-if="is_sample" class="h5 o_ribbon_right bg-primary text-uppercase">Sample</div>
                <h3 class="text-white" t-field="record.name"/>
                <time t-att-datetime="record.date_begin" class="text-white text-center">
                    <span t-out="record.date_begin"
                          t-options="{'widget': 'datetime', 'date_only': 'true', 'format': 'long', 'tz_name': record.date_tz}"/>
                    <span t-if="events_event_time_active" class="s_events_event_time">
                        - <span t-out="record.date_begin" t-options="{'widget': 'datetime', 'time_only': 'true', 'format': 'short', 'tz_name': record.date_tz}"/>
                        (<span t-out="record.date_tz.replace('_', ' ')"/>)
                    </span>
                    <div class="d-flex justify-content-center" t-if="events_event_location_active" t-field="record.address_id" t-options="{'widget': 'contact', 'fields': ['city'], 'no_marker': 'true'}"/>
                </time>
            </div>
        </a>
    </div>
</template>
<!-- Card Layout -->
<template id="dynamic_filter_template_event_event_card" name="Card Layout" priority="10">
    <t t-foreach="records" t-as="data" data-extra-classes="g-3" data-column-classes="col-12 col-sm-6 col-lg-4 col-xxl-3">
        <t t-set="record" t-value="data['_record']._set_tz_context()"/>
        <a t-att-href="data['call_to_action_url']" class="s_events_event card h-100 text-decoration-none">
            <div class="s_events_event_cover">
                <t t-call="website.record_cover">
                    <t t-set="_record" t-value="record"/>
                    <t t-set="_resize_height" t-value="512"/>
                    <t t-set="_resize_width" t-value="512"/>

                    <div class="s_events_event_date position-absolute bg-white shadow-sm text-dark">
                        <span t-field="record.date_begin" t-options="{'format': 'LLL', 'tz_name': record.date_tz}"
                            class="s_events_event_month fw-bold text-uppercase"/>
                        <span t-field="record.date_begin" t-options="{'format': 'dd', 'tz_name': record.date_tz}"
                            class="s_events_event_day fw-light lh-1"/>
                    </div>
                </t>
            </div>
            <div class="card-body d-flex flex-column gap-2 justify-content-between">
                <div t-if="is_sample" class="h5 o_ribbon_right bg-primary text-uppercase">Sample</div>
                <div>
                    <div t-if="events_event_time_active" class="s_events_event_time mb-1 small fw-bold">
                        <span t-out="record.date_begin" t-options="{'widget': 'datetime', 'time_only': 'true', 'format': 'short', 'tz_name': record.date_tz}"/>
                        (<span t-out="record.date_tz.replace('_', ' ')"/>)
                    </div>
                    <h5 class="text-truncate" t-field="record.name"/>
                    <small class="text-muted" t-field="record.subtitle"/>
                </div>
                <div class="mt-2 fw-bold" t-if="events_event_location_active" t-field="record.address_id" t-options="{'widget': 'contact', 'fields': ['city'], 'no_marker': 'true'}"/>
            </div>
        </a>
    </t>
</template>

<!-- Single record templates -->
<!-- Offset Layout -->
<template id="dynamic_filter_template_event_event_single_offset" name="Solo Offset">
    <t t-if="len(records)" class="s_events_event" data-column-classes="col-lg-12" data-content-classes="o_cc o_cc5 bg-transparent">
        <t t-set="data" t-value="records[0]"/>
        <t t-set="record" t-value="data['_record']"/>
        <t t-set="bg" t-value="record._get_background()"/>
        <div t-if="is_sample" class="position-absolute bottom-0 end-0 px-4 py-2 text-bg-info rounded-pill">Sample</div>
        <div class="w-100 rounded" t-att-style="'background-image: ' + bg + '; background-size: cover; background-position: center;'">
            <div class="position-absolute w-100 h-100 rounded bg-black-50"/>
            <div class="position-relative p-4 p-lg-5">
                <div class="py-lg-5">
                    <h2 t-field="record.name"/>
                    <p class="lead" t-field="record.subtitle"/>
                </div>
                <div class="o_cc o_cc5 position-lg-absolute top-100 start-50 w-100 d-flex flex-wrap gap-4 w-xl-75 mt-3 mt-lg-0 mx-0 px-4 py-4 py-lg-3 rounded">
                    <div t-if="events_event_time_active" class="me-lg-5 order-1 order-lg-0">
                        <p class="mb-2 fw-bold">Time</p>
                        <span>
                            <i class="fa fa-clock-o me-2" role="img"/>
                            <span t-out="record.date_begin" t-options="{'widget': 'datetime', 'time_only': 'true', 'format': 'short', 'tz_name': record.date_tz}"/>
                        </span>
                    </div>
                    <div t-if="events_event_location_active" class="order-1 order-lg-0">
                        <p class="mb-2 fw-bold">Location</p>
                        <div class="d-flex align-items-center">
                            <i class="fa fa-map-marker me-2" role="img"/>
                            <span t-field="record.address_id" t-options="{'widget': 'contact', 'fields': ['city'], 'no_marker': 'true', 'null_text': 'Online event'}"/>
                        </div>
                    </div>
                    <div class="d-flex flex-wrap align-items-center justify-content-lg-end w-100 w-lg-auto ms-lg-auto order-0">
                        <p class="h4-fs mb-0 me-3" t-out="record.date_begin" t-options="{'widget': 'datetime', 'date_only': 'true', 'format': 'long', 'tz_name': record.date_tz}"/>
                        <div class="d-none d-lg-block ps-3 border-start">
                            <a t-att-href="data['call_to_action_url']" t-att-title="'Read ' + data['name']" class="btn btn-primary">Register</a>
                        </div>
                    </div>
                    <a t-att-href="data['call_to_action_url']" t-att-title="'Read ' + data['name']" class="d-lg-none btn btn-primary w-100 mt-3 order-1">Register</a>
                </div>
            </div>
        </div>
    </t>
</template>
<!-- Entry Layout -->
<template id="dynamic_filter_template_event_event_single_entry" name="Solo Entry">
    <t t-if="len(records)" class="s_events_event" data-column-classes="col-lg-12" data-content-classes="o_cc o_cc5 bg-transparent">
        <t t-set="data" t-value="records[0]"/>
        <t t-set="record" t-value="data['_record']"/>
        <t t-set="bg" t-value="record._get_background()"/>
        <div t-if="is_sample" class="position-absolute bottom-0 end-0 px-4 py-2 text-bg-info rounded-pill">Sample</div>
        <div class="w-100 rounded" t-att-style="'background-image: ' + bg + '; background-size: cover; background-position: center;'">
            <div class="position-absolute w-100 h-100 rounded bg-black-50"/>
            <div class="position-relative d-flex flex-column gap-5 w-100 h-100 p-4 p-lg-5">
                <div class="d-flex flex-column flex-lg-row gap-lg-5">
                    <div class="flex-grow-1 order-1 order-lg-0">
                        <h2 t-field="record.name"/>
                        <p class="lead" t-field="record.subtitle"/>
                    </div>
                    <p class="h3-fs text-end">
                        <span class="" t-out="record.date_begin" t-options="{'widget': 'datetime', 'date_only': 'true', 'format': 'long', 'tz_name': record.date_tz}"/>
                        <span class="text-nowrap" t-if="events_event_time_active">at <span t-out="record.date_begin" t-options="{'widget': 'datetime', 'time_only': 'true', 'format': 'short', 'tz_name': record.date_tz}"/></span>
                    </p>
                </div>
                <div class="d-flex flex-column flex-md-row align-items-md-center gap-3 gap-md-5">
                    <div class="flex-grow-1 order-1 order-md-0">
                        <a t-att-href="data['call_to_action_url']" t-att-title="'Read ' + data['name']" class="btn btn-lg btn-primary w-100 w-lg-auto text-nowrap">Register Now</a>
                    </div>
                    <div t-if="events_event_location_active" class="d-flex align-items-center fs-5">
                        <i class="fa fa-map-marker me-2" role="img"/>
                        <span t-field="record.address_id" t-options="{'widget': 'contact', 'fields': ['city'], 'no_marker': 'true', 'null_text': 'Online event'}"/>
                    </div>
                </div>
            </div>
        </div>
    </t>
</template>
<!-- Card Layout -->
<template id="dynamic_filter_template_event_event_single_card" name="Solo Card">
</template>
<!-- CTA Badge Layout -->
<template id="dynamic_filter_template_event_event_single_badge" name="Solo Badge">
</template>
<!-- Aside Layout -->
<template id="dynamic_filter_template_event_event_single_aside" name="Solo Aside">
</template>

<!--SNIPPET OPTIONS -->

<template id="s_events_options" inherit_id="website.snippet_options">
    <xpath expr="." position="inside">
        <t t-call="website_event.s_dynamic_snippet_options_template">
            <t t-set="snippet_name" t-value="'event_upcoming_snippet'"/>
            <t t-set="snippet_selector" t-value="'.s_event_upcoming_snippet'"/>
        </t>
    </xpath>
</template>

<template id="s_dynamic_snippet_options_template" inherit_id="website.s_dynamic_snippet_options_template">
    <xpath expr="//we-select[@data-name='filter_opt']" position="after">
        <we-many2many t-if="snippet_name == 'event_upcoming_snippet'"
                      string="Event Tags"
                      data-name="event_tag_opt"
                      data-model="event.tag"
                      data-fakem2m="true"
                      data-domain='[["category_id.website_published", "=", true], ["color", "not in", ["0", false]]]'
                      data-limit="10"
                      data-attribute-name="filterByTagIds"
                      data-fields="[&quot;category_id&quot;]"
                      data-select-data-attribute=""
                      data-no-preview="true"/>
    </xpath>
    <xpath expr="//we-select[@data-name='template_opt']" position="after">
        <we-checkbox t-if="snippet_name == 'event_upcoming_snippet'"
            data-name="time_opt"
            string="Show time"
            data-no-preview="true"
            data-customize-template-key="events_event_time_active"
            data-customize-template-values="false|true"/>
    </xpath>
</template>

<!--ASSETS-->

<record id="website_event.s_events_000_scss" model="ir.asset">
    <field name="name">Event 000 SCSS</field>
    <field name="bundle">web.assets_frontend</field>
    <field name="path">website_event/static/src/snippets/s_events/000.scss</field>
</record>

</odoo>
