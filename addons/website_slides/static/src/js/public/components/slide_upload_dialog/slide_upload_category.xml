<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="website_slides.SlideUploadCategory" owl="1">
        <div>
            <div t-if="this.state.alert.show" t-attf-class="alert {{this.state.alert.class}}"
                role="alert" t-out="this.state.alert.message" />
            <form
                id="o_w_slide_upload_category_form"
                t-att-class="{'clearfix': true, 'was-validated': this.state.form.wasValidated}"
                t-on-submit.prevent="(ev) => ev.preventDefault()"
            >
                <div class="row">
                    <!-- Left column: slide upload form -->
                    <div class="col-md-6">
                        <SlideUploadSourceTypes
                            t-if="this.props.slideCategory in this.sourceSettings"
                            attributes="this.sourceSettings[this.props.slideCategory]"
                            isLocalSource="this.state.form.isLocalSource"
                            onClickSourceType.bind="this.onClickSourceType"
                            onChangeFileInput.bind="this.onChangeFileInput"
                            onChangeUrl.bind="this.onChangeUrl"
                        />
                        <canvas id="data_canvas" class="d-none"/>
                        <t t-call="website_slides.UploadFormCommonInputs"/>
                    </div>
                    <!-- Right column: preview and tutorial -->
                    <div class="col-md-6">
                        <div class="img-thumbnail h-100">
                            <div
                                t-if="this.state.preview.show"
                                class="o_slide_preview h-100 flex-column justify-content-center"
                            >
                                <img
                                    referrerPolicy="no-referrer"
                                    t-att-src="this.state.form.slideImage"
                                    id="slide-image"
                                    title="Content Preview"
                                    alt="Content Preview"
                                    class="img-fluid"
                                />
                                <div
                                    t-att-class="{'d-none': this.state.preview.hideSlideVideoTitle, 'mt-1': true}"
                                    t-out="this.state.preview.videoTitle"
                                />
                            </div>
                            <div t-else="" class="p-3">
                                <t t-slot="tutorial"/>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <t t-if="this.state.form.isLoading" t-call="website_slides.UploadDialogLoading"/>
        <t t-call="website_slides.UploadBtns"/>
    </t>

    <!-- Slide Upload Category common part templates -->

    <t t-name="website_slides.UploadBtns">
        <div t-portal="'#o_w_slide_upload_btns'">
            <button
                t-if="this.props.canPublish"
                class="btn btn-primary o_w_slide_upload_published"
                t-on-click="() => this.onClickFormSubmit(true)"
            >
                <span>Save and Publish</span>
            </button>
            <button
                t-if="this.props.canUpload"
                t-att-class="{ 'btn': true, 'btn-primary': !this.props.canPublish }"
                t-on-click="() => this.onClickFormSubmit(false)"
            >
                <span>Save</span>
            </button>
        </div>
    </t>

    <t t-name="website_slides.UploadFormCommonInputs">
        <div class="mb-3">
            <label for="name" class="col-form-label">Title</label>
            <input
                t-model="this.state.form.slideName"
                id="name"
                name="name"
                placeholder="Title"
                class="form-control"
                required="required"
                autocomplete="off"
            />
        </div>
        <div t-if="!this.state.defaultCategoryID" class="mb-3">
            <label for="category_id" class="col-form-label">Section</label>
            <SelectMenu
                togglerClass="'form-control form-select'"
                choices="this.state.choices.categories"
                value="this.state.choices.categoryId"
                onSelect.bind="this.onCategorySelect"
                placeholder.translate="Select or create a category"
            >
                <t t-set-slot="bottomArea" t-slot-scope="select">
                    <DropdownItem
                            t-if="this.select.data.searchValue and !this.choiceExists(this.select.data.searchValue, this.select.data.choices)"
                            class="'btn text-primary'"
                            onSelected="() => this.onClickCreateCategoryBtn(select.data.searchValue)"
                        >
                            Create New Category "<i t-out="this.select.data.searchValue"/>"
                    </DropdownItem>
                </t>
            </SelectMenu>
        </div>
        <div class="mb-3">
            <label for="tag_ids" class="col-form-label">Tags</label>
            <SelectMenu
                togglerClass="'form-control form-select'"
                choices="this.state.choices.tags"
                multiSelect="true"
                value="this.state.choices.tagIds"
                onSelect.bind="this.onTagsSelect"
                placeholder.translate="Select or create tags"
            >
                <t t-set-slot="bottomArea" t-slot-scope="select">
                    <DropdownItem
                            t-if="this.select.data.searchValue and !this.choiceExists(this.select.data.searchValue, this.select.data.choices)"
                            class="'btn text-primary'"
                            onSelected="() => this.onClickCreateTagBtn(select.data.searchValue)"
                        >
                            Create New Tag "<i t-out="this.select.data.searchValue"/>"
                    </DropdownItem>
                </t>
            </SelectMenu>
        </div>
        <div class="mb-3">
            <label for="duration" class="col-form-label">Estimated Completion Time</label>
            <div class="input-group">
                <input
                    t-model="this.state.form.duration"
                    type="number"
                    id="duration"
                    min="0"
                    name="duration"
                    placeholder='e.g. "15"'
                    class="form-control"
                    autocomplete="off"
                />
                <span class="input-group-text">Minutes</span>
            </div>
        </div>
    </t>

    <t t-name="website_slides.UploadDialogLoading">
        <div
            t-portal="'.o_w_slide_upload_dialog_content'"
            class="o_wslides_slide_upload_loading position-absolute h-100 w-100 text-center d-flex flex-column justify-content-center"
        >
            <h2 class="text-white">
                <span class="fa fa-circle-o-notch fa-spin"/>
                <span>Loading content...</span>
            </h2>
        </div>
    </t>

</templates>
