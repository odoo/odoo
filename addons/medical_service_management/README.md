# 醫療聯絡人管理基礎模組

## 模組概述

本模組為醫療行業專用的聯絡人管理基礎模組，基於 Odoo 18.0 Community Edition 開發。採用獨立運作設計，可單獨使用，也可搭配 Field Service 等擴展模組實現完整的醫療設備服務管理功能。

## 主要功能

### 🏢 客戶公司管理
- 企業客戶專用財務資訊（統一編號、收款資訊等）
- 預留設備和工單系統整合擴展點
- 完整的統計資訊和快捷操作
- 支援台灣本地化需求（統一編號驗證、銀行選項等）

### 🏛️ 公司部門管理
- 階層式部門架構
- 完整的聯絡資訊和地址管理
- 支援多層級組織結構

### 👥 聯絡人管理
- 彈性關聯設計（公司/部門可選填但有邏輯驗證）
- 通訊偏好和多語言支援
- 分類標籤和服務記錄追蹤

## 技術特色

- **獨立運作**：無需額外依賴，可單獨安裝使用
- **擴展設計**：完整的擴展點（Extension Points）架構
- **繼承機制**：使用 Odoo 標準的模型繼承，不修改核心程式碼
- **彈性設計**：支援各種業務情境的資料關聯
- **完整驗證**：包含資料一致性和格式驗證
- **視覺化介面**：提供 Tree、Form、Kanban 等多種視圖
- **權限控制**：細緻的使用者權限管理
- **模組化架構**：為未來功能擴展預留完整介面

## 安裝需求

### 系統需求
- Odoo Community Edition 18.0
- Python 3.10+
- PostgreSQL 12+

### 基礎依賴（最小化）
- `base` - Odoo 核心模組
- `contacts` - 聯絡人管理
- `mail` - 郵件整合

### 可選擴展模組
- `fieldservice` - 設備服務管理擴展
- `base_territory` - 地區管理（台灣地區預設）

## 安裝步驟

1. **確認系統環境**
   ```bash
   # 確認 Odoo 18.0 正常運作
   ./odoo-bin --version
   ```

2. **模組已在正確位置**
   ```bash
   # 檢查模組檔案
   ls D:\odoo_commuity\addons\medical_service_management\
   ```

3. **更新模組清單**
   - 啟動 Odoo 服務器
   - 啟用開發者模式
   - 進入應用程式選單 → 更新應用程式清單

4. **安裝模組**
   - 在應用程式中搜尋「醫療聯絡人管理基礎模組」
   - 點選「安裝」
   - 系統會自動安裝基礎依賴模組

## 快速開始

### 1. 建立客戶公司
1. 進入「聯絡人」應用程式
2. 建立新公司（勾選「是公司」）
3. 填寫基本資訊和統一編號
4. 設定付款方式和收款資訊

### 2. 建立部門結構
1. 進入「醫療聯絡人管理 > 公司部門」
2. 為客戶公司建立部門層級
3. 設定部門聯絡資訊和地址
4. 可建立多層級的部門架構

### 3. 管理聯絡人
1. 進入「醫療聯絡人管理 > 聯絡人」
2. 新增聯絡人並設定歸屬關係
3. 設定通訊偏好和分類標籤
4. 系統會自動驗證關聯的一致性

### 4. 檢視統計資訊
1. 在客戶公司表單中查看統計按鈕
2. 點擊「部門」、「聯絡人」統計查看詳細資料
3. 「設備」統計會顯示擴展提示（如未安裝擴展模組）

## 示範資料

模組包含完整的示範資料：
- **台北榮民總醫院**：主要示範客戶
- **完整部門架構**：醫療部、行政部及其子部門
- **多樣化聯絡人**：涵蓋各種職位和聯絡偏好

## 資料模型

### res.partner (擴展)
- `x_tax_id`: 統一編號
- `x_payment_*`: 付款相關欄位
- `x_department_count`: 部門統計
- `x_contact_count`: 聯絡人統計
- `x_equipment_count`: 設備統計

### company.department
- 階層式部門結構
- 完整地址和聯絡資訊
- 與公司和聯絡人的關聯

### company.contact
- 彈性關聯設計
- 通訊偏好設定
- 分類標籤支援

## 權限設定

- **一般使用者**: 可讀取和編輯聯絡人資料
- **Field Service 管理員**: 完整的 CRUD 權限
- **入口網站使用者**: 唯讀權限

## 擴展架構

### 🔧 擴展點設計
本模組採用完整的擴展點（Extension Points）架構，所有需要擴展的功能都預留了標準介面：

#### 主要擴展點
- **設備統計**: `_get_equipment_count()`
- **服務統計**: `_get_service_order_count()`
- **功能檢查**: `_has_equipment_extension()`, `_has_service_extension()`
- **動作處理**: `_open_equipments_extended()`, `_open_service_orders_extended()`

#### 擴展介面
- **BaseExtensionMixin**: 統一的擴展基礎類別
- **ExtensionRegistry**: 擴展功能註冊表
- **模組檢測機制**: 自動檢測已安裝的擴展模組

### 🚀 規劃的擴展模組

#### 第一優先級
- **medical_equipment_service**: 設備管理擴展
  - 設備追蹤和歷史記錄
  - QR Code 整合
  - 保固管理

#### 第二優先級  
- **medical_service_order**: 服務工單擴展
  - 三種工單類型（保養/維修/日誌）
  - 技術人員派遣
  - 客戶簽名和 PDF 報表

#### 第三優先級
- **medical_maintenance_management**: 保養管理擴展
- **medical_repair_management**: 維修管理擴展
- **medical_inventory_integration**: 庫存整合擴展

### 📋 擴展開發指南
1. **繼承基礎模型**: 使用 `_inherit` 擴展現有模型
2. **實作擴展介面**: 繼承 `BaseExtensionMixin` 並實作相關方法
3. **註冊擴展功能**: 透過 `_register_hook()` 註冊功能
4. **測試整合**: 確保與基礎模組的相容性

## 技術支援

如有任何問題或建議，請聯繫開發團隊。

---

**版本**: 18.0.1.0.0  
**授權**: LGPL-3  
**開發**: Based on Odoo Community Association (OCA) Field Service