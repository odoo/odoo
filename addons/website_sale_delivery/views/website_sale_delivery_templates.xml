<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="cart_delivery" name="Delivery Costs" inherit_id="website_sale.total">
        <xpath expr="//div[@id='order_total_untaxed']" position="before">
            <div id="order_delivery" t-attf-class="row o_website_sale_order_delivery {{'' if website_sale_order and website_sale_order.has_delivery else 'hidden'}}">
                <span class="col-xs-6 text-right text-muted" title="Delivery will be updated after choosing a new delivery method"> Delivery:</span>
                <span class="col-xs-6 text-right-not-xs text-left-xs text-muted">
                    <span t-if="website_sale_order and website_sale_order.has_delivery" class="o_website_sale_amount_delivery text-nowrap" t-field="website_sale_order.amount_delivery" t-options='{"widget": "monetary", "display_currency": website_sale_order.currency_id}'/>
                    <span t-else="" class="o_website_sale_amount_delivery text-nowrap" t-esc="0.00" t-options='{"widget": "monetary", "display_currency": website_sale_order.currency_id}'/>
                </span>
            </div>
        </xpath>
    </template>

    <template id="assets_frontend" inherit_id="website.assets_frontend" name="Shop">
      <xpath expr="." position="inside">
        <script type="text/javascript" src="/website_sale_delivery/static/src/js/website_sale_delivery.js"></script>
        <link rel="stylesheet" href="/website_sale_delivery/static/src/less/website_sale_delivery.less"/>
      </xpath>
    </template>

    <template id="payment_delivery" name="Delivery Costs" inherit_id="website_sale.payment">
        <xpath expr="//div[@id='payment_method']" position="before">
            <div t-if="deliveries" class="o_website_sale_carrier_options col-md-12" id="delivery_carrier">
                <h3 title="Delivery price will be updated after choosing a new delivery method">Choose a delivery method</h3>
                <div class="panel panel-default">
                    <t t-foreach="deliveries" t-as="delivery">
                         <div class="panel-body o_website_sale_delivery_method_panel" t-att-data-delivery-id="delivery.id">
                            <div id="delivery_method" class="row">
                                <label class="col-xs-6 font-weight-normal">
                                    <input type="radio" name="delivery_type" t-att-checked="order.carrier_id and order.carrier_id.id == delivery.id and 'checked' or False"/>
                                    <abbr t-att-title="delivery.website_description"><span t-field="delivery.name"/></abbr>
                                </label>
                                <span t-if="delivery.delivery_type == 'fixed' or order.carrier_id and order.carrier_id.id == delivery.id and 'checked' or False" class="col-xs-6 pull-right text-right">
                                    <t t-if="delivery.delivery_type == 'fixed'">
                                        <strong t-esc="delivery.fixed_price" t-options="{'widget': 'monetary', 'display_currency': order.pricelist_id.currency_id}"/>
                                    </t>
                                    <t t-else="">
                                        <strong t-esc="order.amount_delivery" t-options="{'widget': 'monetary', 'display_currency': order.pricelist_id.currency_id}"/>
                                    </t>
                                </span>
                                <span t-else="" class="col-xs-6 pull-right text-right">
                                    <strong class="o_website_sale_delivery_price hidden" t-esc="0.00" t-options="{'widget': 'monetary', 'display_currency': order.pricelist_id.currency_id}"/>
                                    <a class="o_website_sale_compute_delivery_price" t-att-data-delivery-id="delivery.id">Click to compute</a>
                                </span>
                            </div>
                            <div t-field="delivery.website_description" class="text-muted ml16"/>
                        </div>
                    </t>
                </div>
                <a groups="base.group_system" t-attf-href="/web#return_label=Website&amp;action=#{delivery_action_id}">
                    <i class="fa fa-plus-square" aria-hidden="true"></i> Configure delivery methods
                </a>
            </div>
        </xpath>
    </template>

    <template id="portal_order_page_shipping_tracking" name="Shipping tracking on orders followup" inherit_id="website_sale_stock.portal_order_page_shipping">
        <xpath expr="//div[@id='picking_info']" position="after">
            <div t-if="i.carrier_tracking_ref">
                Tracking: <span t-field="i.carrier_id.name"/>
                <t t-if="i.carrier_tracking_url">
                    <a t-att-href="i.carrier_tracking_url" target="_blank"><span t-field="i.carrier_tracking_ref"/></a>
                </t>
                <t t-else="">
                    <span t-field="i.carrier_tracking_ref"/>
                </t>
            </div>
        </xpath>
    </template>

</odoo>
