<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="portal_task_share_wizard" model="ir.ui.view">
        <field name="name">task.share.wizard</field>
        <field name="model">task.share.wizard</field>
        <field name="inherit_id" ref="portal.portal_share_wizard"/>
        <field name="mode">primary</field>
        <field name="arch" type="xml">
            <xpath expr="//button[hasclass('btn-secondary')]" position="replace">
                <button class="btn-secondary" special="cancel" data-hotkey="x" />
            </xpath>
            <xpath expr="//button[hasclass('btn-primary')]" position="attributes">
                <attribute name="invisible">project_privacy_visibility in ['invited_users', 'followers']</attribute>
            </xpath>
            <xpath expr="//field[@name='note']" position="attributes">
                <attribute name="invisible">project_privacy_visibility in ['invited_users', 'followers']</attribute>
            </xpath>
            <xpath expr="//field[@name='partner_ids']" position="attributes">
                <attribute name="invisible">project_privacy_visibility in ['invited_users', 'followers']</attribute>
            </xpath>
            <xpath expr="//field[@name='share_link']" position="attributes">
                <attribute name="help">You can only share this task by copying the link and sending it, because the privacy of the project is too restricted. This link is not revokable once it has been shared.</attribute>
                <attribute name="invisible">not (project_privacy_visibility in ['invited_users', 'followers'])</attribute>
            </xpath>
            <xpath expr="//field[@name='share_link']" position="before">
                <field name="share_link" widget="CopyClipboardChar" options="{'string': 'Copy Link'}" invisible="project_privacy_visibility in ['invited_users', 'followers']"/>
            </xpath>
        </field>
    </record>
</odoo>
