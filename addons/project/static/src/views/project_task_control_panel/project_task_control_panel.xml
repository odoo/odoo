<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="project.ProjectTaskControlPanel" t-inherit="web.ControlPanel">
        <xpath expr="//button[@name='embedded_actions']" position="replace">
            <t t-if="this.showTaskOptions and !this.env.isSmall or this.env.isSmall and !this.state.embeddedInfos.embeddedActions?.length">
                <Dropdown>
                    <button class="btn btn-secondary" t-att-title="this.taskOptionsTitle">
                        <i class="fa fa-sliders"/>
                    </button>
                    <t t-set-slot="content">
                        <DropdownItem onSelected="() => this.onClickShowSubtasks()" class="this.state.showSubtasks ? 'selected' : ''">
                            Show Sub-Tasks
                        </DropdownItem>
                        <DropdownItem t-if="this.state.embeddedInfos.embeddedActions?.length and !this.env.isSmall"
                            class="this.state.embeddedInfos.showEmbedded ? 'selected' : ''"
                            onSelected="() => this.onClickShowEmbedded()"
                        >
                            Top Menu
                        </DropdownItem>
                    </t>
                </Dropdown>
            </t>
        </xpath>
         <xpath expr="//t[@t-if='this.state.embeddedInfos.embeddedActions?.length and this.env.isSmall']" position="replace">
            <t t-call="project.MobileCombinedActionsDropdown"/>
        </xpath>
    </t>

   <t t-name="project.MobileCombinedActionsDropdown">
        <t t-if="this.env.isSmall and this.state.embeddedInfos.embeddedActions?.length">
            <Dropdown menuClass="'o_combined_mobile_dropdown'">
                <button class="btn btn-secondary">
                    <i class="fa fa-sliders" />
                </button>
                <t t-set-slot="content">
                    <DropdownItem
                        onSelected="() => this.onClickShowSubtasks()"
                        class="this.state.showSubtasks ? 'selected' : ''"
                    >
                        Show Sub-Tasks
                    </DropdownItem>
                    <div role="separator" class="dropdown-divider"/>
                    <t t-if="this.state.embeddedInfos.embeddedActions?.length">
                        <t t-foreach="this.state.embeddedInfos.embeddedActions" t-as="action" t-key="this.action.id">
                            <DropdownItem
                                class="this.getDropdownClass(action)"
                                onSelected="() => this.onEmbeddedActionClick(action)"
                            >
                                <span t-out="this.action.name" />
                            </DropdownItem>
                        </t>
                    </t>
                </t>
            </Dropdown>
        </t>
    </t>

</templates>
