<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- prod only bundle, like in web, but without the main.js file of web
    which starts the webclient (mainly allows mail to add its main.js file which
    starts the mail services) -->
    <template id="assets_backend_prod_only">
    </template>

    <template id="assets">
        <!-- basic scss setup -->
        <t t-call="web._assets_helpers">
            <t t-call="web._assets_backend_helpers"/>
        </t>
        <t t-call="web._assets_bootstrap"/>

        <!-- insert all scss files in /wowl -->
        <t t-foreach="scssFiles" t-as="scssFile">
            <link rel="stylesheet" type="text/scss" t-att-href="scssFile"/>
        </t>

        <!-- insert all js files in /wowl -->
        <t t-foreach="jsFiles" t-as="jsFile">
            <script type="text/javascript" t-att-src="jsFile"></script>
        </t>
    </template>

    <template id="wowl.assets_backend" inherit_id="web.assets_backend" primary="True">
        <xpath expr="//script[@src='/web/static/src/js/chrome/abstract_web_client.js']" position="replace"/>
        <xpath expr="//script[@src='/web/static/src/js/chrome/action_manager.js']" position="replace"/>
        <xpath expr="//script[@src='/web/static/src/js/chrome/action_manager_act_window.js']" position="replace"/>
        <xpath expr="//script[@src='/web/static/src/js/chrome/action_manager_report.js']" position="replace"/>
        <xpath expr="//script[@src='/web/static/src/js/chrome/apps_menu.js']" position="replace"/>
        <xpath expr="//script[@src='/web/static/src/js/chrome/menu.js']" position="replace"/>
        <xpath expr="//script[@src='/web/static/src/js/chrome/root_widget.js']" position="replace"/>
        <xpath expr="//script[@src='/web/static/src/js/chrome/systray_menu.js']" position="replace"/>
        <xpath expr="//script[@src='/web/static/src/js/chrome/user_menu.js']" position="replace"/>
        <xpath expr="//script[@src='/web/static/src/js/chrome/web_client.js']" position="replace"/>
        <xpath expr="//script[@src='/web/static/src/js/services/crash_manager_service.js']" position="replace"/>
        <xpath expr="//script[@src='/web/static/src/js/widgets/switch_company_menu.js']" position="replace"/>
        <xpath expr="//script[@src='/web/static/src/js/tools/test_menus_loader.js']" position="replace"/>


        <xpath expr="//script[@src='/web/static/lib/fuzzy-master/fuzzy.js']" position="after">
            <script type="text/javascript" src="/web/static/lib/Chart/Chart.js"></script> <!-- would be good to lazy load it -->
            <script type="text/javascript" src="/web/static/lib/luxon/luxon.js"></script>
        </xpath>
    </template>

    <template id="wowl.root">&lt;!DOCTYPE html&gt;
        <html>
            <head>
                <meta charset="utf-8"/>
                <title t-esc="title or 'WOWL'"/>
                <link type="image/x-icon" rel="shortcut icon" t-att-href="x_icon or '/wowl/static/img/favicon.ico'"/>

                <script>
                    window.odoo = {
                        session_info: <t t-raw="json.dumps(session_info)"/>,
                        debug: "<t t-esc="debug"/>",
                        csrf_token: "<t t-esc="request.csrf_token(None)"/>",
                    };
                </script>

                <t t-call-assets="wowl.assets" t-js="False"/>

                <t t-call-assets="web.assets_common" t-js="false"/>
                <t t-call-assets="wowl.assets_backend" t-js="false"/>
                <t t-call-assets="web.assets_common" t-css="false"/>
                <t t-call-assets="wowl.assets_backend" t-css="false"/>
                <t t-call-assets="wowl.assets_backend_prod_only" t-css="false"/>

                <t t-call-assets="wowl.assets" t-css="False"/>
            </head>
            <body />
        </html>
    </template>

    <template id="test_assets" inherit_id="wowl.assets" primary="True">
        <xpath expr="//t[@t-call='web._assets_bootstrap']" position="after">
            <link type="text/css" rel="stylesheet" href="/web/static/lib/qunit/qunit-2.9.1.css"/>
            <script type="text/javascript" src="/web/static/lib/qunit/qunit-2.9.1.js"></script>
            <!-- <script type="text/javascript" src="/web/static/tests/helpers/qunit_config.js"></script> -->
            <!-- <script type="text/javascript" src="/web/static/tests/helpers/qunit_asserts.js"></script> -->
        </xpath>
    </template>


    <template id="wowl.test_assets_backend" inherit_id="web.assets_backend" primary="True">
        <xpath expr="//script[@src='/web/static/lib/fuzzy-master/fuzzy.js']" position="after">
            <script type="text/javascript" src="/web/static/lib/Chart/Chart.js"></script>
            <script type="text/javascript" src="/web/static/lib/luxon/luxon.js"></script>
        </xpath>
    </template>

    <template id="web_test_assets_compat" inherit_id="web.tests_assets" primary="True">
        <xpath expr="//script[@src='/web/static/lib/qunit/qunit-2.9.1.js']" position="replace" ></xpath>
<!--         <xpath expr="//script[@src='/web/static/tests/helpers/test_utils.js']" position="replace" ></xpath> -->
        <xpath expr="//script[@src='/web/static/tests/helpers/qunit_asserts.js']" position="replace" ></xpath>
        <xpath expr="//script[@src='/web/static/tests/helpers/qunit_config.js']" position="replace" ></xpath>
        <xpath expr="//script[@src='/web/static/tests/main_tests.js']" position="replace" ></xpath>
    </template>

    <template id="wowl.qunit_suite">
        <html>
            <head>
                <meta charset="utf-8"/>
                <title t-esc="'WOWL Tests'"/>
                <link type="image/x-icon" rel="shortcut icon" t-att-href="x_icon or '/wowl/static/img/favicon.ico'"/>

                <t t-call-assets="web.assets_common" t-js="false"/>
                <t t-call-assets="wowl.test_assets_backend" t-js="false"/>
                <t t-call-assets="web.assets_common" t-css="false"/>
                <t t-call-assets="wowl.test_assets_backend" t-css="false"/>

                <t t-call-assets="wowl.test_assets" t-js="False"/>
                <t t-call-assets="wowl.test_assets" t-css="False"/>

                <t t-call-assets="wowl.web_test_assets_compat" t-css="false"/>
            </head>
            <body>
                <div id="qunit"/>
                <div id="qunit-fixture"/>
            </body>
        </html>
    </template>

</odoo>
