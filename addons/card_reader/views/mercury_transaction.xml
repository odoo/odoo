<?xml version='1.0' encoding='utf-8'?>
<openerp>
  <data>
    <template id='mercury_transaction' name='Mercury Xml Transaction'>
      <TStream>
        <Transaction>
          <MerchantID><t t-esc='merchant_id'/></MerchantID>
          <OperatorID>test</OperatorID> <!-- TODO -->
          <TranType><t t-esc='transaction_type'/></TranType>
          <TranCode><t t-esc='transaction_code'/></TranCode>
          <InvoiceNo><t t-esc='invoice_no'/></InvoiceNo>
          <LaneID><t t-esc='config_id'/></LaneID>
          <TerminalID><t t-esc='config_id'/></TerminalID>
          <RecordNo>RecordNumberRequested</RecordNo> <!-- TODO -->
          <Frequency>OneTime</Frequency>
          <PartialAuth>Allow</PartialAuth>
          <Memo><t t-esc='memo'/></Memo>
          <Account>
            <AccountSource>Swiped</AccountSource>
            <EncryptedBlock><t t-esc='encrypted_data["enc_track2"]'/></EncryptedBlock>
            <EncryptedKey><t t-esc='encrypted_data["dukpt_serial_n"]'/></EncryptedKey>
            <EncryptedFormat>MagneSafe</EncryptedFormat>
          </Account>
          <Amount>
            <Purchase><t t-esc='"%.2f" % purchase'/></Purchase> <!-- format required by Mercury -->
          </Amount>
        </Transaction>
      </TStream>
    </template>

    <template id='mercury_voidsale' name='Mercury VoidSale'>
      <TStream>
        <Transaction>
          <MerchantID><t t-esc='merchant_id'/></MerchantID>
          <TranType><t t-esc='transaction_type'/></TranType>
          <TranCode><t t-esc='transaction_code'/></TranCode>
          <InvoiceNo><t t-esc='invoice_no'/></InvoiceNo>
          <RefNo><t t-esc='ref_no'/></RefNo>
          <LaneID><t t-esc='config_id'/></LaneID>
          <RecordNo><t t-esc='record_no'/></RecordNo>
          <Frequency>OneTime</Frequency>
          <Memo><t t-esc='memo'/></Memo>
          <Amount>
            <Purchase><t t-esc='"%.2f" % authorize'/></Purchase> <!-- format required by Mercury -->
          </Amount>
          <TranInfo>
            <AuthCode><t t-esc='auth_code'/></AuthCode>
          </TranInfo>
        </Transaction>
      </TStream>
    </template>

    <template id='mercury_reversal' name='Mercury Reversal' inherit_id='card_reader.mercury_voidsale'>
      <TranInfo>
        <AcqRefData><t t-esc='acq_ref_data'/></AcqRefData>
        <ProcessData><t t-esc='process_data'/></ProcessData>
      </TranInfo>
    </template>
  </data>
</openerp>
