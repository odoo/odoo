<?xml version="1.0" encoding="utf-8"?>
<odoo>

<template id="tracks">
    <t t-call="website_event.layout">
    <div class="oe_structure" id="oe_structure_website_event_track_tracks_1"/>
        <section class="pt48 pb48">
            <div class="container">
                <div class="row">
                    <div id="left_column">
                    </div>
                    <div class="col-lg-9">
                        <div class="alert alert-warning" t-if="not len(tracks)" role="alert">
                            No tracks found!
                        </div>
                        <div class="row mb-2" t-foreach="tracks" t-as="track">
                            <div class="col-md-2">
                                <t t-if="track.image">
                                    <span t-field="track.image"
                                        t-options='{"widget": "image", "class": "rounded-circle"}'/>
                                </t>
                            </div>
                            <div class="col-md-10">
                                <h3 class="mt0 mb0">
                                    <a t-attf-href="/event/#{ slug(event) }/track/#{ slug(track) }" class="text-secondary"><span t-field="track.name"> </span></a>
                                    <small t-if="not track.website_published" class="badge badge-danger">unpublished</small>
                                </h3>
                                <ul class="list-inline mb0">
                                    <li t-if="track.partner_id" class="list-inline-item">
                                        <i class="fa fa-user text-primary"/>
                                        <t t-esc="track.partner_id.sudo().name"/>
                                    </li>
                                    <li t-if="track.date" class="list-inline-item">
                                        <i class="fa fa-calendar text-primary"/>
                                        <span t-field="track.date" t-options='{"hide_seconds":"True"}'/>
                                    </li>
                                    <li class="list-inline-item" t-if="track.location_id">
                                        <i class="fa fa-map-marker"/>
                                        <span t-field="track.location_id"/>
                                    </li>
                                </ul>
                                <ul class="list-inline">
                                    <li t-foreach="track.tag_ids" t-as="tag_id" class="list-inline-item fa fa-tags" t-if="tag_id.color != 0">
                                        <a t-attf-href="/event/#{ slug(event) }/track/tag/#{ slug(tag_id) }">
                                            <i class="fa fa-tags"/>
                                            <span t-field="tag_id.name"/>
                                        </a>
                                    </li>
                                </ul>
                                <p class="mt8"><t t-esc="html2plaintext(track.description or '')[0:500]"/><t t-if="track.description">...</t></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <div class="oe_structure" id="oe_structure_website_event_track_tracks_2"/>
    </t>
</template>

<template id="tracks_filter" inherit_id="website_event_track.tracks" customize_show="True" name="Filter on Tags">
    <xpath expr="//div[@id='left_column']" position="inside">
        <ul class="nav nav-pills flex-column">
            <li class="nav-item"><a t-attf-href="/event/#{ slug(event) }/track" t-attf-class="nav-link #{'' if searches.get('tag') else ' active'}">All Tags</a></li>
            <t t-foreach="tags" t-as="tag">
                <li class="nav-item">
                    <a t-attf-href="/event/#{ slug(event) }/track/tag/#{ slug(tag) }" t-attf-class="nav-link#{searches.get('tag') == tag.id and ' active' or ''}">
                        <t t-esc="tag.name"/>
                    </a>
                </li>
            </t>
        </ul>
    </xpath>
    <xpath expr="//div[@id='left_column']" position="attributes">
        <attribute name="class">col-lg-3 css_no_print</attribute>
    </xpath>
</template>

</odoo>
