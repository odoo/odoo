-
   Set the context for customer invoices because the 'type' field is readonly in invoice form views, so it value won't be considered by the yaml import
-
  !record {model: account.invoice, id: demo_invoice_1}:
    partner_id: base.res_partner_12
    user_id: base.user_demo
    reference_type: none
    payment_term_id: account.account_payment_term
    type: 'out_invoice'
    date_invoice: !eval time.strftime('%Y-%m')+'-01'
    invoice_line_ids:
      - product_id: product.consu_delivery_02
        price_unit: 642.0
        quantity: 5
      - product_id: product.consu_delivery_03
        price_unit: 280.0
        quantity: 5.0
-
  !workflow {model: account.invoice, action: invoice_open, ref: demo_invoice_1}
-
  !record {model: account.invoice, id: demo_invoice_2}:
    partner_id: base.res_partner_2
    type: 'out_invoice'
    date_invoice: !eval time.strftime('%Y-%m')+'-08'
    invoice_line_ids:
      - product_id: product.consu_delivery_03
        price_unit: 50.0
        quantity: 3
      - product_id: product.consu_delivery_01
        price_unit: 25
        quantity: 20
-
  !workflow {model: account.invoice, action: invoice_open, ref: demo_invoice_2}
-
  !record {model: account.invoice, id: demo_invoice_3}:
    partner_id: base.res_partner_2
    type: 'out_invoice'
    date_invoice: !eval time.strftime('%Y-%m')+'-08'
    invoice_line_ids:
      - product_id: product.consu_delivery_01
        price_unit: 90.0
        quantity: 5
      - product_id: product.consu_delivery_03
        price_unit: 15.0
        quantity: 5.0
-
  !workflow {model: account.invoice, action: invoice_open, ref: demo_invoice_3}
-
   Set the context for supplier bills because the 'type' field is readonly in invoice form views, so it value won't be considered by the yaml import
-
  !context
    type: 'in_invoice'
-
  !record {model: account.invoice, id: demo_invoice_0}:
    partner_id: base.res_partner_12
    user_id: base.user_demo
    reference_type: none
    payment_term_id: account.account_payment_term
    type: 'in_invoice'
    date_invoice: !eval time.strftime('%Y-%m')+'-01'
    invoice_line_ids:
      - price_unit: 10.0
        quantity: 1.0
        product_id: product.product_delivery_01
        uom_id: product.product_uom_unit
      - price_unit: 4.0
        quantity: 1.0
        product_id: product.product_order_01
        uom_id: product.product_uom_unit
-
  !record {model: account.invoice, id: demo_invoice_january_wages}:
    partner_id: base.res_partner_12
    type: 'in_invoice'
    date_invoice: !eval time.strftime('%Y-%m')+'-01'
-
  !python {model: ir.model.data} : |
      line_vals = {
          'invoice_id': ref('demo_invoice_january_wages'),
          'name': "CEO wages",
          'price_unit': 10000,
      }
      default_company = self.pool.get('res.company')._company_default_get(cr, uid, 'account.account')
      account_id = self.pool.get('account.account').search(cr, uid, [('tag_ids', 'in', [ref('account.demo_ceo_wages_account')]), ('company_id', '=', default_company)])
      if not account_id:
          account_id = self.pool.get('account.account').search(cr, uid, [('user_type_id', '=', ref('account.data_account_type_expenses')), ('company_id', '=', default_company)])
      if account_id:
          line_vals['account_id'] = account_id[0]
          self._update(cr, uid, 'account.invoice.line', 'account', line_vals, 'ceo_wages_line')
          self.pool.get('account.invoice').signal_workflow(cr, uid, [ref('demo_invoice_january_wages')], 'invoice_open')
-
  !record {model: account.invoice, id: demo_invoice_equipment_purchase}:
    partner_id: base.res_partner_1
    type: 'in_invoice'
    date_invoice: !eval time.strftime('%Y-%m')+'-15'
-
  !python {model: ir.model.data} : |
      line_vals = {
          'invoice_id': ref('demo_invoice_equipment_purchase'),
          'name': "Coffee Machine with huge 'employee\'s performances boosting perk'",
          'price_unit': 4999.99,
      }
      account_default_company = self.pool.get('res.company')._company_default_get(cr, uid, 'account.account')
      account_id = self.pool.get('account.account').search(cr, uid, [('tag_ids', 'in', [ref('account.demo_coffee_machine_account')]), ('company_id', '=', account_default_company)])
      if not account_id:
          account_id = self.pool.get('account.account').search(cr, uid, [('user_type_id', '=', ref('account.data_account_type_expenses')), ('company_id', '=', account_default_company)])
      if account_id:
          line_vals['account_id'] = account_id[0]
          tax_default_company = self.pool.get('res.company')._company_default_get(cr, uid, 'account.tax')
          tax_id = self.pool.get('account.tax').search(cr, uid, [('type_tax_use', '=', 'purchase'), ('amount', '>', 0), ('company_id', '=', tax_default_company)])
          if tax_id:
            line_vals['invoice_line_tax_ids'] = [(6, 0, [tax_id[0]])]
          self._update(cr, uid, 'account.invoice.line', 'account', line_vals, 'coffee_machine_line')
          self.pool.get('account.invoice').browse(cr, uid, ref('demo_invoice_equipment_purchase'))._onchange_invoice_line_ids()
          self.pool.get('account.invoice').signal_workflow(cr, uid, [ref('demo_invoice_equipment_purchase')], 'invoice_open')
-
  !python {model: account.bank.statement.line} : |
      default_company = self.pool('res.company')._company_default_get(cr, uid, 'account.account')
      account_ids = self.pool.get('account.account').search(cr, uid, [('user_type_id', '=', ref('account.data_account_type_revenue')), ('tag_ids', 'in', [ref('account.account_tag_financing')]), ('company_id', '=', default_company)])
      line = self.browse(cr, uid, ref('account.demo_bank_statement_line_5'))
      if not line.journal_entry_ids and account_ids:
          line.write({'account_id': account_ids[0]})
          line.fast_counterpart_creation()
-
  !python {model: ir.model.data} : |
      from datetime import datetime
      from dateutil.relativedelta import relativedelta
      default_company = self.pool('res.company')._company_default_get(cr, uid, 'account.journal')
      vals = {
          'journal_id': self.pool.get('account.journal').search(cr, uid, [('type', '=', 'general'), ('company_id', '=', default_company)])[0],
          'date': datetime.now().replace(day=1,month=1) - relativedelta(days=1),
          'ref': 'Company Creation',
      }
      self._update(cr, uid, 'account.move', 'account', vals, 'demo_opening_move')
-
  !python {model: ir.model.data} : |
      journal_default_company = self.pool('res.company')._company_default_get(cr, uid, 'account.journal')
      bank_journal_id = self.pool.get('account.journal').search(cr, uid, [('type', '=', 'bank'), ('company_id', '=', journal_default_company)])[0]
      if bank_journal_id:
          bank_account_id = self.pool.get('account.journal').browse(cr, uid, bank_journal_id).default_debit_account_id.id
      account_default_company = self.pool.get('res.company')._company_default_get(cr, uid, 'account.account')
      fixed_asset_account_ids = self.pool.get('account.account').search(cr, uid, [('user_type_id', 'in', (ref('account.data_account_type_fixed_assets'),ref('account.data_account_type_current_assets'))), ('company_id', '=', account_default_company)])
      equity_account_ids = self.pool.get('account.account').search(cr, uid, [('user_type_id', '=', ref('account.data_account_type_equity')), ('tag_ids', 'in', [ref('account.demo_capital_account')]), ('company_id', '=', account_default_company)])
      if bank_account_id and fixed_asset_account_ids and equity_account_ids:
          self._update(cr, uid, 'account.move.line', 'account', {
              'move_id': ref('account.demo_opening_move'),
              'name': 'Opening Entry',
              'debit': 5103,
              'account_id': bank_account_id}, 'opening_line_1', context={'check_move_validity': False})
          self._update(cr, uid, 'account.move.line', 'account', {
              'move_id': ref('account.demo_opening_move'),
              'name': 'Opening Entry',
              'debit': 13447,
              'account_id': fixed_asset_account_ids[0]}, 'opening_line_2', context={'check_move_validity': False})
          self._update(cr, uid, 'account.move.line', 'account', {
              'move_id': ref('account.demo_opening_move'),
              'name': 'Opening Entry',
              'credit': 18550,
              'account_id': equity_account_ids[0]}, 'opening_line_3', context={'check_move_validity': False})
