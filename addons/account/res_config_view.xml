<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <record id="open_account_charts_modules" model="ir.actions.act_window">
            <field name="name">Chart Templates</field>
            <field name="res_model">ir.module.module</field>
            <field name="view_mode">kanban,tree,form</field>
            <field name="context" eval="{'search_default_category_id': ref('base.module_category_localization_account_charts')}"/>
            <field name="search_view_id" ref="base.view_module_filter"/>
        </record>

        <record id="view_account_config_settings" model="ir.ui.view">
            <field name="name">account settings</field>
            <field name="model">account.config.settings</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Configure Accounting" version="7.0">
                    <header>
                        <button string="Apply" type="object" name="execute" class="oe_highlight"/>
                        or
                        <button string="Cancel" type="object" name="cancel" class="oe_link"/>
                    </header>
                    <field name="has_default_company" invisible="1" />
                    <field name="has_chart_of_accounts" invisible="1"/>
                    <field name="complete_tax_set" invisible="1"/>
                    <field name="has_fiscal_year" invisible="1"/>

                    <group groups="base.group_multi_company">
                        <field name="company_id" string="Select Company" widget="selection"
                            on_change="onchange_company_id(company_id)"
                            attrs="{'invisible': [('has_default_company', '=', True)]}"/>
                        <field name="expects_chart_of_accounts"/>
                    </group>

                    <group string="Select a Chart of Accounts to Install"
                        attrs="{'invisible': ['|', ('expects_chart_of_accounts','=',False), ('has_chart_of_accounts','=',True)]}">
                        <group>
                            <field name="chart_template_id" widget="selection" domain="[('visible','=', True)]"
                                on_change="onchange_chart_template_id(chart_template_id)"/>
                            <field name="code_digits" groups="account.group_account_user"/>
                            <field name="sale_tax" attrs="{'invisible': ['|', ('chart_template_id','=',False), ('complete_tax_set','=',False)]}"
                                domain="[('chart_template_id', '=', chart_template_id),('parent_id','=',False),('type_tax_use','in',('sale','all'))]"/>
                            <field name="purchase_tax" attrs="{'invisible': ['|', ('chart_template_id','=',False), ('complete_tax_set','=',False)]}"
                                domain="[('chart_template_id', '=', chart_template_id),('parent_id','=',False),('type_tax_use','in',('purchase', 'all'))]"/>
                            <field name="sale_tax_rate" attrs="{'invisible': ['|', ('chart_template_id','=',False), ('complete_tax_set','=',True)]}" on_change="onchange_tax_rate(sale_tax_rate)"/>
                            <field name="purchase_tax_rate" attrs="{'invisible': ['|', ('chart_template_id','=',False), ('complete_tax_set','=',True)]}"/>
                        </group>
                        <button string="Install More Chart Templates" icon="gtk-go-forward"
                            name="%(open_account_charts_modules)d" type="action"/>
                    </group>

                    <group string="No Fiscal Year Defined for This Company"
                        attrs="{'invisible': ['|', ('expects_chart_of_accounts','=',False), ('has_fiscal_year','=',True)]}">
                        <label for="date_start" string="Date Range"/>
                        <div>
                            <field name="date_start" on_change="onchange_start_date(date_start)" class="oe_inline"/> -
                            <field name="date_stop" class="oe_inline"/>
                        </div>
                        <field name="period"/>
                    </group>

                    <group>
                        <group name="account_config" string="Accounting Configuration">
                            <field name="default_sale_tax" domain="[('type_tax_use','=','sale'), ('company_id','=',company_id)]"
                                attrs="{'invisible': [('has_chart_of_accounts','=',False)]}"/>
                            <field name="module_account_accountant"/>
                            <field name="currency_id"/>
                            <field name="decimal_precision"/>
                            <field name="default_purchase_tax" domain="[('type_tax_use','=','purchase'), ('company_id','=',company_id)]"
                                attrs="{'invisible': [('has_chart_of_accounts','=',False)]}"/>
                            <field name="tax_calculation_rounding_method"/>
                            <field name="module_account_asset"/>
                            <field name="module_account_budget"/>
                        </group>
                        <group name="customer_inv_grp" string="Customer Invoices">
                            <label for="sale_sequence_next"/>
                            <group>
                                <field name="sale_sequence_prefix" class="oe_inline" nolabel="1"
                                    help='If you put "%%(year)s" in the prefix, it will be replaced by the current year.'/>
                                <field name="sale_sequence_next" class="oe_inline" nolabel="1"  attrs="{'readonly': [('sale_journal_id','=',False)]}"/>
                            </group>
                            <label for="sale_refund_sequence_next"/>
                            <group>
                                <field name="sale_refund_sequence_prefix" class="oe_inline" nolabel="1" 
                                    help='If you put "%%(year)s" in the prefix, it will be replaced by the current year.'/>
                                <field name="sale_refund_sequence_next" nolabel="1" class="oe_inline" attrs="{'readonly': [('sale_refund_journal_id','=',False)]}"/>
                            </group>
                            <field name="module_account_voucher"/>
                            <field name="module_account_followup"/>
                            <field name="group_proforma_invoices"/>
                            <separator name="analytic_accounting" invisible="1" string="Analytic Accounting"/>
                        </group>
                        <group name="supplier_inv_grp" string="Supplier Invoices">
                             <label for="purchase_sequence_next"/>
                            <group>
                                <field name="purchase_sequence_prefix" class="oe_inline" nolabel="1"
                                    help='If you put "%%(year)s" in the prefix, it will be replaced by the current year.'/>
                                <field name="purchase_sequence_next" nolabel="1" class="oe_inline" attrs="{'readonly': [('purchase_journal_id','=',False)]}"/>
                            </group>
                            <label for="purchase_refund_sequence_next"/>
                            <group>
                                <field name="purchase_refund_sequence_prefix" class="oe_inline" nolabel="1" 
                                    help='If you put "%%(year)s" in the prefix, it will be replaced by the current year.'/>
                                <field name="purchase_refund_sequence_next" class="oe_inline"
                                  attrs="{'readonly': [('purchase_refund_journal_id','=',False)]}" nolabel="1"/>
                            </group>
                            <field name="module_account_payment"/>
                            <separator string="Electronic Payments"/>
                            <field name="paypal_account" placeholder="sales@openerp.com"/>
                            <separator string="Bank &amp; Cash"/>
                            <label for="id" string="Configure Bank Accounts"/>
                            <button name="%(action_bank_tree)d" string="Configure Bank Accounts" icon="gtk-go-forward" type="action"/>
                            <field name="company_footer"/>
                            <field name="module_account_check_writing"/>
                        </group>
                    </group>
                    <field name="sale_journal_id" invisible="1"/>
                    <field name="sale_refund_journal_id" invisible="1"/>
                    <field name="purchase_journal_id" invisible="1"/>
                    <field name="purchase_refund_journal_id" invisible="1"/>
                </form>
            </field>
        </record>

        <record id="action_account_config" model="ir.actions.act_window">
            <field name="name">Configure Accounting</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">account.config.settings</field>
            <field name="view_mode">form</field>
            <field name="target">inline</field>
        </record>

        <menuitem id="menu_account_config" name="Accounting" parent="base.menu_config"
            sequence="14" action="action_account_config"/>

    </data>
</openerp>
