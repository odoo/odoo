<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">
    <t t-name="pos_restaurant.ActionpadWidget" t-inherit="point_of_sale.ActionpadWidget" t-inherit-mode="extension">
        <!-- Replace the payment button by the order button -->
        <xpath expr="//button[hasclass('validation')]" position="after">
            <button
                t-if="this.swapButton"
                t-attf-class="submit-order h-100 {{getMainButtonClasses()}} position-relative px-3"
                t-att-class="swapButtonClasses"
                t-on-click="submitOrder">
                <div t-if="this.uiState.clicked and displayCategoryCount.length" class="h-100 w-100 position-absolute top-0 start-0 d-flex align-items-center justify-content-center" style="backdrop-filter: blur(7px);">
                    <img src="/web/static/img/spin.svg" style="height:35px; width:35px" alt="Loading..."/>
                </div>
                <t t-if="!(displayCategoryCount.length > 2)">Order</t>
                <div t-attf-class="{{ !(displayCategoryCount.length > 2) ? 'd-flex flex-column align-items-end gap-1' : 'row row-cols-2 g-1 gx-2' }} {{ isCategoryCountOverflow ? 'mt-n3' : ''}}">
                    <t t-if="displayCategoryCount.length">
                        <t t-foreach="displayCategoryCount" t-as="categoryCountLine"  t-key="categoryCountLine_index">
                            <div class="d-flex align-items-center justify-content-between small" t-att-class="{ 'gap-2' : !(displayCategoryCount.length > 2) }">
                                <label class="text-truncate"><t t-esc="categoryCountLine.name"/></label>
                                <label class="rounded px-2 py-0" style="background-color:rgba(0, 0, 0, 0.3);"><t t-esc="categoryCountLine.count"/></label>
                            </div>
                        </t>
                    </t>
                    <t t-if="isCategoryCountOverflow">
                        <div class="position-absolute bottom-0 start-50 translate-middle-x">...</div>
                    </t>
                </div>
            </button>
        </xpath>
        <xpath expr="//button[hasclass('validation')]" position="attributes">
            <attribute name="t-if">!this.swapButton</attribute>
        </xpath>

        <!-- Replace the customer button by the payment button, the customer button will be added in the control buttons -->
        <xpath expr="//button[hasclass('validation')]" position="before">
            <button t-if="this.swapButton"
                t-on-click="() => pos.pay()" 
                class="button pay-order-button btn btn-lg w-50"
                t-attf-class="{{ this.highlightPay ? 'highlight btn-primary' : 'btn-light' }}" 
                >
                Payment
            </button>
        </xpath>
        <xpath expr="//button[hasclass('validation')]" position="attributes">
            <attribute name="t-if">!this.swapButton</attribute>
        </xpath>
    </t>
</templates>
