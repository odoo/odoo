<?xml version="1.0" encoding="utf-8"?>
<odoo>

<!-- Set original template for tracks / track as tracking visitors -->
<record model="ir.ui.view" id="website_event_track.tracks">
    <field name="track" eval="True"/>
</record>
<record model="ir.ui.view" id="website_event_track.track_view">
    <field name="track" eval="True"/>
</record>

<!-- Add wishlist button on tracks / track templates -->
<template id="tracks_wishlist"
    name="Wishlist on Tracks"
    inherit_id="website_event_track.tracks"
    customize_show="True">
    <xpath expr="//h3" position="replace">
        <h3 class="mt0 mb0 d-flex">
            <a t-attf-href="/event/#{ slug(event) }/track/#{ slug(track) }" class="text-secondary"><span t-field="track.name"> </span></a>
            <small t-if="not track.website_published" class="badge badge-danger">unpublished</small>
            <t t-call="website_event_track_online.track_widget_reminder"/>
        </h3>
    </xpath>
</template>

<template id="track_view_wishlist"
    name="Wishlist on Track"
    inherit_id="website_event_track.track_view"
    customize_show="True">
    <xpath expr="//h1" position="replace">
        <div class="d-flex">
            <h1 t-field="track.name"/>
            <div class="ml-2 pt-1">
                <t t-call="website_event_track_online.track_widget_reminder"/>
            </div>
        </div>
    </xpath>
</template>

<!-- Pimp agenda based on accepted / published -->
<template id="agenda"
    name="Track Online: Agenda"
    inherit_id="website_event_track.agenda">
    <xpath expr="//t[@name='track_agenda_track_cell']" position="replace">
        <t t-if="track" name="track_agenda_track_cell">
            <t t-if="user_event_manager or track.is_published">
                <a t-attf-href="/event/#{ slug(event) }/track/#{ slug(track) }">
                    <span t-esc="track.name"/>
                </a>
            </t>
            <t t-else="">
                <span t-esc="track.name"/>
            </t>
            <div class="d-flex text-muted">
                <small t-esc="track.partner_name or track.partner_id.name"/>
                <span t-if="user_event_manager and not track.website_published" class=" ml-auto badge badge-danger">unpublished</span>
            </div>
        </t>
    </xpath>
</template>

<!-- Pimp sponsor view -->
<template id="event_layout" inherit_id="website_event.layout">
    <xpath expr="//div[@id='wrap']" position="attributes">
        <attribute name="t-attf-class">o_wevent_event js_event #{'o_wevent_hide_sponsors' if hide_sponsors else ''}</attribute>
    </xpath>
</template>

<template id="event_sponsor"
    name="Track Online: Sponsors"
    inherit_id="website_event_track.event_sponsor">
    <xpath expr="//div[@t-if='event.sponsor_ids']" position="replace">
        <div class="container mt32 mb16 d-none d-md-block d-print-none" t-if="event.sponsor_ids">
            <div t-attf-class="d-flex flex-wrap mb-5 #{'' if (len(event.sponsor_ids) > 10) else 'justify-content-md-center'}">
                <t t-foreach="event.sponsor_ids" t-as="sponsor">
                    <t t-if="sponsor.url">
                        <a class="o_wevent_sponsor_card" target="_blank" t-att-href="sponsor.url">
                            <div class="h-100 shadow-sm p-2">
                                <span t-field="sponsor.image_128"
                                    t-options='{"widget": "image", "class": "img img-fluid"}'/>
                                <div t-if="sponsor.sponsor_type_id.display_ribbon_style and sponsor.sponsor_type_id.display_ribbon_style != 'no_ribbon'" class="ribbon-wrapper">
                                    <div t-field="sponsor.sponsor_type_id" t-attf-class="ribbon ribbon_#{sponsor.sponsor_type_id.display_ribbon_style}"/>
                                </div>
                            </div>
                        </a>
                    </t>
                    <t t-if="not sponsor.url">
                        <div class="o_wevent_sponsor_card">
                            <div class="h-100 shadow-sm p-2">
                                <span t-field="sponsor.image_128"
                                    t-options='{"widget": "image", "class": "img img-fluid"}'/>
                                <div t-if="sponsor.sponsor_type_id.display_ribbon_style and sponsor.sponsor_type_id.display_ribbon_style != 'no_ribbon'" class="ribbon-wrapper">
                                    <div t-field="sponsor.sponsor_type_id" t-attf-class="ribbon ribbon_#{sponsor.sponsor_type_id.display_ribbon_style}"/>
                                </div>
                            </div>
                        </div>
                    </t>
                </t>
            </div>
        </div>
    </xpath>
</template>

</odoo>
