<odoo>
    <!-- Каталог с выпадающими категориями -->
    <template id="catalog_dropdown" name="Каталог с категориями">
        <div id="catalog-toggle-container" style="margin-bottom: 20px;">
            <!-- Кнопка Каталог -->
            <button id="catalog-toggle-btn" class="btn btn-warning w-100 mb-3 d-lg-block d-none" style="z-index: 1001; position: relative;">Каталог</button>
            <div id="catalog-categories" style="display: none;">
                <ul class="list-group">
                    <li class="list-group-item"><a href="/shop">All Products</a></li>
                    <li class="list-group-item"><a href="/shop/category/dom">Для дома</a></li>
                    <!-- Добавьте другие категории по аналогии или с помощью t-foreach -->
                </ul>
            </div>
        </div>
        <script type="text/javascript">
            document.addEventListener('DOMContentLoaded', function() {
                var btn = document.getElementById('catalog-toggle-btn');
                var cat = document.getElementById('catalog-categories');
                btn.addEventListener('click', function() {
                    cat.style.display = (cat.style.display === 'none' || cat.style.display === '') ? 'block' : 'none';
                });
            });
        </script>
        <style>
            #catalog-categories {
                transition: all 0.3s;
                margin-top: 10px;
            }
        </style>
    </template>

    <!-- Custom User Profile Template -->
    <template id="custom_user_profile" name="Custom User Profile">
        <t t-call="website.layout">
            <div class="container mt-5 o_custom_profile_page">
                <!-- User Info -->
                <div class="row text-center">
                    <div class="col-md-12">
                        <!-- Удалено: имя пользователя и кнопка 'Изменить инфо' -->
                    </div>
                </div>

                <!-- Navigation Buttons -->
                <div class="button-group-container mt-5">
                    <div class="row">
                        <div class="col-md-4 text-center">
                            <a href="/user/orders/status" class="btn btn-warning w-100">Статус заказа</a>
                        </div>
                        <div class="col-md-4 text-center">
                            <a href="/user/orders/history" class="btn btn-warning w-100">История заказов</a>
                        </div>
                        <div class="col-md-4 text-center">
                            <a href="/user/orders/returns" class="btn btn-warning w-100">Возвраты</a>
                        </div>
                    </div>
                </div>

                <div class="button-group-container mt-4">
                    <div class="row">
                        <div class="col-md-6 text-center">
                            <button class="btn btn-warning w-100">Кошелек</button>
                        </div>
                        <div class="col-md-6 text-center">
                            <a href="/shop/checkout" class="btn btn-warning w-100">Адрес доставки</a>
                        </div>
                    </div>
                </div>

                <div class="button-group-container mt-4">
                    <div class="row">
                        <div class="col-md-6 text-center">
                            <a href="/seller_reg" class="btn btn-warning w-100">Открыть магазин</a>
                        </div>
                        <div class="col-md-6 text-center">
                            <button class="btn btn-warning w-100">Бухгалтерия и налоги</button>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <template id="edit_user_profile" name="Edit User Profile">
        <t t-call="website.layout">
            <div class="container mt-5">
                <h2>Редактировать профиль</h2>
                <form method="post" action="/profile/save">
                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />

                    <div class="form-group">
                        <label for="name">Имя</label>
                        <input type="text" id="name" name="name" class="form-control" t-att-value="user.name" />
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" class="form-control" t-att-value="user.email" />
                    </div>
                    <div class="form-group">
                        <label for="phone">Телефон</label>
                        <input type="text" id="phone" name="phone" class="form-control" t-att-value="user.phone" />
                    </div>

                    <!-- Password Change Fields -->
                    <div class="form-group">
                        <label for="new_password">Новый пароль</label>
                        <input type="password" id="new_password" name="new_password" class="form-control" />
                    </div>
                    <div class="form-group">
                        <label for="confirm_password">Подтвердите новый пароль</label>
                        <input type="password" id="confirm_password" name="confirm_password" class="form-control" />
                    </div>

                    <button type="submit" class="btn btn-save mt-3">Сохранить</button>
                    <a href="/profile" class="btn btn-cancel mt-3">Отмена</a>
                </form>
            </div>
        </t>
    </template>
    <template id="user_order_status" name="Order Status">
        <t t-call="website.layout">
            <div class="container mt-5">
                <h3 class="mb-4">Order Status</h3>
                <div class="row" t-foreach="orders" t-as="order">
                    <div class="col-md-12 mb-3">
                        <div class="card p-3 d-flex flex-row align-items-center">
                            <img t-att-src="order.image_url" class="img-thumbnail me-3" style="width: 100px; height: 100px;" />
                            <div class="flex-grow-1">
                                <h5 t-esc="order.name">Product Name</h5>
                                <p>Quantity: <t t-esc="order.quantity" /></p>
                                <p>Status: <span class="badge bg-info" t-esc="order.status">Pending Shipment</span></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>
    <template id="user_order_history" name="Order History">
        <t t-call="website.layout">
            <div class="container mt-5">
                <h3 class="mb-4">Order History</h3>
                <div class="row" t-foreach="orders" t-as="order">
                    <div class="col-md-12 mb-3">
                        <div class="card p-3 d-flex flex-row align-items-center justify-content-between">
                            <div class="d-flex align-items-center">
                                <img t-att-src="order.image_url" class="img-thumbnail me-3" style="width: 100px; height: 100px;" />
                                <div>
                                    <h5 t-esc="order.name">Product Name</h5>
                                    <p>Quantity: <t t-esc="order.quantity" /></p>
                                    <p>Status: <span class="badge bg-success" t-esc="order.status">Delivered</span></p>
                                </div>
                            </div>
                            <div>
                                <p>Date: <t t-esc="order.date_order" /></p>
                                <p>Time: <t t-esc="order.time_order" /></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>
    <template id="user_order_returns" name="Returns">
        <t t-call="website.layout">
            <div class="container mt-5">
                <h3 class="mb-4">Returns</h3>
                <div class="row" t-foreach="returns" t-as="ret">
                    <div class="col-md-12 mb-3">
                        <div class="card p-3 d-flex flex-row align-items-center justify-content-between">
                            <div class="d-flex align-items-center">
                                <img t-att-src="ret.image_url" class="img-thumbnail me-3" style="width: 100px; height: 100px;" />
                                <div>
                                    <h5 t-esc="ret.name">Product Name</h5>
                                    <p>Quantity: <t t-esc="ret.quantity" /></p>
                                    <p>Status: <span class="badge bg-warning" t-esc="ret.status">Return Requested</span></p>
                                </div>
                            </div>
                            <div>
                                <p>Return Date: <t t-esc="ret.date_return" /></p>
                                <p>Return Time: <t t-esc="ret.time_return" /></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <!-- Упрощаем шаблон, сохраняя функционал кнопки каталога -->
    <template id="desktop_search_nav" inherit_id="website.layout">
        <!-- Пустой для удаления -->
    </template>

    <!-- Добавляем специальный шаблон для размещения иконок в products_header -->
    <template id="header_icons_placement" inherit_id="website_sale.products">
        <!-- Пустой для удаления -->
    </template>

    <!-- Create a new template that directly injects icons into the products_header -->
    <template id="product_header_with_icons" inherit_id="website_sale.products">
        <xpath expr="//div[hasclass('products_header')]" position="attributes">
            <attribute name="class" add="position-relative d-flex align-items-center" separator=" "/>
        </xpath>
        
        <xpath expr="//div[hasclass('products_header')]" position="inside">
            <div class="desktop-nav-icons ms-3" style="display: flex; align-items: center; gap: 15px; margin-left: auto;">
                <a href="/shop" class="nav-icon-btn" t-attf-class="nav-icon-btn{{ ' active' if request.httprequest.path == '/shop' else '' }}">
                    <i class="fa fa-home"></i>
                </a>
                <a href="/videos" class="nav-icon-btn">
                    <i class="fa fa-play"></i>
                </a>
                <a href="/shop/cart" class="nav-icon-btn" t-attf-class="nav-icon-btn{{ ' active' if '/shop/cart' in request.httprequest.path else '' }}">
                    <i class="fa fa-shopping-cart"></i>
                </a>
                <a href="/profile" class="nav-icon-btn" t-attf-class="nav-icon-btn{{ ' active' if '/profile' in request.httprequest.path else '' }}">
                    <i class="fa fa-user"></i>
                </a>
            </div>
        </xpath>
    </template>

    <template id="mobile_bottom_nav" inherit_id="website.layout">
        <xpath expr="//body" position="inside">
            <div class="mobile-bottom-nav d-md-none">
                <div class="nav-btns">
                    <a href="/shop" class="nav-btn" t-attf-class="nav-btn{{ ' active' if request.httprequest.path == '/shop' else '' }}"><i class="fa fa-home"></i></a>
                    <a href="/videos" class="nav-btn" style="display: flex; align-items: center; justify-content: center;"><i class="fa fa-play"></i></a>
                    <a href="/shop/cart" class="nav-btn" t-attf-class="nav-btn{{ ' active' if '/shop/cart' in request.httprequest.path else '' }}"><i class="fa fa-shopping-cart"></i></a>
                    <a href="/profile" class="nav-btn" t-attf-class="nav-btn{{ ' active' if '/profile' in request.httprequest.path else '' }}"><i class="fa fa-user"></i></a>
                </div>
            </div>
        </xpath>
    </template>

    <!-- Aside с категориями, скрыт по умолчанию -->
    <template id="catalog_aside" name="Каталог Aside">
        <div style="display: flex; justify-content: flex-end;">
            <button id="catalog-toggle-btn" class="btn btn-warning mb-3 catalog-anim-btn" style="width: 110px; font-weight: bold; font-size: 13px; padding: 10px 0; border-radius: 24px; outline: none; box-shadow: none; border: none; margin-right: 0; transition: background 0.2s, filter 0.2s, transform 0.1s; background: #ff9800; color: #fff;">КАТАЛОГ</button>
        </div>
        <div id="catalog-categories-block" style="display: none; background: #fff; border-radius: 18px; box-shadow: 0 2px 12px rgba(0,0,0,0.04); padding: 24px 20px 20px 20px; margin-top: 10px;">
            <t t-call="website_sale.products_categories_list"/>
        </div>
        <style>
            #catalog-toggle-btn:focus, #catalog-toggle-btn:active {
                outline: none !important;
                box-shadow: none !important;
                border: none !important;
            }
            #catalog-toggle-btn:active {
                filter: brightness(0.85);
                transform: scale(0.97);
            }
            #catalog-toggle-btn {
                border-radius: 24px !important;
                transition: background 0.2s, filter 0.2s, transform 0.1s;
                background: #ff9800 !important;
                color: #fff !important;
            }
            #catalog-toggle-btn:hover {
                background: #ff9800 !important;
                color: #fff !important;
                filter: none !important;
            }
            #catalog-categories-block {
                background: #fff;
                border-radius: 18px;
                box-shadow: 0 2px 12px rgba(0,0,0,0.04);
                padding: 24px 20px 20px 20px;
                margin-top: 10px;
            }
            #catalog-categories-block .o_categories_collapse_title {
                display: none !important;
            }
        </style>
        <script type="text/javascript">
            document.addEventListener('DOMContentLoaded', function() {
                var btn = document.getElementById('catalog-toggle-btn');
                var block = document.getElementById('catalog-categories-block');
                btn.addEventListener('click', function() {
                    if (block.style.display === 'none' || block.style.display === '') {
                        block.style.display = 'block';
                    } else {
                        block.style.display = 'none';
                    }
                    setTimeout(function() {
                        btn.blur();
                    }, 200);
                });
            });
        </script>
    </template>

    <template id="custom_shop_with_catalog" inherit_id="website_sale.products">
        <!-- Кнопка Каталог слева от поиска -->
        <xpath expr="//t[@t-call='website_sale.search']" position="before">
            <div class="catalog-button-container">
                <button class="catalog-button" type="button">Каталог</button>
            </div>
            <div class="catalog-sidebar" style="display:none;">
                <div class="catalog-sidebar__content">
                    <div class="catalog-sidebar__header">
                        <button class="catalog-sidebar__close" type="button">×</button>
                    </div>
                    <div class="catalog-sidebar__categories">
                        <t t-call="website_sale.products_categories_list"/>
                    </div>
                </div>
            </div>
        </xpath>
        <xpath expr="//div[@id='wrap']" position="inside">
            <style>
                .catalog-sidebar {
                    position: fixed;
                    top: 0;
                    left: 0;
                    height: 100dvh;
                    width: 220px;
                    background: #fff;
                    box-shadow: 2px 0 16px rgba(0,0,0,0.08);
                    z-index: 2000;
                    display: flex;
                    flex-direction: column;
                    transition: transform 0.25s cubic-bezier(.4,0,.2,1);
                    transform: translateX(-100%);
                    overflow-y: auto;
                }
                .catalog-sidebar.open {
                    display: flex !important;
                    transform: translateX(0);
                }
                .catalog-sidebar__content {
                    flex: 1 1 auto;
                    display: flex;
                    flex-direction: column;
                    height: 100dvh;
                    padding: 24px 12px 20px 12px;
                }
                .catalog-sidebar__header {
                    display: flex;
                    justify-content: flex-end;
                    align-items: center;
                    margin-bottom: 16px;
                }
                .catalog-sidebar__close {
                    background: none;
                    border: none;
                    font-size: 2rem;
                    color: #888;
                    cursor: pointer;
                }
                .catalog-sidebar__categories .o_categories_collapse_title {
                    display: none !important;
                }
                @media (max-width: 600px) {
                    .catalog-sidebar {
                        width: 45vw;
                        min-width: 0;
                    }
                }
                body.sidebar-open {
                    overflow: hidden !important;
                    position: fixed;
                    width: 100vw;
                }
            </style>
            <script type="text/javascript">
                document.addEventListener('DOMContentLoaded', function() {
                    var btn = document.querySelector('.catalog-button');
                    var sidebar = document.querySelector('.catalog-sidebar');
                    var closeBtn = sidebar ? sidebar.querySelector('.catalog-sidebar__close') : null;

                    function openSidebar() {
                        if(sidebar) {
                            sidebar.style.display = 'flex';
                            setTimeout(function(){ sidebar.classList.add('open'); }, 10);
                            document.body.classList.add('sidebar-open');
                        }
                    }
                    function closeSidebar() {
                        if(sidebar) {
                            sidebar.classList.remove('open');
                            setTimeout(function(){ sidebar.style.display = 'none'; }, 250);
                            document.body.classList.remove('sidebar-open');
                        }
                    }

                    if(btn) {
                        btn.addEventListener('click', function(e) {
                            e.stopPropagation();
                            if(sidebar &amp;&amp; sidebar.classList.contains('open')) {
                                closeSidebar();
                            } else {
                                openSidebar();
                            }
                        });
                    }
                    if(closeBtn) {
                        closeBtn.addEventListener('click', function() {
                            closeSidebar();
                        });
                    }
                    // Закрытие по клику вне сайдбара
                    document.addEventListener('click', function(e) {
                        if(sidebar &amp;&amp; sidebar.classList.contains('open') &amp;&amp; !sidebar.contains(e.target) &amp;&amp; e.target !== btn) {
                            closeSidebar();
                        }
                    });
                });
            </script>
        </xpath>
    </template>
</odoo>