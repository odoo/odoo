<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <!-- diseño copiado de los reportes de encuestas de odoo -->
        <template id="evaluaciones.diseño" name="Diseño de reporte de evaluación genérico" inherit_id="web.frontend_layout" primary="True">
            <xpath expr="//div[@id='wrapwrap']" position="before">
                <t t-set="no_livechat" t-value="True"/>
            </xpath>
            <xpath expr="//div[@id='wrapwrap']" position="attributes">
                <attribute name="t-attf-class" add="o_survey_background" separator=" "/>
            </xpath>
            <xpath expr="//head/t[@t-call-assets][last()]" position="after">
                <t t-call-assets="evaluaciones.evaluaciones_assets" lazy_load="True"/>
            </xpath>
            <xpath expr="//header" position="before">
                <t t-set="no_header" t-value="True"/>
                <t t-set="no_footer" t-value="True"/>
            </xpath>
            <xpath expr="//header" position="after">
                <div id="wrap" class="oe_structure oe_empty"/>
            </xpath>
        </template>


        <template id="encuestas_reporte" name="Reporte: página de reporte genérico">
            <t t-call="evaluaciones.diseño">
                <t t-set="limite_registros" t-value="10"/>
                <div class="o_survey_result mb-5">
                    <t t-call="evaluaciones.encuestas_reporte_header" />
                    <t t-call="evaluaciones.encuestas_reporte_nom_035" />
                    <t t-call="evaluaciones.encuestas_reporte_inner" />
                </div>
            </t>
        </template>

        <template id="encuestas_reporte_clima" name="Reporte: página de reporte genérico">
            <t t-call="evaluaciones.diseño">
                <t t-set="limite_registros" t-value="10"/>
                <div class="o_survey_result">
                    <t t-call="evaluaciones.encuestas_reporte_header" />
                    <t t-call="evaluaciones.encuesta_reporte_clima" />
                    <t t-call="evaluaciones.encuestas_reporte_inner" />
                </div>
            </t>
        </template>

        <template id="encuestas_reporte_header" name="Reporte: cabecera de reporte genérico">
            <div class="o_survey_statistics_header mt32">
                <div class="d-flex justify-content-between">
                    <div class="d-block">
                        <h1>
                            <span t-field="evaluacion.nombre"/>
                        </h1>
                    </div>
                </div>
                <button class="btn btn-primary d-none d-print-none d-md-inline-block o_survey_results_print" aria-label="Print" title="Print">
                    <i class="fa fa-print"></i> Exportar
                </button>
            </div>
        </template>

        <template id="encuestas_reporte_inner" name="Reporte: contenido de reporte genérico">
            <h4>
                <button class="btn btn-link ps-0 pt-2 d-print-none" type="button" data-bs-toggle="collapse" t-attf-data-bs-target=".question_detail">
                    <i class="fa fa-eye" aria-hidden="true"/>
                </button>Ver detalles de preguntas</h4>
            <div class="question_detail survey_section container-fluid collapse show" t-foreach="preguntas" t-as='datos_pregunta'>
                <t t-set="pregunta" t-value="datos_pregunta['pregunta']"/>
                <div class="o_survey_results_question_wrapper container-fluid p-5" t-call="evaluaciones.encuestas_reporte_pregunta" />
            </div>
        </template>

        <!--AQUÍ COMIENZA NOM 035-->
        <template id="encuestas_reporte_nom_035" name="Reporte: NOM-035">
            <div class="container-fluid row gap-5 justify-content-between g-2">
                <div class="col survey_section">
                    <h4>Calificación final</h4>
                    <span t-att-class="'color_nulo' if final &lt; 20 else 'color_bajo' if 20 &lt;= final &lt; 45 else 'color_medio' if 45 &lt;= final &lt; 70 else 'color_alto' if 70 &lt;= final &lt; 90 else 'color_muy-alto'">
                        <t t-esc="final"/>
                    </span>
                    <span class="fs-5 pill">
                        Riesgo
                        <t t-if="final &lt; 20"> nulo</t>
                        <t t-elif="20 &lt;= final &lt; 45"> bajo</t>
                        <t t-elif="45 &lt;= final &lt; 70"> medio</t>
                        <t t-elif="70 &lt;= final &lt; 90"> alto</t>
                        <t t-else="true"> muy alto</t>
                    </span>
                </div>

                <div class="col survey_section w-100">
                    <h4>Semáforo de riesgos</h4>
                    <div class="container-fluid row gap-2 align-items-center">
                        <div class="color_circle" style="background-color: #ff4747;"/>
                        <span class="col">Riesgo muy alto</span>
                    </div>

                    <div class="container-fluid row gap-2 align-items-center">
                        <div class="color_circle" style="background-color:  #fc8803;"/>
                        <span class="col">Riesgo alto</span>
                    </div>

                    <div class="container-fluid row gap-2 align-items-center">
                        <div class="color_circle" style="background-color: #fcd703;"/>
                        <span class="col">Riesgo medio</span>
                    </div>

                    <div class="container-fluid row gap-2 align-items-center">
                        <div class="color_circle" style="background-color: #5aaf2b;"/>
                        <span class="col">Riesgo bajo</span>
                    </div>

                    <div class="container-fluid row gap-2 align-items-center">
                        <div class="color_circle" style="background-color: #2894a7;"/>
                        <span class="col">Riesgo nulo</span>
                    </div>
                </div>
            </div>

            <t t-if="evaluacion.incluir_demograficos">
                <h4>Datos demográficos</h4>
                <div class="container-fluid">
                    <div class="row gap-5">
                        <div class="col survey_section">
                            <h4>
                            Por generación
                            </h4>
                            <div class="survey_graph" t-att-id="'grafica_pastel_generacion_nom_035'" t-att-data-graph-type="'pie'" t-att-data-label="'Generación'" t-att-data-graph-data="generaciones">
                                <canvas t-att-id="'canvas_pastel_generacion_nom_035'"/>
                            </div>
                        </div>

                        <div class="col survey_section">
                            <h4>
                            Por género
                            </h4>
                            <div class="survey_graph" t-att-id="'grafica_pastel_genero_nom_035'" t-att-data-graph-type="'pie'" t-att-data-label="'Género'" t-att-data-graph-data="generos">
                                <canvas t-att-id="'canvas_pastel_genero_nom_035'"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="container-fluid">
                    <div class="row gap-5">
                        <div class="col survey_section">
                            <h4>
                            Por departamento
                            </h4>
                            <div class="survey_graph" t-att-id="'grafica_pastel_departamento_nom_035'" t-att-data-graph-type="'pie'" t-att-data-label="'Generación'" t-att-data-graph-data="departamentos">
                                <canvas t-att-id="'canvas_pastel_departamento_nom_035'"/>
                            </div>
                        </div>

                        <div class="col survey_section">
                            <h4>
                            Por puesto
                            </h4>
                            <div class="survey_graph" t-att-id="'grafica_pastel_puesto_nom_035'" t-att-data-graph-type="'pie'" t-att-data-label="'Generación'" t-att-data-graph-data="puestos">
                                <canvas t-att-id="'canvas_pastel_puesto_nom_035'"/>
                            </div>
                        </div>
                    </div>
                </div>
            </t>

            <div class="survey_page container-fluid d-flex flex-column">
                <div class="survey_section">
                    <h4>Resumen general por categorías</h4>
                    <div class="survey_graph" t-att-id="'grafica_barras_categorias_nom_035'" t-att-data-graph-type="'bar'" t-att-data-label="'Categorías'" t-att-data-graph-data="categorias">
                        <canvas t-att-id="'canvas_barras_categorias_nom_035'"/>
                    </div>
                </div>

                <div class="container-fluid">
                    <div class="row gap-5">
                        <div class="col survey_section align-items-start">
                            <h4>
                                Categoría con mayor puntaje
                            </h4>
                            <div class="container-fluid d-flex flex-row gap-3 align-items-center justify-content-center">
                                <span class="fs-1">
                                    <t t-esc="max(categorias, key=lambda x: x['valor'])['valor']"/>
                                </span>
                                <span class="fs-5">
                                    <t t-esc="max(categorias, key=lambda x: x['valor'])['nombre']"/>
                                </span>
                            </div>
                        </div>

                        <div class="col survey_section align-items-start">
                            <h4>
                                Categoría con menor puntaje
                            </h4>
                            <div class="container-fluid d-flex flex-row gap-3 align-items-center justify-content-center">
                                <span class="fs-1">
                                    <t t-esc="min(categorias, key=lambda x: x['valor'])['valor']"/>
                                </span>
                                <span class="fs-5">
                                    <t t-esc="min(categorias, key=lambda x: x['valor'])['nombre']"/>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="survey_section">
                    <h4>Resumen general por dominios</h4>
                    <div class="survey_graph" t-att-id="'grafica_radar_dominios_nom_035'" t-att-data-graph-type="'radar'" t-att-data-label="'Resultados por dominio'" t-att-data-graph-data="dominios">
                        <canvas t-att-id="'canvas_barras_dominios_nom_035'"/>
                    </div>
                </div>

                <div class="container-fluid">
                    <div class="row gap-5">
                        <div class="col survey_section align-items-start">
                            <h4>
                                Dominio con mayor puntaje
                            </h4>
                            <div class="container-fluid d-flex flex-row gap-3 align-items-center justify-content-center">
                                <span class="fs-1">
                                    <t t-esc="max(dominios, key=lambda x: x['valor'])['valor']"/>
                                </span>
                                <span class="fs-5">
                                    <t t-esc="max(dominios, key=lambda x: x['valor'])['nombre']"/>
                                </span>
                            </div>
                        </div>

                        <div class="col survey_section align-items-start">
                            <h4>
                                Dominio con menor puntaje:
                            </h4>
                            <div class="container-fluid d-flex flex-row gap-3 align-items-center justify-content-center">
                                <span class="fs-1">
                                    <t t-esc="min(dominios, key=lambda x: x['valor'])['valor']"/>
                                </span>
                                <span class="fs-5">
                                    <t t-esc="min(dominios, key=lambda x: x['valor'])['nombre']"/>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <h4>Resumen por categoría</h4>
            <div t-foreach="categorias" t-as='datos_categoria' class="survey_page container-fluid d-flex flex-column">
                <t t-set="categoria" t-value="datos_categoria['nombre']" />
                <t t-set="valor_categoria" t-value="datos_categoria['valor']" />
                <div class="survey_section">
                    <h5>
                        <t t-esc="categoria" />
                    </h5>
                    <h3 color="category_number">
                        <t t-esc="valor_categoria" />
                    </h3>

                    <t t-if="categoria == 'Ambiente de Trabajo'">
                        <div class="survey_graph" t-att-id="'grafica_barras_ambiente_trabajo_nom_035'" t-att-data-graph-type="'bar'" t-att-data-label="'Ambiente de Trabajo'" t-att-data-graph-data="dominios[:1]">
                            <canvas t-att-id="'canvas_barras_ambiente_trabajo_nom_035'"/>
                        </div>
                    </t>

                    <t t-elif="categoria == 'Factores propios de la actividad'">
                        <div class="survey_graph" t-att-id="'grafica_barras_factores_actividad_nom_035'" t-att-data-graph-type="'bar'" t-att-data-label="'Factores propios de la actividad'" t-att-data-graph-data="dominios[1:3]">
                            <canvas t-att-id="'canvas_barras_factores_actividad_nom_035'"/>
                        </div>
                    </t>

                    <t t-elif="categoria == 'Organización del tiempo de trabajo'">
                        <div class="survey_graph" t-att-id="'grafica_barras_organizacion_tiempo_nom_035'" t-att-data-graph-type="'bar'" t-att-data-label="'Organización del tiempo de trabajo'" t-att-data-graph-data="dominios[3:5]">
                            <canvas t-att-id="'canvas_barras_organizacion_tiempo_nom_035'"/>
                        </div>
                    </t>

                    <t t-elif="categoria == 'Liderazgo y relaciones en el trabajo'">
                        <div class="survey_graph" t-att-id="'liderazgo_relaciones'" t-att-data-graph-type="'bar'" t-att-data-label="'Liderazgo y relaciones en el trabajo'" t-att-data-graph-data="dominios[5:]">
                            <canvas t-att-id="'canvas_barras_liderazgo_relaciones_nom_035'"/>
                        </div>
                    </t>
                </div>
            </div>
            <div class="survey_section">
                <h4>Necesidad de acción</h4>
                <span class="container-fluid">
                    <t t-if="final &lt; 20">El riesgo resulta despreciable por lo que no se requiere medidas adicionales.</t>
                    <t t-elif="20 &lt;= final &lt; 45">Es necesario una mayor difusión de la política de prevención de riesgos psicosociales y programas para: la prevención de los factores de riesgo psicosocial, la promoción de un entorno organizacional favorable y la prevención de la violencia laboral.</t>
                    <t t-elif="45 &lt;= final &lt; 70">Se requiere revisar la política de prevención de riesgos psicosociales y programas para la prevención de los factores de riesgo psicosocial, la promoción de un entorno organizacional favorable y la prevención de la violencia laboral, así como reforzar su aplicación y difusión, mediante un Programa de intervención.</t>
                    <t t-elif="70 &lt;= final &lt; 90">Se requiere realizar un análisis de cada categoría y dominio, de manera que se puedan determinar las acciones de intervención apropiadas a través de un Programa de intervención, que podrá incluir una evaluación específica y deberá incluir una campaña de sensibilización, revisar la política de prevención de riesgos psicosociales y programas para la prevención de los factores de riesgo psicosocial, la promoción de un entorno organizacional favorable y la prevención de la violencia laboral, así como reforzar su aplicación y difusión.</t>
                    <t t-else="true">Se requiere realizar el análisis de cada categoría y dominio para establecer las acciones de intervención apropiadas, mediante un Programa de intervención que deberá incluir evaluaciones específicas, y contemplar campañas de sensibilización, revisar la política de prevención de riesgos psicosociales y programas para la prevención de los factores de riesgo psicosocial, la promoción de un entorno organizacional favorable y la prevención de la violencia laboral, así como reforzar su aplicación y difusión.</t>
                </span>
            </div>
        </template>

        <template id="encuestas_reporte_pregunta" name="Question: result statistics">
            <t t-set="default_line_height" t-value="35"/>
            <t t-set="text_box_line_height" t-value="83"/>

            <div class="o_survey_results_question pb-5 border-bottom">
                <div class="d-flex mb-3 o_survey_results_question_header">
                    <div class="d-flex flex-wrap mb-1">
                        <button class="btn btn-link ps-0 pt-2 d-print-none" type="button" data-bs-toggle="collapse" t-attf-data-bs-target=".o_survey_results_question_#{pregunta.id}">
                            <i class="fa fa-eye" aria-hidden="true"/>
                        </button>
                        <h5 t-field="pregunta.pregunta_texto" class="pt-2 mb-0 me-1"/>
                    </div>
                    <div t-attf-class="d-flex flex-fill justify-content-end align-items-end mb-1 collapse show o_survey_results_question_#{pregunta.id}">
                        <h7 class="ms-0 ms-sm-1 me-1 me-sm-0">
                            <span class="ml-1">Respuestas:</span>
                            <span t-out="len(datos_pregunta['respuestas'])" class="mb-1 text-info text-start"/>
                        </h7>
                    </div>
                </div>
                <div t-attf-class="collapse show o_survey_results_question_#{pregunta.id}">
                    <!-- Respuestas -->
                    <t t-set="pregunta_contestada" t-value="datos_pregunta['respuestas']"/>
                    <div t-if="not pregunta_contestada" class="o_survey_no_answers text-center fw-bold">
                        <p>Aun no hay respuestas</p>
                    </div>
                    <t t-elif="pregunta.tipo in ['open_question']" t-call="evaluaciones.pregunta_resultados_texto"/>
                    <t t-elif="pregunta.tipo in ['escala', 'multiple_choice']" t-call="evaluaciones.pregunta_resultados_seleccion"/>
                </div>
            </div>
        </template>

        <!-- AQUÍ COMIENZA CLIMA -->
        <template id="encuesta_reporte_clima" name="Reporte de Clima Laboral">
            <div class="container-fluid row gap-5 justify-content-between g-2">
                <div class="col survey_section">
                    <h4>Calificación final</h4>
                    <span t-att-class="'color_muy-alto' if total_porcentaje &lt; 20 else 'color_alto' if 20 &lt;= total_porcentaje &lt; 45 else 'color_medio' if 45 &lt;= total_porcentaje &lt; 70 else 'color_bajo' if 70 &lt;= total_porcentaje &lt;= 90 else 'color_muy-alto'">
                        <t t-esc="total_porcentaje"/>
                    </span>
                    <span class="fs-5 pill">
                        <t t-if="total_porcentaje &lt; 20"> Deficiente</t>
                        <t t-elif="20 &lt;= total_porcentaje &lt; 45"> Regular</t>
                        <t t-elif="45 &lt;= total_porcentaje &lt; 70"> Marginal</t>
                        <t t-elif="70 &lt;= total_porcentaje &lt; 90">Suficiente</t>
                        <t t-else="true">Superior</t>
                    </span>
                </div>

                <div class="col survey_section w-100">
                    <h4>Semáforo</h4>
                    <div class="container-fluid row gap-2 align-items-center">
                        <div class="color_circle" style="background-color: #2894a7;"></div>
                        <span class="col">Superior</span>
                    </div>
                    <div class="container-fluid row gap-2 align-items-center">
                        <div class="color_circle" style="background-color: #5aaf2b;"></div>
                        <span class="col">Suficiente</span>
                    </div>
                    <div class="container-fluid row gap-2 align-items-center">
                        <div class="color_circle" style="background-color: #fcd703;"></div>
                        <span class="col">Marginal</span>
                    </div>

                    <div class="container-fluid row gap-2 align-items-center">
                        <div class="color_circle" style="background-color: #fc8803;"></div>
                        <span class="col">Regular</span>
                    </div>

                    <div class="container-fluid row gap-2 align-items-center">
                        <div class="color_circle" style="background-color: #ff4747;"></div>
                        <span class="col">Deficiente</span>
                    </div>
                </div>
            </div>

            <t t-if="evaluacion.incluir_demograficos">
                <h4>Datos demográficos</h4>
                <div class="container-fluid">
                    <div class="row gap-5">
                        <div class="col survey_section">
                            <h4>
                            Por generación
                            </h4>
                            <div class="survey_graph" t-att-id="'grafica_pastel_generacion_clima'" t-att-data-graph-type="'pie'" t-att-data-label="'Generación'" t-att-data-graph-data="generaciones">
                                <canvas t-att-id="'canvas_pastel_generacion_clima'"/>
                            </div>
                        </div>

                        <div class="col survey_section">
                            <h4>
                            Por género
                            </h4>
                            <div class="survey_graph" t-att-id="'grafica_pastel_genero_clima'" t-att-data-graph-type="'pie'" t-att-data-label="'Género'" t-att-data-graph-data="generos">
                                <canvas t-att-id="'canvas_pastel_genero_clima'"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="container-fluid">
                    <div class="row gap-5">
                        <div class="col survey_section">
                            <h4>
                            Por departamento
                            </h4>
                            <div class="survey_graph" t-att-id="'grafica_pastel_departamento_clima'" t-att-data-graph-type="'pie'" t-att-data-label="'Departamento'" t-att-data-graph-data="departamentos">
                                <canvas t-att-id="'canvas_pastel_departamento_clima'"/>
                            </div>
                        </div>

                        <div class="col survey_section">
                            <h4>
                            Por puesto
                            </h4>
                            <div class="survey_graph" t-att-id="'grafica_pastel_puesto_clima'" t-att-data-graph-type="'pie'" t-att-data-label="'Puesto'" t-att-data-graph-data="puestos">
                                <canvas t-att-id="'canvas_pastel_puesto_clima'"/>
                            </div>
                        </div>
                    </div>
                </div>
            </t>

            <div class="survey_page container-fluid d-flex flex-column">
                <div class="survey_section">
                    <h4>Resumen del Clima Laboral</h4>
                    <div class="survey_graph" t-att-id="'grafica_radar_categorias_clima'" t-att-data-graph-type="'radar'" t-att-data-label="'Categorías'" t-att-data-graph-data="categorias">
                        <canvas t-att-id="'canvas_barras_categorias_clima'"></canvas>
                    </div>
                </div>

                <div class="container-fluid">
                    <div class="row gap-5">
                        <div class="col survey_section align-items-start">
                            <h4>Categoría con mayor puntaje</h4>
                            <div class="container-fluid d-flex flex-row gap-3 align-items-center justify-content-center">
                                <span class="fs-1">
                                    <t t-esc="'{:.2f}'.format(max(categorias, key=lambda x: x['valor'])['valor'])"/>
                                </span>
                                <span class="fs-5">
                                    <t t-esc="max(categorias, key=lambda x: x['valor'])['nombre']"/>
                                </span>
                            </div>
                        </div>

                        <div class="col survey_section align-items-start">
                            <h4>Categoría con menor puntaje:</h4>
                            <div class="container-fluid d-flex flex-row gap-3 align-items-center justify-content-center">
                                <span class="fs-1">
                                    <t t-esc="'{:.2f}'.format(min(categorias, key=lambda x: x['valor'])['valor'])"/>
                                </span>
                                <span class="fs-5">
                                    <t t-esc="min(categorias, key=lambda x: x['valor'])['nombre']"/>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <t t-foreach="evaluacion.action_generar_datos_reporte_clima()['categorias']" t-as="categoria">
                <div class="survey_section container-fluid">
                    <t t-if="'puntuacion' in categoria">
                        <div class="survey_page container-fluid d-flex flex-column">
                            <div class="survey_section container-fluid">
                                <h4>
                                    <t t-esc="categoria['nombre']"/>
                                </h4>
                                <div class="survey_graph containar-fluid" t-att-id="'grafica_pie_' + categoria['nombre']" t-att-data-graph-type="'doughnut'" t-att-data-graph-data="[categoria,{'valor': 100 - categoria['valor'],'color':'#9c9c9c'}]">
                                    <canvas t-att-id="'canvas_pie_' + categoria['nombre']"></canvas>
                                </div>
                                <h4>Resumen por departamentos</h4>
                            </div>
                            <div class="survey_section">
                                <div class="survey_graph" t-att-id="'grafica_radar_departamentos_' + categoria['nombre']" t-att-data-graph-type="'col'" t-att-data-label="'Resultados por departamento'" t-att-data-graph-data="categoria['departamentos']">
                                    <canvas t-att-id="'canvas_radar_departamentos_' + categoria['nombre']"></canvas>
                                </div>
                            </div>
                        </div>
                    </t>
                </div>
            </t>
            <div class="survey_section mb-5">
                <h4>Necesidad de acción</h4>
                <span class="container-fluid">
                    <t t-if="total_porcentaje &lt; 20">Se requiere realizar el análisis de cada categoría y dominio para establecer las acciones de intervención apropiadas, mediante un Programa de intervención que deberá incluir evaluaciones específicas, y contemplar campañas de sensibilización, revisar la política de prevención de riesgos psicosociales y programas para la prevención de los factores de riesgo psicosocial, la promoción de un entorno organizacional favorable y la prevención de la violencia laboral, así como reforzar su aplicación y difusión.</t>
                    <t t-elif="20 &lt;= total_porcentaje &lt; 45">Se requiere realizar un análisis de cada categoría y dominio, de manera que se puedan determinar las acciones de intervención apropiadas a través de un Programa de intervención, que podrá incluir una evaluación específica y deberá incluir una campaña de sensibilización, revisar la política de prevención de riesgos psicosociales y programas para la prevención de los factores de riesgo psicosocial, la promoción de un entorno organizacional favorable y la prevención de la violencia laboral, así como reforzar su aplicación y difusión.</t>
                    <t t-elif="45 &lt;= total_porcentaje &lt; 70">Se requiere revisar la política de prevención de riesgos psicosociales y programas para la prevención de los factores de riesgo psicosocial, la promoción de un entorno organizacional favorable y la prevención de la violencia laboral, así como reforzar su aplicación y difusión, mediante un Programa de intervención.</t>
                    <t t-elif="70 &lt;= total_porcentaje &lt; 90">Es necesario una mayor difusión de la política de prevención de riesgos psicosociales y programas para: la prevención de los factores de riesgo psicosocial, la promoción de un entorno organizacional favorable y la prevención de la violencia laboral.</t>
                    <t t-else="true">El riesgo resulta despreciable por lo que no se requiere medidas adicionales.</t>
                </span>
            </div>
        </template>
        <template id="pregunta_resultados_texto" name="Question: text result (text_box, char_box)">
            <t t-set="respuestas" t-value="datos_pregunta['respuestas']"/>
            <t t-set="first_page_records_count" t-value="len(respuestas) if len(respuestas) &lt; limite_registros else limite_registros"/>
            <t t-set="cell_height" t-value="default_line_height"/>
            <div t-attf-style="height: auto" class="overflow_auto o_survey_user_responses_table_wrapper">
                <table class="table table-hover table-sm o_survey_results_table_indexed" t-att-id="'survey_table_question_%d' % pregunta.id">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Respuestas</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-foreach="respuestas" t-as="respuesta">
                            <tr t-att-class="'d-none' if not respuesta in respuestas[:limite_registros] else ''">
                                <td>
                                    <t t-esc="respuesta_index + 1"></t>
                                </td>
                                <td>
                                    <div class="d-flex justify-content-between">
                                        <t t-esc="respuesta"/>
                                    </div>
                                </td>
                            </tr>
                        </t>
                    </tbody>
                </table>
            </div>
            <t t-call="evaluaciones.question_table_pagination"/>
        </template>

        <template id="pregunta_resultados_seleccion" name="Question: choice result (simple_choice, multiple_choice)">
            <t t-set="respuestas" t-value="datos_pregunta['respuestas']"/>
            <t t-set="respuestas_tabuladas" t-value="datos_pregunta['respuestas_tabuladas']"/>
            <t t-set="datos_grafica" t-value="datos_pregunta['datos_grafica']"/>
            <ul class="nav nav-tabs d-print-none" role="tablist">
                <li t-if="pregunta_contestada" class="nav-item">
                    <a t-att-href="'#grafica_barras_pregunta__%d' % pregunta.id" t-att-aria-controls="'grafica_barras_pregunta__%d' % pregunta.id" class="nav-link active default" data-bs-toggle="tab" role="tab" data-chart="1">
                        <i class="fa fa-bar-chart-o"></i>
                        <span>Gráfico de barras</span>
                    </a>
                </li>
                <li t-if="pregunta_contestada" class="nav-item">
                    <a t-att-href="'#grafica_columnas_pregunta__%d' % pregunta.id" t-att-aria-controls="'grafica_columnas_pregunta__%d' % pregunta.id" class="nav-link" data-bs-toggle="tab" role="tab" data-chart="1">
                        <i class="fa fa-bar-chart-o"></i>
                        <span>Gráfico de columnas</span>
                    </a>
                </li>
                <li t-if="pregunta_contestada" class="nav-item">
                    <a t-att-href="'#grafica_pastel_pregunta__%d' % pregunta.id" t-att-aria-controls="'grafica_pastel_pregunta__%d' % pregunta.id" class="nav-link" data-bs-toggle="tab" role="tab" data-chart="1">
                        <i class="fa fa-bar-chart-o"></i>
                        <span>Gráfico de pastel</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a t-att-href="'#datos_pregunta__%d' % pregunta.id" t-att-aria-controls="'datos_pregunta__%d' % pregunta.id" t-attf-class="nav-link #{'active' if not pregunta_contestada else ''}" data-bs-toggle="tab" role="tab">
                        <i class="fa fa-list-alt me-1"/>
                        <span>Tabla de datos</span>
                    </a>
                </li>
            </ul>
            <div class="tab-content">
                <div t-if="pregunta_contestada" role="tabpanel" class="tab-pane active survey_graph" t-att-id="'grafica_barras_pregunta__%d' % pregunta.id" t-att-data-graph-type="'bar'" t-att-data-graph-data="datos_grafica">
                    <canvas class="mx-auto" t-att-id="'canvas_barras_pregunta__%d' % pregunta.id"/>
                </div>
                <div t-if="pregunta_contestada" role="tabpanel" class="tab-pane survey_graph" t-att-id="'grafica_columnas_pregunta__%d' % pregunta.id" t-att-data-graph-type="'col'" t-att-data-graph-data="datos_grafica">
                    <canvas class="mx-auto" t-att-id="'canvas_columnas_pregunta__%d' % pregunta.id"/>
                </div>
                <div t-if="pregunta_contestada" role="tabpanel" class="tab-pane survey_graph" t-att-id="'grafica_pastel_pregunta__%d' % pregunta.id" t-att-data-graph-type="'pie'" t-att-data-graph-data="datos_grafica">
                    <canvas class="mx-auto" t-att-id="'canvas_pastel_pregunta__%d' % pregunta.id"/>
                </div>
                <div role="tabpanel" t-att-id="'datos_pregunta__%d' % pregunta.id" t-attf-class="tab-pane always-print #{'active' if not pregunta_contestada else ''}">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Respuesta</th>
                                <th>Porcentaje</th>
                                <th>Frecuencia</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr t-foreach="respuestas_tabuladas" t-as="respuesta">
                                <td>
                                    <p>
                                        <span t-esc="respuesta['nombre']"/>
                                    </p>
                                </td>
                                <td class="o_survey_answer">
                                    <span t-esc="round(respuesta['valor'] * 100.0/ (len(respuestas) or 1), 2)"></span> % 
                                </td>
                                <td class="o_survey_answer">
                                    <span t-esc="'%s Votos' % respuesta['valor']" class="badge text-bg-primary"/>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </template>

        <template id="question_table_pagination" name="Survey: statistics table pagination">
            <t t-set="respuestas_conteo" t-value="len(datos_pregunta['respuestas'])"/>
            <t t-if="respuestas_conteo > limite_registros">
                <div class="d-flex justify-content-between d-print-none pagination_wrapper" t-att-id="'pagination_%d' % pregunta.id" t-att-data-question_id="pregunta.id" t-att-data-record_limit="limite_registros">
                    <ul class="pagination mt-2">
                        <t t-set="total" t-value="ceil(respuestas_conteo / limite_registros) + 1"/>
                        <li t-foreach="range(1, total)" t-as="num" t-att-class="'page-item o_survey_js_results_pagination %s' % ('active' if num == 1 else '')">
                            <a href="#" class="page-link" t-esc="num"></a>
                        </li>
                    </ul>
                    <button class="btn btn-sm btn-primary mx-0 my-3 o_survey_question_answers_show_btn">Show All</button>
                </div>
            </t>
        </template>
    </data>
</odoo>